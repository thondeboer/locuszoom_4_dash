window.locuszoom_4_dash=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="";var r,i=function(){var t=document.currentScript;if(!t){for(var e=document.getElementsByTagName("script"),n=[],r=0;r<e.length;r++)n.push(e[r]);t=(n=n.filter((function(t){return!t.async&&!t.text&&!t.textContent}))).slice(-1)[0]}return t};if(Object.defineProperty(n,"p",{get:(r=i().src.split("/").slice(0,-1).join("/")+"/",function(){return r})}),"undefined"!=typeof jsonpScriptSrc){var a=jsonpScriptSrc;jsonpScriptSrc=function(t){var e=function(t){return/\/_dash-component-suites\//.test(t.src)}(i()),n=a(t);if(!e)return n;var r=n.split("/"),o=r.slice(-1)[0].split(".");return o.splice(1,0,"v0_7_0m1672120752"),r.splice(-1,1,o.join(".")),r.join("/")}}return n(n.s=7)}([function(t,e){t.exports=window.PropTypes},function(t,e){t.exports=window.React},function(t,e){function n(t){if("string"==typeof t.source.flags)return t.source.flags;var e=[];return t.global&&e.push("g"),t.ignoreCase&&e.push("i"),t.multiline&&e.push("m"),t.sticky&&e.push("y"),t.unicode&&e.push("u"),e.join("")}t.exports=function t(e){if("function"==typeof e)return e;var r=Array.isArray(e)?[]:{};for(var i in e){var a=e[i],o={}.toString.call(a).slice(8,-1);r[i]="Array"==o||"Object"==o?t(a):"Date"==o?new Date(a.getTime()):"RegExp"==o?RegExp(a.source,n(a)):a}return r}},function(t,e,n){"use strict";const r=n(4),i={};e.Sorter=class{constructor(){this._items=[],this.nodes=[]}add(t,e){const n=[].concat((e=e||{}).before||[]),i=[].concat(e.after||[]),a=e.group||"?",o=e.sort||0;r(!n.includes(a),"Item cannot come before itself: "+a),r(!n.includes("?"),"Item cannot come before unassociated items"),r(!i.includes(a),"Item cannot come after itself: "+a),r(!i.includes("?"),"Item cannot come after unassociated items"),Array.isArray(t)||(t=[t]);for(const e of t){const t={seq:this._items.length,sort:o,before:n,after:i,group:a,node:e};this._items.push(t)}if(!e.manual){const t=this._sort();r(t,"item","?"!==a?"added into group "+a:"","created a dependencies error")}return this.nodes}merge(t){Array.isArray(t)||(t=[t]);for(const e of t)if(e)for(const t of e._items)this._items.push(Object.assign({},t));this._items.sort(i.mergeSort);for(let t=0;t<this._items.length;++t)this._items[t].seq=t;const e=this._sort();return r(e,"merge created a dependencies error"),this.nodes}sort(){const t=this._sort();return r(t,"sort created a dependencies error"),this.nodes}_sort(){const t={},e=Object.create(null),n=Object.create(null);for(const r of this._items){const i=r.seq,a=r.group;n[a]=n[a]||[],n[a].push(i),t[i]=r.before;for(const t of r.after)e[t]=e[t]||[],e[t].push(i)}for(const e in t){const r=[];for(const i in t[e]){const a=t[e][i];n[a]=n[a]||[],r.push(...n[a])}t[e]=r}for(const r in e)if(n[r])for(const i of n[r])t[i].push(...e[r]);const r={};for(const e in t){const n=t[e];for(const t of n)r[t]=r[t]||[],r[t].push(e)}const i={},a=[];for(let t=0;t<this._items.length;++t){let e=t;if(r[t]){e=null;for(let t=0;t<this._items.length;++t){if(!0===i[t])continue;r[t]||(r[t]=[]);const n=r[t].length;let a=0;for(let e=0;e<n;++e)i[r[t][e]]&&++a;if(a===n){e=t;break}}}null!==e&&(i[e]=!0,a.push(e))}if(a.length!==this._items.length)return!1;const o={};for(const t of this._items)o[t.seq]=t;this._items=[],this.nodes=[];for(const t of a){const e=o[t];this.nodes.push(e.node),this._items.push(e)}return!0}},i.mergeSort=(t,e)=>t.sort===e.sort?0:t.sort<e.sort?-1:1},function(t,e,n){"use strict";const r=n(5);t.exports=function(t,...e){if(!t){if(1===e.length&&e[0]instanceof Error)throw e[0];throw new r(e)}}},function(t,e,n){"use strict";const r=n(6);t.exports=class extends Error{constructor(t){super(t.filter(t=>""!==t).map(t=>"string"==typeof t?t:t instanceof Error?t.message:r(t)).join(" ")||"Unknown error"),"function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e.assert)}}},function(t,e,n){"use strict";t.exports=function(...t){try{return JSON.stringify(...t)}catch(t){return"[Cannot display object: "+t.message+"]"}}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"left_match",(function(){return S})),n.d(r,"inner_match",(function(){return z})),n.d(r,"full_outer_match",(function(){return N})),n.d(r,"groupBy",(function(){return k}));var i={};n.r(i),n.d(i,"BaseAdapter",(function(){return C})),n.d(i,"BaseApiAdapter",(function(){return P})),n.d(i,"BaseLZAdapter",(function(){return R})),n.d(i,"BaseUMAdapter",(function(){return O})),n.d(i,"AssociationLZ",(function(){return L})),n.d(i,"GeneConstraintLZ",(function(){return $})),n.d(i,"GeneLZ",(function(){return j})),n.d(i,"GwasCatalogLZ",(function(){return D})),n.d(i,"LDServer",(function(){return I})),n.d(i,"PheWASLZ",(function(){return q})),n.d(i,"RecombLZ",(function(){return B})),n.d(i,"StaticSource",(function(){return U}));var a={};n.r(a),n.d(a,"version",(function(){return H})),n.d(a,"bisect",(function(){return J})),n.d(a,"bisectRight",(function(){return Z})),n.d(a,"bisectLeft",(function(){return W})),n.d(a,"ascending",(function(){return G})),n.d(a,"bisector",(function(){return V})),n.d(a,"cross",(function(){return tt})),n.d(a,"descending",(function(){return et})),n.d(a,"deviation",(function(){return it})),n.d(a,"extent",(function(){return at})),n.d(a,"histogram",(function(){return bt})),n.d(a,"thresholdFreedmanDiaconis",(function(){return xt})),n.d(a,"thresholdScott",(function(){return wt})),n.d(a,"thresholdSturges",(function(){return mt})),n.d(a,"max",(function(){return Mt})),n.d(a,"mean",(function(){return kt})),n.d(a,"median",(function(){return Et})),n.d(a,"merge",(function(){return St})),n.d(a,"min",(function(){return zt})),n.d(a,"pairs",(function(){return K})),n.d(a,"permute",(function(){return Nt})),n.d(a,"quantile",(function(){return vt})),n.d(a,"range",(function(){return ht})),n.d(a,"scan",(function(){return Tt})),n.d(a,"shuffle",(function(){return At})),n.d(a,"sum",(function(){return Ct})),n.d(a,"ticks",(function(){return _t})),n.d(a,"tickIncrement",(function(){return gt})),n.d(a,"tickStep",(function(){return yt})),n.d(a,"transpose",(function(){return Pt})),n.d(a,"variance",(function(){return rt})),n.d(a,"zip",(function(){return Ot})),n.d(a,"axisTop",(function(){return Ft})),n.d(a,"axisRight",(function(){return Yt})),n.d(a,"axisBottom",(function(){return Ht})),n.d(a,"axisLeft",(function(){return Gt})),n.d(a,"brush",(function(){return pa})),n.d(a,"brushX",(function(){return fa})),n.d(a,"brushY",(function(){return da})),n.d(a,"brushSelection",(function(){return ha})),n.d(a,"chord",(function(){return Ma})),n.d(a,"ribbon",(function(){return ja})),n.d(a,"nest",(function(){return Ua})),n.d(a,"set",(function(){return Za})),n.d(a,"map",(function(){return Ba})),n.d(a,"keys",(function(){return Wa})),n.d(a,"values",(function(){return Ja})),n.d(a,"entries",(function(){return Ka})),n.d(a,"color",(function(){return Rn})),n.d(a,"rgb",(function(){return jn})),n.d(a,"hsl",(function(){return Yn})),n.d(a,"lab",(function(){return ro})),n.d(a,"hcl",(function(){return ho})),n.d(a,"lch",(function(){return co})),n.d(a,"gray",(function(){return no})),n.d(a,"cubehelix",(function(){return vo})),n.d(a,"contours",(function(){return Ao})),n.d(a,"contourDensity",(function(){return Do})),n.d(a,"dispatch",(function(){return Qt})),n.d(a,"drag",(function(){return Fo})),n.d(a,"dragDisable",(function(){return _n})),n.d(a,"dragEnable",(function(){return gn})),n.d(a,"dsvFormat",(function(){return Wo})),n.d(a,"csvParse",(function(){return Ko})),n.d(a,"csvParseRows",(function(){return Qo})),n.d(a,"csvFormat",(function(){return ts})),n.d(a,"csvFormatBody",(function(){return es})),n.d(a,"csvFormatRows",(function(){return ns})),n.d(a,"csvFormatRow",(function(){return rs})),n.d(a,"csvFormatValue",(function(){return is})),n.d(a,"tsvParse",(function(){return os})),n.d(a,"tsvParseRows",(function(){return ss})),n.d(a,"tsvFormat",(function(){return us})),n.d(a,"tsvFormatBody",(function(){return ls})),n.d(a,"tsvFormatRows",(function(){return cs})),n.d(a,"tsvFormatRow",(function(){return hs})),n.d(a,"tsvFormatValue",(function(){return fs})),n.d(a,"autoType",(function(){return ds})),n.d(a,"easeLinear",(function(){return _s})),n.d(a,"easeQuad",(function(){return ms})),n.d(a,"easeQuadIn",(function(){return gs})),n.d(a,"easeQuadOut",(function(){return ys})),n.d(a,"easeQuadInOut",(function(){return ms})),n.d(a,"easeCubic",(function(){return Li})),n.d(a,"easeCubicIn",(function(){return Ri})),n.d(a,"easeCubicOut",(function(){return Oi})),n.d(a,"easeCubicInOut",(function(){return Li})),n.d(a,"easePoly",(function(){return xs})),n.d(a,"easePolyIn",(function(){return bs})),n.d(a,"easePolyOut",(function(){return vs})),n.d(a,"easePolyInOut",(function(){return xs})),n.d(a,"easeSin",(function(){return Ss})),n.d(a,"easeSinIn",(function(){return ks})),n.d(a,"easeSinOut",(function(){return Es})),n.d(a,"easeSinInOut",(function(){return Ss})),n.d(a,"easeExp",(function(){return As})),n.d(a,"easeExpIn",(function(){return Ns})),n.d(a,"easeExpOut",(function(){return Ts})),n.d(a,"easeExpInOut",(function(){return As})),n.d(a,"easeCircle",(function(){return Rs})),n.d(a,"easeCircleIn",(function(){return Cs})),n.d(a,"easeCircleOut",(function(){return Ps})),n.d(a,"easeCircleInOut",(function(){return Rs})),n.d(a,"easeBounce",(function(){return Ls})),n.d(a,"easeBounceIn",(function(){return Os})),n.d(a,"easeBounceOut",(function(){return Ls})),n.d(a,"easeBounceInOut",(function(){return Ds})),n.d(a,"easeBack",(function(){return Is})),n.d(a,"easeBackIn",(function(){return js})),n.d(a,"easeBackOut",(function(){return $s})),n.d(a,"easeBackInOut",(function(){return Is})),n.d(a,"easeElastic",(function(){return qs})),n.d(a,"easeElasticIn",(function(){return Us})),n.d(a,"easeElasticOut",(function(){return qs})),n.d(a,"easeElasticInOut",(function(){return Fs})),n.d(a,"blob",(function(){return Hs})),n.d(a,"buffer",(function(){return Vs})),n.d(a,"dsv",(function(){return Js})),n.d(a,"csv",(function(){return Ks})),n.d(a,"tsv",(function(){return Qs})),n.d(a,"image",(function(){return tu})),n.d(a,"json",(function(){return nu})),n.d(a,"text",(function(){return Zs})),n.d(a,"xml",(function(){return iu})),n.d(a,"html",(function(){return au})),n.d(a,"svg",(function(){return ou})),n.d(a,"forceCenter",(function(){return su})),n.d(a,"forceCollide",(function(){return vu})),n.d(a,"forceLink",(function(){return Mu})),n.d(a,"forceManyBody",(function(){return Nu})),n.d(a,"forceRadial",(function(){return Tu})),n.d(a,"forceSimulation",(function(){return zu})),n.d(a,"forceX",(function(){return Au})),n.d(a,"forceY",(function(){return Cu})),n.d(a,"formatDefaultLocale",(function(){return Vu})),n.d(a,"format",(function(){return Iu})),n.d(a,"formatPrefix",(function(){return Bu})),n.d(a,"formatLocale",(function(){return Gu})),n.d(a,"formatSpecifier",(function(){return Lu})),n.d(a,"FormatSpecifier",(function(){return Du})),n.d(a,"precisionFixed",(function(){return Xu})),n.d(a,"precisionPrefix",(function(){return Zu})),n.d(a,"precisionRound",(function(){return Wu})),n.d(a,"geoArea",(function(){return Ul})),n.d(a,"geoBounds",(function(){return Rc})),n.d(a,"geoCentroid",(function(){return Hc})),n.d(a,"geoCircle",(function(){return nh})),n.d(a,"geoClipAntimeridian",(function(){return ph})),n.d(a,"geoClipCircle",(function(){return _h})),n.d(a,"geoClipExtent",(function(){return vh})),n.d(a,"geoClipRectangle",(function(){return gh})),n.d(a,"geoContains",(function(){return $h})),n.d(a,"geoDistance",(function(){return Th})),n.d(a,"geoGraticule",(function(){return Uh})),n.d(a,"geoGraticule10",(function(){return qh})),n.d(a,"geoInterpolate",(function(){return Vh})),n.d(a,"geoLength",(function(){return Sh})),n.d(a,"geoPath",(function(){return Gf})),n.d(a,"geoAlbers",(function(){return hd})),n.d(a,"geoAlbersUsa",(function(){return fd})),n.d(a,"geoAzimuthalEqualArea",(function(){return gd})),n.d(a,"geoAzimuthalEqualAreaRaw",(function(){return _d})),n.d(a,"geoAzimuthalEquidistant",(function(){return md})),n.d(a,"geoAzimuthalEquidistantRaw",(function(){return yd})),n.d(a,"geoConicConformal",(function(){return kd})),n.d(a,"geoConicConformalRaw",(function(){return Md})),n.d(a,"geoConicEqualArea",(function(){return cd})),n.d(a,"geoConicEqualAreaRaw",(function(){return ld})),n.d(a,"geoConicEquidistant",(function(){return Nd})),n.d(a,"geoConicEquidistantRaw",(function(){return zd})),n.d(a,"geoEqualEarth",(function(){return Ld})),n.d(a,"geoEqualEarthRaw",(function(){return Od})),n.d(a,"geoEquirectangular",(function(){return Sd})),n.d(a,"geoEquirectangularRaw",(function(){return Ed})),n.d(a,"geoGnomonic",(function(){return jd})),n.d(a,"geoGnomonicRaw",(function(){return Dd})),n.d(a,"geoIdentity",(function(){return $d})),n.d(a,"geoProjection",(function(){return od})),n.d(a,"geoProjectionMutator",(function(){return sd})),n.d(a,"geoMercator",(function(){return vd})),n.d(a,"geoMercatorRaw",(function(){return bd})),n.d(a,"geoNaturalEarth1",(function(){return Bd})),n.d(a,"geoNaturalEarth1Raw",(function(){return Id})),n.d(a,"geoOrthographic",(function(){return qd})),n.d(a,"geoOrthographicRaw",(function(){return Ud})),n.d(a,"geoStereographic",(function(){return Yd})),n.d(a,"geoStereographicRaw",(function(){return Fd})),n.d(a,"geoTransverseMercator",(function(){return Gd})),n.d(a,"geoTransverseMercatorRaw",(function(){return Hd})),n.d(a,"geoRotation",(function(){return Qc})),n.d(a,"geoStream",(function(){return Rl})),n.d(a,"geoTransform",(function(){return Vf})),n.d(a,"cluster",(function(){return Wd})),n.d(a,"hierarchy",(function(){return Kd})),n.d(a,"pack",(function(){return Mp})),n.d(a,"packSiblings",(function(){return yp})),n.d(a,"packEnclose",(function(){return ip})),n.d(a,"partition",(function(){return Tp})),n.d(a,"stratify",(function(){return Op})),n.d(a,"tree",(function(){return Up})),n.d(a,"treemap",(function(){return Gp})),n.d(a,"treemapBinary",(function(){return Vp})),n.d(a,"treemapDice",(function(){return Np})),n.d(a,"treemapSlice",(function(){return qp})),n.d(a,"treemapSliceDice",(function(){return Xp})),n.d(a,"treemapSquarify",(function(){return Hp})),n.d(a,"treemapResquarify",(function(){return Zp})),n.d(a,"interpolate",(function(){return yr})),n.d(a,"interpolateArray",(function(){return sr})),n.d(a,"interpolateBasis",(function(){return Xn})),n.d(a,"interpolateBasisClosed",(function(){return Zn})),n.d(a,"interpolateDate",(function(){return lr})),n.d(a,"interpolateDiscrete",(function(){return Wp})),n.d(a,"interpolateHue",(function(){return Jp})),n.d(a,"interpolateNumber",(function(){return cr})),n.d(a,"interpolateNumberArray",(function(){return ar})),n.d(a,"interpolateObject",(function(){return hr})),n.d(a,"interpolateRound",(function(){return Kp})),n.d(a,"interpolateString",(function(){return gr})),n.d(a,"interpolateTransformCss",(function(){return ti})),n.d(a,"interpolateTransformSvg",(function(){return ei})),n.d(a,"interpolateZoom",(function(){return e_})),n.d(a,"interpolateRgb",(function(){return er})),n.d(a,"interpolateRgbBasis",(function(){return rr})),n.d(a,"interpolateRgbBasisClosed",(function(){return ir})),n.d(a,"interpolateHsl",(function(){return r_})),n.d(a,"interpolateHslLong",(function(){return i_})),n.d(a,"interpolateLab",(function(){return a_})),n.d(a,"interpolateHcl",(function(){return s_})),n.d(a,"interpolateHclLong",(function(){return u_})),n.d(a,"interpolateCubehelix",(function(){return c_})),n.d(a,"interpolateCubehelixLong",(function(){return h_})),n.d(a,"piecewise",(function(){return f_})),n.d(a,"quantize",(function(){return d_})),n.d(a,"path",(function(){return Ca})),n.d(a,"polygonArea",(function(){return p_})),n.d(a,"polygonCentroid",(function(){return __})),n.d(a,"polygonHull",(function(){return m_})),n.d(a,"polygonContains",(function(){return b_})),n.d(a,"polygonLength",(function(){return v_})),n.d(a,"quadtree",(function(){return pu})),n.d(a,"randomUniform",(function(){return w_})),n.d(a,"randomNormal",(function(){return M_})),n.d(a,"randomLogNormal",(function(){return k_})),n.d(a,"randomBates",(function(){return S_})),n.d(a,"randomIrwinHall",(function(){return E_})),n.d(a,"randomExponential",(function(){return z_})),n.d(a,"scaleBand",(function(){return L_})),n.d(a,"scalePoint",(function(){return j_})),n.d(a,"scaleIdentity",(function(){return J_})),n.d(a,"scaleLinear",(function(){return W_})),n.d(a,"scaleLog",(function(){return og})),n.d(a,"scaleSymlog",(function(){return cg})),n.d(a,"scaleOrdinal",(function(){return O_})),n.d(a,"scaleImplicit",(function(){return R_})),n.d(a,"scalePow",(function(){return _g})),n.d(a,"scaleSqrt",(function(){return gg})),n.d(a,"scaleQuantile",(function(){return yg})),n.d(a,"scaleQuantize",(function(){return mg})),n.d(a,"scaleThreshold",(function(){return bg})),n.d(a,"scaleTime",(function(){return nb})),n.d(a,"scaleUtc",(function(){return fb})),n.d(a,"scaleSequential",(function(){return _b})),n.d(a,"scaleSequentialLog",(function(){return gb})),n.d(a,"scaleSequentialPow",(function(){return mb})),n.d(a,"scaleSequentialSqrt",(function(){return bb})),n.d(a,"scaleSequentialSymlog",(function(){return yb})),n.d(a,"scaleSequentialQuantile",(function(){return vb})),n.d(a,"scaleDiverging",(function(){return wb})),n.d(a,"scaleDivergingLog",(function(){return Mb})),n.d(a,"scaleDivergingPow",(function(){return Eb})),n.d(a,"scaleDivergingSqrt",(function(){return Sb})),n.d(a,"scaleDivergingSymlog",(function(){return kb})),n.d(a,"tickFormat",(function(){return X_})),n.d(a,"schemeCategory10",(function(){return Nb})),n.d(a,"schemeAccent",(function(){return Tb})),n.d(a,"schemeDark2",(function(){return Ab})),n.d(a,"schemePaired",(function(){return Cb})),n.d(a,"schemePastel1",(function(){return Pb})),n.d(a,"schemePastel2",(function(){return Rb})),n.d(a,"schemeSet1",(function(){return Ob})),n.d(a,"schemeSet2",(function(){return Lb})),n.d(a,"schemeSet3",(function(){return Db})),n.d(a,"schemeTableau10",(function(){return jb})),n.d(a,"interpolateBrBG",(function(){return Bb})),n.d(a,"schemeBrBG",(function(){return Ib})),n.d(a,"interpolatePRGn",(function(){return qb})),n.d(a,"schemePRGn",(function(){return Ub})),n.d(a,"interpolatePiYG",(function(){return Yb})),n.d(a,"schemePiYG",(function(){return Fb})),n.d(a,"interpolatePuOr",(function(){return Gb})),n.d(a,"schemePuOr",(function(){return Hb})),n.d(a,"interpolateRdBu",(function(){return Xb})),n.d(a,"schemeRdBu",(function(){return Vb})),n.d(a,"interpolateRdGy",(function(){return Wb})),n.d(a,"schemeRdGy",(function(){return Zb})),n.d(a,"interpolateRdYlBu",(function(){return Kb})),n.d(a,"schemeRdYlBu",(function(){return Jb})),n.d(a,"interpolateRdYlGn",(function(){return tv})),n.d(a,"schemeRdYlGn",(function(){return Qb})),n.d(a,"interpolateSpectral",(function(){return nv})),n.d(a,"schemeSpectral",(function(){return ev})),n.d(a,"interpolateBuGn",(function(){return iv})),n.d(a,"schemeBuGn",(function(){return rv})),n.d(a,"interpolateBuPu",(function(){return ov})),n.d(a,"schemeBuPu",(function(){return av})),n.d(a,"interpolateGnBu",(function(){return uv})),n.d(a,"schemeGnBu",(function(){return sv})),n.d(a,"interpolateOrRd",(function(){return cv})),n.d(a,"schemeOrRd",(function(){return lv})),n.d(a,"interpolatePuBuGn",(function(){return fv})),n.d(a,"schemePuBuGn",(function(){return hv})),n.d(a,"interpolatePuBu",(function(){return pv})),n.d(a,"schemePuBu",(function(){return dv})),n.d(a,"interpolatePuRd",(function(){return gv})),n.d(a,"schemePuRd",(function(){return _v})),n.d(a,"interpolateRdPu",(function(){return mv})),n.d(a,"schemeRdPu",(function(){return yv})),n.d(a,"interpolateYlGnBu",(function(){return vv})),n.d(a,"schemeYlGnBu",(function(){return bv})),n.d(a,"interpolateYlGn",(function(){return wv})),n.d(a,"schemeYlGn",(function(){return xv})),n.d(a,"interpolateYlOrBr",(function(){return kv})),n.d(a,"schemeYlOrBr",(function(){return Mv})),n.d(a,"interpolateYlOrRd",(function(){return Sv})),n.d(a,"schemeYlOrRd",(function(){return Ev})),n.d(a,"interpolateBlues",(function(){return Nv})),n.d(a,"schemeBlues",(function(){return zv})),n.d(a,"interpolateGreens",(function(){return Av})),n.d(a,"schemeGreens",(function(){return Tv})),n.d(a,"interpolateGreys",(function(){return Pv})),n.d(a,"schemeGreys",(function(){return Cv})),n.d(a,"interpolatePurples",(function(){return Ov})),n.d(a,"schemePurples",(function(){return Rv})),n.d(a,"interpolateReds",(function(){return Dv})),n.d(a,"schemeReds",(function(){return Lv})),n.d(a,"interpolateOranges",(function(){return $v})),n.d(a,"schemeOranges",(function(){return jv})),n.d(a,"interpolateCividis",(function(){return Iv})),n.d(a,"interpolateCubehelixDefault",(function(){return Bv})),n.d(a,"interpolateRainbow",(function(){return Yv})),n.d(a,"interpolateWarm",(function(){return Uv})),n.d(a,"interpolateCool",(function(){return qv})),n.d(a,"interpolateSinebow",(function(){return Xv})),n.d(a,"interpolateTurbo",(function(){return Zv})),n.d(a,"interpolateViridis",(function(){return Jv})),n.d(a,"interpolateMagma",(function(){return Kv})),n.d(a,"interpolateInferno",(function(){return Qv})),n.d(a,"interpolatePlasma",(function(){return tx})),n.d(a,"create",(function(){return ex})),n.d(a,"creator",(function(){return He})),n.d(a,"local",(function(){return rx})),n.d(a,"matcher",(function(){return ie})),n.d(a,"mouse",(function(){return xr})),n.d(a,"namespace",(function(){return fe})),n.d(a,"namespaces",(function(){return he})),n.d(a,"clientPoint",(function(){return br})),n.d(a,"select",(function(){return fn})),n.d(a,"selectAll",(function(){return ax})),n.d(a,"selection",(function(){return hn})),n.d(a,"selector",(function(){return ee})),n.d(a,"selectorAll",(function(){return re})),n.d(a,"style",(function(){return Me})),n.d(a,"touch",(function(){return vr})),n.d(a,"touches",(function(){return ox})),n.d(a,"window",(function(){return be})),n.d(a,"event",(function(){return Je})),n.d(a,"customEvent",(function(){return rn})),n.d(a,"arc",(function(){return zx})),n.d(a,"area",(function(){return Rx})),n.d(a,"line",(function(){return Px})),n.d(a,"pie",(function(){return Dx})),n.d(a,"areaRadial",(function(){return qx})),n.d(a,"radialArea",(function(){return qx})),n.d(a,"lineRadial",(function(){return Ux})),n.d(a,"radialLine",(function(){return Ux})),n.d(a,"pointRadial",(function(){return Fx})),n.d(a,"linkHorizontal",(function(){return Jx})),n.d(a,"linkVertical",(function(){return Kx})),n.d(a,"linkRadial",(function(){return Qx})),n.d(a,"symbol",(function(){return yw})),n.d(a,"symbols",(function(){return gw})),n.d(a,"symbolCircle",(function(){return tw})),n.d(a,"symbolCross",(function(){return ew})),n.d(a,"symbolDiamond",(function(){return iw})),n.d(a,"symbolSquare",(function(){return lw})),n.d(a,"symbolStar",(function(){return uw})),n.d(a,"symbolTriangle",(function(){return hw})),n.d(a,"symbolWye",(function(){return _w})),n.d(a,"curveBasisClosed",(function(){return Mw})),n.d(a,"curveBasisOpen",(function(){return Ew})),n.d(a,"curveBasis",(function(){return xw})),n.d(a,"curveBundle",(function(){return zw})),n.d(a,"curveCardinalClosed",(function(){return Pw})),n.d(a,"curveCardinalOpen",(function(){return Ow})),n.d(a,"curveCardinal",(function(){return Aw})),n.d(a,"curveCatmullRomClosed",(function(){return Iw})),n.d(a,"curveCatmullRomOpen",(function(){return Uw})),n.d(a,"curveCatmullRom",(function(){return jw})),n.d(a,"curveLinearClosed",(function(){return Fw})),n.d(a,"curveLinear",(function(){return Tx})),n.d(a,"curveMonotoneX",(function(){return Jw})),n.d(a,"curveMonotoneY",(function(){return Kw})),n.d(a,"curveNatural",(function(){return eM})),n.d(a,"curveStep",(function(){return rM})),n.d(a,"curveStepAfter",(function(){return aM})),n.d(a,"curveStepBefore",(function(){return iM})),n.d(a,"stack",(function(){return lM})),n.d(a,"stackOffsetExpand",(function(){return cM})),n.d(a,"stackOffsetDiverging",(function(){return hM})),n.d(a,"stackOffsetNone",(function(){return oM})),n.d(a,"stackOffsetSilhouette",(function(){return fM})),n.d(a,"stackOffsetWiggle",(function(){return dM})),n.d(a,"stackOrderAppearance",(function(){return pM})),n.d(a,"stackOrderAscending",(function(){return gM})),n.d(a,"stackOrderDescending",(function(){return mM})),n.d(a,"stackOrderInsideOut",(function(){return bM})),n.d(a,"stackOrderNone",(function(){return sM})),n.d(a,"stackOrderReverse",(function(){return vM})),n.d(a,"timeInterval",(function(){return wg})),n.d(a,"timeMillisecond",(function(){return ry})),n.d(a,"timeMilliseconds",(function(){return iy})),n.d(a,"utcMillisecond",(function(){return ry})),n.d(a,"utcMilliseconds",(function(){return iy})),n.d(a,"timeSecond",(function(){return ty})),n.d(a,"timeSeconds",(function(){return ey})),n.d(a,"utcSecond",(function(){return ty})),n.d(a,"utcSeconds",(function(){return ey})),n.d(a,"timeMinute",(function(){return Jg})),n.d(a,"timeMinutes",(function(){return Kg})),n.d(a,"timeHour",(function(){return Xg})),n.d(a,"timeHours",(function(){return Zg})),n.d(a,"timeDay",(function(){return Hg})),n.d(a,"timeDays",(function(){return Gg})),n.d(a,"timeWeek",(function(){return Ag})),n.d(a,"timeWeeks",(function(){return jg})),n.d(a,"timeSunday",(function(){return Ag})),n.d(a,"timeSundays",(function(){return jg})),n.d(a,"timeMonday",(function(){return Cg})),n.d(a,"timeMondays",(function(){return $g})),n.d(a,"timeTuesday",(function(){return Pg})),n.d(a,"timeTuesdays",(function(){return Ig})),n.d(a,"timeWednesday",(function(){return Rg})),n.d(a,"timeWednesdays",(function(){return Bg})),n.d(a,"timeThursday",(function(){return Og})),n.d(a,"timeThursdays",(function(){return Ug})),n.d(a,"timeFriday",(function(){return Lg})),n.d(a,"timeFridays",(function(){return qg})),n.d(a,"timeSaturday",(function(){return Dg})),n.d(a,"timeSaturdays",(function(){return Fg})),n.d(a,"timeMonth",(function(){return zg})),n.d(a,"timeMonths",(function(){return Ng})),n.d(a,"timeYear",(function(){return kg})),n.d(a,"timeYears",(function(){return Eg})),n.d(a,"utcMinute",(function(){return cb})),n.d(a,"utcMinutes",(function(){return hb})),n.d(a,"utcHour",(function(){return sb})),n.d(a,"utcHours",(function(){return ub})),n.d(a,"utcDay",(function(){return xy})),n.d(a,"utcDays",(function(){return wy})),n.d(a,"utcWeek",(function(){return oy})),n.d(a,"utcWeeks",(function(){return dy})),n.d(a,"utcSunday",(function(){return oy})),n.d(a,"utcSundays",(function(){return dy})),n.d(a,"utcMonday",(function(){return sy})),n.d(a,"utcMondays",(function(){return py})),n.d(a,"utcTuesday",(function(){return uy})),n.d(a,"utcTuesdays",(function(){return _y})),n.d(a,"utcWednesday",(function(){return ly})),n.d(a,"utcWednesdays",(function(){return gy})),n.d(a,"utcThursday",(function(){return cy})),n.d(a,"utcThursdays",(function(){return yy})),n.d(a,"utcFriday",(function(){return hy})),n.d(a,"utcFridays",(function(){return my})),n.d(a,"utcSaturday",(function(){return fy})),n.d(a,"utcSaturdays",(function(){return by})),n.d(a,"utcMonth",(function(){return ib})),n.d(a,"utcMonths",(function(){return ab})),n.d(a,"utcYear",(function(){return ky})),n.d(a,"utcYears",(function(){return Ey})),n.d(a,"timeFormatDefaultLocale",(function(){return Km})),n.d(a,"timeFormat",(function(){return Cy})),n.d(a,"timeParse",(function(){return Py})),n.d(a,"utcFormat",(function(){return Ry})),n.d(a,"utcParse",(function(){return Oy})),n.d(a,"timeFormatLocale",(function(){return Ty})),n.d(a,"isoFormat",(function(){return xM})),n.d(a,"isoParse",(function(){return wM})),n.d(a,"now",(function(){return Ar})),n.d(a,"timer",(function(){return Rr})),n.d(a,"timerFlush",(function(){return Or})),n.d(a,"timeout",(function(){return $r})),n.d(a,"interval",(function(){return MM})),n.d(a,"transition",(function(){return Ai})),n.d(a,"active",(function(){return Ii})),n.d(a,"interrupt",(function(){return Zr})),n.d(a,"voronoi",(function(){return uk})),n.d(a,"zoom",(function(){return wk})),n.d(a,"zoomTransform",(function(){return dk})),n.d(a,"zoomIdentity",(function(){return fk}));var o={};n.r(o),n.d(o,"log10",(function(){return kk})),n.d(o,"neglog10",(function(){return Ek})),n.d(o,"logtoscinotation",(function(){return Sk})),n.d(o,"scinotation",(function(){return zk})),n.d(o,"htmlescape",(function(){return Nk})),n.d(o,"is_numeric",(function(){return Tk})),n.d(o,"urlencode",(function(){return Ak}));var s={};n.r(s),n.d(s,"BaseWidget",(function(){return Qk})),n.d(s,"_Button",(function(){return tE})),n.d(s,"display_options",(function(){return pE})),n.d(s,"download",(function(){return iE})),n.d(s,"download_png",(function(){return aE})),n.d(s,"filter_field",(function(){return rE})),n.d(s,"menu",(function(){return hE})),n.d(s,"move_panel_down",(function(){return uE})),n.d(s,"move_panel_up",(function(){return sE})),n.d(s,"region_scale",(function(){return nE})),n.d(s,"resize_to_data",(function(){return fE})),n.d(s,"set_state",(function(){return _E})),n.d(s,"shift_region",(function(){return lE})),n.d(s,"remove_panel",(function(){return oE})),n.d(s,"title",(function(){return eE})),n.d(s,"toggle_legend",(function(){return dE})),n.d(s,"zoom_region",(function(){return cE}));var u={};n.r(u),n.d(u,"categorical_bin",(function(){return PE})),n.d(u,"stable_choice",(function(){return OE})),n.d(u,"if_value",(function(){return AE})),n.d(u,"interpolate",(function(){return LE})),n.d(u,"numerical_bin",(function(){return CE})),n.d(u,"ordinal_cycle",(function(){return RE})),n.d(u,"effect_direction",(function(){return DE}));var l={};n.r(l),n.d(l,"BaseDataLayer",(function(){return BE})),n.d(l,"annotation_track",(function(){return qE})),n.d(l,"highlight_regions",(function(){return YE})),n.d(l,"arcs",(function(){return GE})),n.d(l,"genes",(function(){return XE})),n.d(l,"line",(function(){return WE})),n.d(l,"orthogonal_line",(function(){return KE})),n.d(l,"scatter",(function(){return tS})),n.d(l,"category_scatter",(function(){return eS}));var c={};n.r(c),n.d(c,"tooltip",(function(){return OS})),n.d(c,"toolbar_widgets",(function(){return LS})),n.d(c,"toolbar",(function(){return DS})),n.d(c,"data_layer",(function(){return jS})),n.d(c,"panel",(function(){return $S})),n.d(c,"plot",(function(){return IS}));var h=n(1),f=n.n(h),d=n(0),p=n.n(d);class _{constructor(){this._items=new Map}get(t){if(!this._items.has(t))throw new Error("Item not found: "+t);return this._items.get(t)}add(t,e,n=!1){if(!n&&this._items.has(t))throw new Error(`Item ${t} is already defined`);return this._items.set(t,e),e}remove(t){return this._items.delete(t)}has(t){return this._items.has(t)}list(){return Array.from(this._items.keys())}}class g extends _{create(t,...e){return new(this.get(t))(...e)}extend(t,e,n){if(console.warn("Deprecation warning: .extend method will be removed in future versions, in favor of explicit ES6 subclasses"),3!==arguments.length)throw new Error("Invalid arguments to .extend");const r=this.get(t);class i extends r{}return Object.assign(i.prototype,n,r),this.add(e,i),i}}class y{constructor(t,e,n={},r=null,i=null){this.key=t,this.value=e,this.metadata=n,this.prev=r,this.next=i}}class m{constructor(t=3){if(this._max_size=t,this._cur_size=0,this._store=new Map,this._head=null,this._tail=null,null===t||t<0)throw new Error('Cache "max_size" must be >= 0')}has(t){return this._store.has(t)}get(t){const e=this._store.get(t);return e?(this._head!==e&&this.add(t,e.value),e.value):null}add(t,e,n={}){if(0===this._max_size)return;const r=this._store.get(t);r&&this._remove(r);const i=new y(t,e,n,null,this._head);if(this._head?this._head.prev=i:this._tail=i,this._head=i,this._store.set(t,i),this._max_size>=0&&this._cur_size>=this._max_size){const t=this._tail;this._tail=this._tail.prev,this._remove(t)}this._cur_size+=1}clear(){this._head=null,this._tail=null,this._cur_size=0,this._store=new Map}remove(t){const e=this._store.get(t);return!!e&&(this._remove(e),!0)}_remove(t){null!==t.prev?t.prev.next=t.next:this._head=t.next,null!==t.next?t.next.prev=t.prev:this._tail=t.prev,this._store.delete(t.key),this._cur_size-=1}find(t){let e=this._head;for(;e;){const n=e.next;if(t(e))return e;e=n}}}var b=n(2),v=n.n(b);function x(t){return"object"!=typeof t?t:v()(t)}var w=n(3);function M(t,e,n,r=!0){if(!n.length)return[];const i=n.map(t=>function(t){const e=/^(?<name_alone>\w+)$|((?<name_deps>\w+)+\(\s*(?<deps>[^)]+?)\s*\))/.exec(t);if(!e)throw new Error("Unable to parse dependency specification: "+t);let{name_alone:n,name_deps:r,deps:i}=e.groups;return n?[n,[]]:(i=i.split(/\s*,\s*/),[r,i])}(t)),a=new Map(i),o=new w.Sorter;for(let[t,e]of a.entries())try{o.add(t,{after:e,group:t})}catch(e){throw new Error("Invalid or possible circular dependency specification for: "+t)}const s=o.nodes,u=new Map;for(let n of s){const r=e.get(n);if(!r)throw new Error(`Data has been requested from source '${n}', but no matching source was provided`);const i=a.get(n)||[],o=Promise.all(i.map(t=>u.get(t))).then(e=>{const i=Object.assign({_provider_name:n},t);return r.getData(i,...e)});u.set(n,o)}return Promise.all([...u.values()]).then(t=>r?t[t.length-1]:t)}function k(t,e){const n=new Map;for(let r of t){const t=r[e];if(void 0===t)throw new Error(`All records must specify a value for the field "${e}"`);if("object"==typeof t)throw new Error("Attempted to group on a field with non-primitive values");let i=n.get(t);i||(i=[],n.set(t,i)),i.push(r)}return n}function E(t,e,n,r,i){const a=k(n,i),o=[];for(let n of e){const e=n[r],i=a.get(e)||[];i.length?o.push(...i.map(t=>Object.assign({},x(t),x(n)))):"inner"!==t&&o.push(x(n))}if("outer"===t){const t=k(e,r);for(let e of n){const n=e[i];(t.get(n)||[]).length||o.push(x(e))}}return o}function S(t,e,n,r){return E("left",...arguments)}function z(t,e,n,r){return E("inner",...arguments)}function N(t,e,n,r){return E("outer",...arguments)}const T=/^(?:chr)?([a-zA-Z0-9]+?)[_:-](\d+)[_:|-]?(\w+)?[/_:|-]?([^_]+)?_?(.*)?/;function A(t,e=!1){const n=t&&t.match(T);if(n)return n.slice(1);if(e)return null;throw new Error(`Could not understand marker format for ${t}. Should be of format chr:pos or chr:pos_ref/alt`)}class C{constructor(){throw new Error('The "BaseAdapter" and "BaseApiAdapter" classes have been replaced in LocusZoom 0.14. See migration guide for details.')}}class P extends C{}class R extends class extends class{constructor(t={}){this._config=t;const{cache_enabled:e=!0,cache_size:n=3}=t;this._enable_cache=e,this._cache=new m(n)}_buildRequestOptions(t,e){return Object.assign({},t)}_getCacheKey(t){if(this._enable_cache)throw new Error("Method not implemented");return null}_performRequest(t){throw new Error("Not implemented")}_normalizeResponse(t,e){return t}_annotateRecords(t,e){return t}_postProcessResponse(t,e){return t}getData(t={},...e){t=this._buildRequestOptions(t,...e);const n=this._getCacheKey(t);let r;return this._enable_cache&&this._cache.has(n)?r=this._cache.get(n):(r=Promise.resolve(this._performRequest(t)).then(e=>this._normalizeResponse(e,t)),this._cache.add(n,r,t._cache_meta),r.catch(t=>this._cache.remove(n))),r.then(t=>x(t)).then(e=>this._annotateRecords(e,t)).then(e=>this._postProcessResponse(e,t))}}{constructor(t={}){super(t),this._url=t.url}_getCacheKey(t){return this._getURL(t)}_getURL(t){return this._url}_performRequest(t){const e=this._getURL(t);if(!this._url)throw new Error('Web based resources must specify a resource URL as option "url"');return fetch(e).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.text()})}_normalizeResponse(t,e){return"string"==typeof t?JSON.parse(t):t}}{constructor(t={}){t.params&&(console.warn('Deprecation warning: all options in "config.params" should now be specified as top level keys.'),Object.assign(t,t.params||{}),delete t.params),super(t);const{prefix_namespace:e=!0,limit_fields:n}=t;this._prefix_namespace=e,this._limit_fields=!!n&&new Set(n)}_getCacheKey(t){let{chr:e,start:n,end:r}=t;const i=this._cache.find(({metadata:t})=>e===t.chr&&n>=t.start&&r<=t.end);return i&&({chr:e,start:n,end:r}=i.metadata),t._cache_meta={chr:e,start:n,end:r},`${e}_${n}_${r}`}_postProcessResponse(t,e){if(!this._prefix_namespace||!Array.isArray(t))return t;const{_limit_fields:n}=this,{_provider_name:r}=e;return t.map(t=>Object.entries(t).reduce((t,[e,i])=>(n&&!n.has(e)||(t[`${r}:${e}`]=i),t),{}))}_findPrefixedKey(t,e){const n=new RegExp(`:${e}$`),r=Object.keys(t).find(t=>n.test(t));if(!r)throw new Error(`Could not locate the required key name: ${e} in dependent data`);return r}}class O extends R{constructor(t={}){super(t),this._genome_build=t.genome_build||t.build}_validateBuildSource(t,e){if(t&&e||!t&&!e)throw new Error(this.constructor.name+' must provide a parameter specifying either "build" or "source". It should not specify both.');if(t&&!["GRCh37","GRCh38"].includes(t))throw new Error(this.constructor.name+" must specify a valid 'genome_build'")}_normalizeResponse(t,e){let n=super._normalizeResponse(...arguments);if(n=n.data||n,Array.isArray(n))return n;const r=Object.keys(n),i=n[r[0]].length;if(!r.every((function(t){return n[t].length===i})))throw new Error(this.constructor.name+" expects a response in which all arrays of data are the same length");const a=[],o=Object.keys(n);for(let t=0;t<i;t++){const e={};for(let r=0;r<o.length;r++)e[o[r]]=n[o[r]][t];a.push(e)}return a}}class L extends O{constructor(t={}){super(t);const{source:e}=t;this._source_id=e}_getURL(t){const{chr:e,start:n,end:r}=t;return`${super._getURL(t)}results/?filter=analysis in ${this._source_id} and chromosome in  '${e}' and position ge ${n} and position le ${r}`}}class D extends O{constructor(t){t.limit_fields||(t.limit_fields=["log_pvalue","pos","rsid","trait","variant"]),super(t)}_getURL(t){const e=t.genome_build||this._config.build,n=this._config.source;this._validateBuildSource(e,n);const r=e?"&build="+e:" and id eq "+n;return`${super._getURL(t)}?format=objects&sort=pos&filter=chrom eq '${t.chr}' and pos ge ${t.start} and pos le ${t.end}${r}`}}class j extends O{constructor(t={}){super(t),this._prefix_namespace=!1}_getURL(t){const e=t.genome_build||this._config.build;let n=this._config.source;this._validateBuildSource(e,n);const r=e?"&build="+e:" and source in "+n;return`${super._getURL(t)}?filter=chrom eq '${t.chr}' and start le ${t.end} and end ge ${t.start}${r}`}}class $ extends R{constructor(t={}){super(t),this._prefix_namespace=!1}_buildRequestOptions(t,e){const n=t.genome_build||this._config.build;if(!n)throw new Error(`Adapter ${this.constructor.name} must specify a 'genome_build' option`);const r=new Set;for(let t of e)r.add(t.gene_name);return t.query=[...r.values()].map((function(t){return`${"_"+t.replace(/[^A-Za-z0-9_]/g,"_")}: gene(gene_symbol: "${t}", reference_genome: ${n}) { gnomad_constraint { exp_syn obs_syn syn_z oe_syn oe_syn_lower oe_syn_upper exp_mis obs_mis mis_z oe_mis oe_mis_lower oe_mis_upper exp_lof obs_lof pLI oe_lof oe_lof_lower oe_lof_upper } } `})),t.build=n,Object.assign({},t)}_performRequest(t){let{query:e,build:n}=t;if(!e.length||e.length>25||"GRCh38"===n)return Promise.resolve([]);e=`{${e.join(" ")} }`;const r=this._getURL(t),i=JSON.stringify({query:e});return fetch(r,{method:"POST",body:i,headers:{"Content-Type":"application/json"}}).then(t=>t.ok?t.text():[]).catch(t=>[])}_normalizeResponse(t){if("string"!=typeof t)return t;return JSON.parse(t).data}}class I extends O{constructor(t){t.limit_fields||(t.limit_fields=["variant2","position2","correlation"]),super(t)}__find_ld_refvar(t,e){const n=this._findPrefixedKey(e[0],"variant"),r=this._findPrefixedKey(e[0],"log_pvalue");let i,a={};if(t.ldrefvar)i=t.ldrefvar,a=e.find(t=>t[n]===i)||{};else{let t=0;for(let o of e){const{[n]:e,[r]:s}=o;s>t&&(t=s,i=e,a=o)}}a.lz_is_ld_refvar=!0;const o=A(i,!0);if(!o)throw new Error("Could not request LD for a missing or incomplete marker format");const[s,u,l,c]=o;i=`${s}:${u}`,l&&c&&(i+=`_${l}/${c}`);const h=+u;return h&&t.ldrefvar&&t.chr&&(s!==String(t.chr)||h<t.start||h>t.end)?(t.ldrefvar=null,this.__find_ld_refvar(t,e)):i}_buildRequestOptions(t,e){if(!e)throw new Error("LD request must depend on association data");const n=super._buildRequestOptions(...arguments);if(!e.length)return n._skip_request=!0,n;n.ld_refvar=this.__find_ld_refvar(t,e);const r=t.genome_build||this._config.build||"GRCh37";let i=t.ld_source||this._config.source||"1000G";const a=t.ld_pop||this._config.population||"ALL";return"1000G"===i&&"GRCh38"===r&&(i="1000G-FRZ09"),this._validateBuildSource(r,null),Object.assign({},n,{genome_build:r,ld_source:i,ld_population:a})}_getURL(t){const e=this._config.method||"rsquare",{chr:n,start:r,end:i,ld_refvar:a,genome_build:o,ld_source:s,ld_population:u}=t;return[super._getURL(t),"genome_builds/",o,"/references/",s,"/populations/",u,"/variants","?correlation=",e,"&variant=",encodeURIComponent(a),"&chrom=",encodeURIComponent(n),"&start=",encodeURIComponent(r),"&stop=",encodeURIComponent(i)].join("")}_getCacheKey(t){const e=super._getCacheKey(t),{ld_refvar:n,ld_source:r,ld_population:i}=t;return`${e}_${n}_${r}_${i}`}_performRequest(t){if(t._skip_request)return Promise.resolve([]);const e=this._getURL(t);let n={data:{}},r=function(t){return fetch(t).then().then(t=>{if(!t.ok)throw new Error(t.statusText);return t.text()}).then((function(t){return t=JSON.parse(t),Object.keys(t.data).forEach((function(e){n.data[e]=(n.data[e]||[]).concat(t.data[e])})),t.next?r(t.next):n}))};return r(e)}}class B extends O{constructor(t){t.limit_fields||(t.limit_fields=["position","recomb_rate"]),super(t)}_getURL(t){const e=t.genome_build||this._config.build;let n=this._config.source;this._validateBuildSource(e,n);const r=e?"&build="+e:" and id in "+n;return`${super._getURL(t)}?filter=chromosome eq '${t.chr}' and position le ${t.end} and position ge ${t.start}${r}`}}class U extends R{constructor(t={}){super(...arguments);const{data:e}=t;if(!e||Array.isArray(t))throw new Error("'StaticSource' must provide data as required option 'config.data'");this._data=e}_performRequest(t){return Promise.resolve(this._data)}}class q extends O{_getURL(t){const e=(t.genome_build?[t.genome_build]:null)||this._config.build;if(!e||!Array.isArray(e)||!e.length)throw new Error(["Adapter",this.constructor.name,"requires that you specify array of one or more desired genome build names"].join(" "));return[super._getURL(t),"?filter=variant eq '",encodeURIComponent(t.variant),"'&format=objects&",e.map((function(t){return"build="+encodeURIComponent(t)})).join("&")].join("")}_getCacheKey(t){return this._getURL(t)}}const F=new g;for(let[t,e]of Object.entries(i))F.add(t,e);F.add("StaticJSON",U),F.add("LDLZ2",I);var Y=F,H="5.16.0",G=function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN},V=function(t){var e;return 1===t.length&&(e=t,t=function(t,n){return G(e(t),n)}),{left:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)<0?r=a+1:i=a}return r},right:function(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){var a=r+i>>>1;t(e[a],n)>0?i=a:r=a+1}return r}}};var X=V(G),Z=X.right,W=X.left,J=Z,K=function(t,e){null==e&&(e=Q);for(var n=0,r=t.length-1,i=t[0],a=new Array(r<0?0:r);n<r;)a[n]=e(i,i=t[++n]);return a};function Q(t,e){return[t,e]}var tt=function(t,e,n){var r,i,a,o,s=t.length,u=e.length,l=new Array(s*u);for(null==n&&(n=Q),r=a=0;r<s;++r)for(o=t[r],i=0;i<u;++i,++a)l[a]=n(o,e[i]);return l},et=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},nt=function(t){return null===t?NaN:+t},rt=function(t,e){var n,r,i=t.length,a=0,o=-1,s=0,u=0;if(null==e)for(;++o<i;)isNaN(n=nt(t[o]))||(u+=(r=n-s)*(n-(s+=r/++a)));else for(;++o<i;)isNaN(n=nt(e(t[o],o,t)))||(u+=(r=n-s)*(n-(s+=r/++a)));if(a>1)return u/(a-1)},it=function(t,e){var n=rt(t,e);return n?Math.sqrt(n):n},at=function(t,e){var n,r,i,a=t.length,o=-1;if(null==e){for(;++o<a;)if(null!=(n=t[o])&&n>=n)for(r=i=n;++o<a;)null!=(n=t[o])&&(r>n&&(r=n),i<n&&(i=n))}else for(;++o<a;)if(null!=(n=e(t[o],o,t))&&n>=n)for(r=i=n;++o<a;)null!=(n=e(t[o],o,t))&&(r>n&&(r=n),i<n&&(i=n));return[r,i]},ot=Array.prototype,st=ot.slice,ut=ot.map,lt=function(t){return function(){return t}},ct=function(t){return t},ht=function(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(i);++r<i;)a[r]=t+r*n;return a},ft=Math.sqrt(50),dt=Math.sqrt(10),pt=Math.sqrt(2),_t=function(t,e,n){var r,i,a,o,s=-1;if(n=+n,(t=+t)===(e=+e)&&n>0)return[t];if((r=e<t)&&(i=t,t=e,e=i),0===(o=gt(t,e,n))||!isFinite(o))return[];if(o>0)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(i=Math.ceil(e-t+1));++s<i;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(i=Math.ceil(t-e+1));++s<i;)a[s]=(t-s)/o;return r&&a.reverse(),a};function gt(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),a=r/Math.pow(10,i);return i>=0?(a>=ft?10:a>=dt?5:a>=pt?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=ft?10:a>=dt?5:a>=pt?2:1)}function yt(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),a=r/i;return a>=ft?i*=10:a>=dt?i*=5:a>=pt&&(i*=2),e<t?-i:i}var mt=function(t){return Math.ceil(Math.log(t.length)/Math.LN2)+1},bt=function(){var t=ct,e=at,n=mt;function r(r){var i,a,o=r.length,s=new Array(o);for(i=0;i<o;++i)s[i]=t(r[i],i,r);var u=e(s),l=u[0],c=u[1],h=n(s,l,c);Array.isArray(h)||(h=yt(l,c,h),h=ht(Math.ceil(l/h)*h,c,h));for(var f=h.length;h[0]<=l;)h.shift(),--f;for(;h[f-1]>c;)h.pop(),--f;var d,p=new Array(f+1);for(i=0;i<=f;++i)(d=p[i]=[]).x0=i>0?h[i-1]:l,d.x1=i<f?h[i]:c;for(i=0;i<o;++i)l<=(a=s[i])&&a<=c&&p[J(h,a,0,f)].push(r[i]);return p}return r.value=function(e){return arguments.length?(t="function"==typeof e?e:lt(e),r):t},r.domain=function(t){return arguments.length?(e="function"==typeof t?t:lt([t[0],t[1]]),r):e},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?lt(st.call(t)):lt(t),r):n},r},vt=function(t,e,n){if(null==n&&(n=nt),r=t.length){if((e=+e)<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,a=Math.floor(i),o=+n(t[a],a,t);return o+(+n(t[a+1],a+1,t)-o)*(i-a)}},xt=function(t,e,n){return t=ut.call(t,nt).sort(G),Math.ceil((n-e)/(2*(vt(t,.75)-vt(t,.25))*Math.pow(t.length,-1/3)))},wt=function(t,e,n){return Math.ceil((n-e)/(3.5*it(t)*Math.pow(t.length,-1/3)))},Mt=function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&n>r&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&n>r&&(r=n);return r},kt=function(t,e){var n,r=t.length,i=r,a=-1,o=0;if(null==e)for(;++a<r;)isNaN(n=nt(t[a]))?--i:o+=n;else for(;++a<r;)isNaN(n=nt(e(t[a],a,t)))?--i:o+=n;if(i)return o/i},Et=function(t,e){var n,r=t.length,i=-1,a=[];if(null==e)for(;++i<r;)isNaN(n=nt(t[i]))||a.push(n);else for(;++i<r;)isNaN(n=nt(e(t[i],i,t)))||a.push(n);return vt(a.sort(G),.5)},St=function(t){for(var e,n,r,i=t.length,a=-1,o=0;++a<i;)o+=t[a].length;for(n=new Array(o);--i>=0;)for(e=(r=t[i]).length;--e>=0;)n[--o]=r[e];return n},zt=function(t,e){var n,r,i=t.length,a=-1;if(null==e){for(;++a<i;)if(null!=(n=t[a])&&n>=n)for(r=n;++a<i;)null!=(n=t[a])&&r>n&&(r=n)}else for(;++a<i;)if(null!=(n=e(t[a],a,t))&&n>=n)for(r=n;++a<i;)null!=(n=e(t[a],a,t))&&r>n&&(r=n);return r},Nt=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},Tt=function(t,e){if(n=t.length){var n,r,i=0,a=0,o=t[a];for(null==e&&(e=G);++i<n;)(e(r=t[i],o)<0||0!==e(o,o))&&(o=r,a=i);return 0===e(o,o)?a:void 0}},At=function(t,e,n){for(var r,i,a=(null==n?t.length:n)-(e=null==e?0:+e);a;)i=Math.random()*a--|0,r=t[a+e],t[a+e]=t[i+e],t[i+e]=r;return t},Ct=function(t,e){var n,r=t.length,i=-1,a=0;if(null==e)for(;++i<r;)(n=+t[i])&&(a+=n);else for(;++i<r;)(n=+e(t[i],i,t))&&(a+=n);return a},Pt=function(t){if(!(i=t.length))return[];for(var e=-1,n=zt(t,Rt),r=new Array(n);++e<n;)for(var i,a=-1,o=r[e]=new Array(i);++a<i;)o[a]=t[a][e];return r};function Rt(t){return t.length}var Ot=function(){return Pt(arguments)},Lt=Array.prototype.slice,Dt=function(t){return t};function jt(t){return"translate("+(t+.5)+",0)"}function $t(t){return"translate(0,"+(t+.5)+")"}function It(t){return function(e){return+t(e)}}function Bt(t){var e=Math.max(0,t.bandwidth()-1)/2;return t.round()&&(e=Math.round(e)),function(n){return+t(n)+e}}function Ut(){return!this.__axis}function qt(t,e){var n=[],r=null,i=null,a=6,o=6,s=3,u=1===t||4===t?-1:1,l=4===t||2===t?"x":"y",c=1===t||3===t?jt:$t;function h(h){var f=null==r?e.ticks?e.ticks.apply(e,n):e.domain():r,d=null==i?e.tickFormat?e.tickFormat.apply(e,n):Dt:i,p=Math.max(a,0)+s,_=e.range(),g=+_[0]+.5,y=+_[_.length-1]+.5,m=(e.bandwidth?Bt:It)(e.copy()),b=h.selection?h.selection():h,v=b.selectAll(".domain").data([null]),x=b.selectAll(".tick").data(f,e).order(),w=x.exit(),M=x.enter().append("g").attr("class","tick"),k=x.select("line"),E=x.select("text");v=v.merge(v.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),x=x.merge(M),k=k.merge(M.append("line").attr("stroke","currentColor").attr(l+"2",u*a)),E=E.merge(M.append("text").attr("fill","currentColor").attr(l,u*p).attr("dy",1===t?"0em":3===t?"0.71em":"0.32em")),h!==b&&(v=v.transition(h),x=x.transition(h),k=k.transition(h),E=E.transition(h),w=w.transition(h).attr("opacity",1e-6).attr("transform",(function(t){return isFinite(t=m(t))?c(t):this.getAttribute("transform")})),M.attr("opacity",1e-6).attr("transform",(function(t){var e=this.parentNode.__axis;return c(e&&isFinite(e=e(t))?e:m(t))}))),w.remove(),v.attr("d",4===t||2==t?o?"M"+u*o+","+g+"H0.5V"+y+"H"+u*o:"M0.5,"+g+"V"+y:o?"M"+g+","+u*o+"V0.5H"+y+"V"+u*o:"M"+g+",0.5H"+y),x.attr("opacity",1).attr("transform",(function(t){return c(m(t))})),k.attr(l+"2",u*a),E.attr(l,u*p).text(d),b.filter(Ut).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===t?"start":4===t?"end":"middle"),b.each((function(){this.__axis=m}))}return h.scale=function(t){return arguments.length?(e=t,h):e},h.ticks=function(){return n=Lt.call(arguments),h},h.tickArguments=function(t){return arguments.length?(n=null==t?[]:Lt.call(t),h):n.slice()},h.tickValues=function(t){return arguments.length?(r=null==t?null:Lt.call(t),h):r&&r.slice()},h.tickFormat=function(t){return arguments.length?(i=t,h):i},h.tickSize=function(t){return arguments.length?(a=o=+t,h):a},h.tickSizeInner=function(t){return arguments.length?(a=+t,h):a},h.tickSizeOuter=function(t){return arguments.length?(o=+t,h):o},h.tickPadding=function(t){return arguments.length?(s=+t,h):s},h}function Ft(t){return qt(1,t)}function Yt(t){return qt(2,t)}function Ht(t){return qt(3,t)}function Gt(t){return qt(4,t)}var Vt={value:function(){}};function Xt(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new Zt(r)}function Zt(t){this._=t}function Wt(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function Jt(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function Kt(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=Vt,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}Zt.prototype=Xt.prototype={constructor:Zt,on:function(t,e){var n,r=this._,i=Wt(t+"",r),a=-1,o=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++a<o;)if(n=(t=i[a]).type)r[n]=Kt(r[n],t.name,e);else if(null==e)for(n in r)r[n]=Kt(r[n],t.name,null);return this}for(;++a<o;)if((n=(t=i[a]).type)&&(n=Jt(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Zt(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),a=0;a<n;++a)i[a]=arguments[a+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(a=0,n=(r=this._[t]).length;a<n;++a)r[a].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,a=r.length;i<a;++i)r[i].value.apply(e,n)}};var Qt=Xt;function te(){}var ee=function(t){return null==t?te:function(){return this.querySelector(t)}};function ne(){return[]}var re=function(t){return null==t?ne:function(){return this.querySelectorAll(t)}},ie=function(t){return function(){return this.matches(t)}},ae=function(t){return new Array(t.length)};function oe(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}oe.prototype={constructor:oe,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function se(t,e,n,r,i,a){for(var o,s=0,u=e.length,l=a.length;s<l;++s)(o=e[s])?(o.__data__=a[s],r[s]=o):n[s]=new oe(t,a[s]);for(;s<u;++s)(o=e[s])&&(i[s]=o)}function ue(t,e,n,r,i,a,o){var s,u,l,c={},h=e.length,f=a.length,d=new Array(h);for(s=0;s<h;++s)(u=e[s])&&(d[s]=l="$"+o.call(u,u.__data__,s,e),l in c?i[s]=u:c[l]=u);for(s=0;s<f;++s)(u=c[l="$"+o.call(t,a[s],s,a)])?(r[s]=u,u.__data__=a[s],c[l]=null):n[s]=new oe(t,a[s]);for(s=0;s<h;++s)(u=e[s])&&c[d[s]]===u&&(i[s]=u)}function le(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var ce="http://www.w3.org/1999/xhtml",he={svg:"http://www.w3.org/2000/svg",xhtml:ce,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},fe=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),he.hasOwnProperty(e)?{space:he[e],local:t}:t};function de(t){return function(){this.removeAttribute(t)}}function pe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _e(t,e){return function(){this.setAttribute(t,e)}}function ge(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function ye(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function me(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}var be=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView};function ve(t){return function(){this.style.removeProperty(t)}}function xe(t,e,n){return function(){this.style.setProperty(t,e,n)}}function we(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function Me(t,e){return t.style.getPropertyValue(e)||be(t).getComputedStyle(t,null).getPropertyValue(e)}function ke(t){return function(){delete this[t]}}function Ee(t,e){return function(){this[t]=e}}function Se(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function ze(t){return t.trim().split(/^|\s+/)}function Ne(t){return t.classList||new Te(t)}function Te(t){this._node=t,this._names=ze(t.getAttribute("class")||"")}function Ae(t,e){for(var n=Ne(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function Ce(t,e){for(var n=Ne(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function Pe(t){return function(){Ae(this,t)}}function Re(t){return function(){Ce(this,t)}}function Oe(t,e){return function(){(e.apply(this,arguments)?Ae:Ce)(this,t)}}Te.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Le(){this.textContent=""}function De(t){return function(){this.textContent=t}}function je(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function $e(){this.innerHTML=""}function Ie(t){return function(){this.innerHTML=t}}function Be(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function Ue(){this.nextSibling&&this.parentNode.appendChild(this)}function qe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Fe(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===ce&&e.documentElement.namespaceURI===ce?e.createElement(t):e.createElementNS(n,t)}}function Ye(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}var He=function(t){var e=fe(t);return(e.local?Ye:Fe)(e)};function Ge(){return null}function Ve(){var t=this.parentNode;t&&t.removeChild(this)}function Xe(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Ze(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}var We={},Je=null;"undefined"!=typeof document&&("onmouseenter"in document.documentElement||(We={mouseenter:"mouseover",mouseleave:"mouseout"}));function Ke(t,e,n){return t=Qe(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function Qe(t,e,n){return function(r){var i=Je;Je=r;try{t.call(this,this.__data__,e,n)}finally{Je=i}}}function tn(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}function en(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,a=e.length;r<a;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.capture);++i?e.length=i:delete this.__on}}}function nn(t,e,n){var r=We.hasOwnProperty(t.type)?Ke:Qe;return function(i,a,o){var s,u=this.__on,l=r(e,a,o);if(u)for(var c=0,h=u.length;c<h;++c)if((s=u[c]).type===t.type&&s.name===t.name)return this.removeEventListener(s.type,s.listener,s.capture),this.addEventListener(s.type,s.listener=l,s.capture=n),void(s.value=e);this.addEventListener(t.type,l,n),s={type:t.type,name:t.name,value:e,listener:l,capture:n},u?u.push(s):this.__on=[s]}}function rn(t,e,n,r){var i=Je;t.sourceEvent=Je,Je=t;try{return e.apply(n,r)}finally{Je=i}}function an(t,e,n){var r=be(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function on(t,e){return function(){return an(this,t,e)}}function sn(t,e){return function(){return an(this,t,e.apply(this,arguments))}}var un=[null];function ln(t,e){this._groups=t,this._parents=e}function cn(){return new ln([[document.documentElement]],un)}ln.prototype=cn.prototype={constructor:ln,select:function(t){"function"!=typeof t&&(t=ee(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o,s=e[i],u=s.length,l=r[i]=new Array(u),c=0;c<u;++c)(a=s[c])&&(o=t.call(a,a.__data__,c,s))&&("__data__"in a&&(o.__data__=a.__data__),l[c]=o);return new ln(r,this._parents)},selectAll:function(t){"function"!=typeof t&&(t=re(t));for(var e=this._groups,n=e.length,r=[],i=[],a=0;a<n;++a)for(var o,s=e[a],u=s.length,l=0;l<u;++l)(o=s[l])&&(r.push(t.call(o,o.__data__,l,s)),i.push(o));return new ln(r,i)},filter:function(t){"function"!=typeof t&&(t=ie(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,u=r[i]=[],l=0;l<s;++l)(a=o[l])&&t.call(a,a.__data__,l,o)&&u.push(a);return new ln(r,this._parents)},data:function(t,e){if(!t)return p=new Array(this.size()),c=-1,this.each((function(t){p[++c]=t})),p;var n,r=e?ue:se,i=this._parents,a=this._groups;"function"!=typeof t&&(n=t,t=function(){return n});for(var o=a.length,s=new Array(o),u=new Array(o),l=new Array(o),c=0;c<o;++c){var h=i[c],f=a[c],d=f.length,p=t.call(h,h&&h.__data__,c,i),_=p.length,g=u[c]=new Array(_),y=s[c]=new Array(_);r(h,f,g,y,l[c]=new Array(d),p,e);for(var m,b,v=0,x=0;v<_;++v)if(m=g[v]){for(v>=x&&(x=v+1);!(b=y[x])&&++x<_;);m._next=b||null}}return(s=new ln(s,i))._enter=u,s._exit=l,s},enter:function(){return new ln(this._enter||this._groups.map(ae),this._parents)},exit:function(){return new ln(this._exit||this._groups.map(ae),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,a=this.exit();return r="function"==typeof t?t(r):r.append(t+""),null!=e&&(i=e(i)),null==n?a.remove():n(a),r&&i?r.merge(i).order():i},merge:function(t){for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u,l=e[s],c=n[s],h=l.length,f=o[s]=new Array(h),d=0;d<h;++d)(u=l[d]||c[d])&&(f[d]=u);for(;s<r;++s)o[s]=e[s];return new ln(o,this._parents)},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],a=i.length-1,o=i[a];--a>=0;)(r=i[a])&&(o&&4^r.compareDocumentPosition(o)&&o.parentNode.insertBefore(r,o),o=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=le);for(var n=this._groups,r=n.length,i=new Array(r),a=0;a<r;++a){for(var o,s=n[a],u=s.length,l=i[a]=new Array(u),c=0;c<u;++c)(o=s[c])&&(l[c]=o);l.sort(e)}return new ln(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){var t=new Array(this.size()),e=-1;return this.each((function(){t[++e]=this})),t},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,a=r.length;i<a;++i){var o=r[i];if(o)return o}return null},size:function(){var t=0;return this.each((function(){++t})),t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,a=e[n],o=0,s=a.length;o<s;++o)(i=a[o])&&t.call(i,i.__data__,o,a);return this},attr:function(t,e){var n=fe(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?pe:de:"function"==typeof e?n.local?me:ye:n.local?ge:_e)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?ve:"function"==typeof e?we:xe)(t,e,null==n?"":n)):Me(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?ke:"function"==typeof e?Se:Ee)(t,e)):this.node()[t]},classed:function(t,e){var n=ze(t+"");if(arguments.length<2){for(var r=Ne(this.node()),i=-1,a=n.length;++i<a;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?Oe:e?Pe:Re)(n,e))},text:function(t){return arguments.length?this.each(null==t?Le:("function"==typeof t?je:De)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?$e:("function"==typeof t?Be:Ie)(t)):this.node().innerHTML},raise:function(){return this.each(Ue)},lower:function(){return this.each(qe)},append:function(t){var e="function"==typeof t?t:He(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:He(t),r=null==e?Ge:"function"==typeof e?e:ee(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(Ve)},clone:function(t){return this.select(t?Ze:Xe)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,a=tn(t+""),o=a.length;if(!(arguments.length<2)){for(s=e?nn:en,null==n&&(n=!1),r=0;r<o;++r)this.each(s(a[r],e,n));return this}var s=this.node().__on;if(s)for(var u,l=0,c=s.length;l<c;++l)for(r=0,u=s[l];r<o;++r)if((i=a[r]).type===u.type&&i.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?sn:on)(t,e))}};var hn=cn,fn=function(t){return"string"==typeof t?new ln([[document.querySelector(t)]],[document.documentElement]):new ln([[t]],un)};function dn(){Je.stopImmediatePropagation()}var pn=function(){Je.preventDefault(),Je.stopImmediatePropagation()},_n=function(t){var e=t.document.documentElement,n=fn(t).on("dragstart.drag",pn,!0);"onselectstart"in e?n.on("selectstart.drag",pn,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")};function gn(t,e){var n=t.document.documentElement,r=fn(t).on("dragstart.drag",null);e&&(r.on("click.drag",pn,!0),setTimeout((function(){r.on("click.drag",null)}),0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var yn=function(t,e,n){t.prototype=e.prototype=n,n.constructor=t};function mn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function bn(){}var vn="\\s*([+-]?\\d+)\\s*",xn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",wn="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Mn=/^#([0-9a-f]{3,8})$/,kn=new RegExp("^rgb\\("+[vn,vn,vn]+"\\)$"),En=new RegExp("^rgb\\("+[wn,wn,wn]+"\\)$"),Sn=new RegExp("^rgba\\("+[vn,vn,vn,xn]+"\\)$"),zn=new RegExp("^rgba\\("+[wn,wn,wn,xn]+"\\)$"),Nn=new RegExp("^hsl\\("+[xn,wn,wn]+"\\)$"),Tn=new RegExp("^hsla\\("+[xn,wn,wn,xn]+"\\)$"),An={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Cn(){return this.rgb().formatHex()}function Pn(){return this.rgb().formatRgb()}function Rn(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=Mn.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?On(e):3===n?new $n(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?Ln(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?Ln(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=kn.exec(t))?new $n(e[1],e[2],e[3],1):(e=En.exec(t))?new $n(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Sn.exec(t))?Ln(e[1],e[2],e[3],e[4]):(e=zn.exec(t))?Ln(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Nn.exec(t))?qn(e[1],e[2]/100,e[3]/100,1):(e=Tn.exec(t))?qn(e[1],e[2]/100,e[3]/100,e[4]):An.hasOwnProperty(t)?On(An[t]):"transparent"===t?new $n(NaN,NaN,NaN,0):null}function On(t){return new $n(t>>16&255,t>>8&255,255&t,1)}function Ln(t,e,n,r){return r<=0&&(t=e=n=NaN),new $n(t,e,n,r)}function Dn(t){return t instanceof bn||(t=Rn(t)),t?new $n((t=t.rgb()).r,t.g,t.b,t.opacity):new $n}function jn(t,e,n,r){return 1===arguments.length?Dn(t):new $n(t,e,n,null==r?1:r)}function $n(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function In(){return"#"+Un(this.r)+Un(this.g)+Un(this.b)}function Bn(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}function Un(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function qn(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Hn(t,e,n,r)}function Fn(t){if(t instanceof Hn)return new Hn(t.h,t.s,t.l,t.opacity);if(t instanceof bn||(t=Rn(t)),!t)return new Hn;if(t instanceof Hn)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),a=Math.max(e,n,r),o=NaN,s=a-i,u=(a+i)/2;return s?(o=e===a?(n-r)/s+6*(n<r):n===a?(r-e)/s+2:(e-n)/s+4,s/=u<.5?a+i:2-a-i,o*=60):s=u>0&&u<1?0:o,new Hn(o,s,u,t.opacity)}function Yn(t,e,n,r){return 1===arguments.length?Fn(t):new Hn(t,e,n,null==r?1:r)}function Hn(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function Gn(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function Vn(t,e,n,r,i){var a=t*t,o=a*t;return((1-3*t+3*a-o)*e+(4-6*a+3*o)*n+(1+3*t+3*a-3*o)*r+o*i)/6}yn(bn,Rn,{copy:function(t){return Object.assign(new this.constructor,this,t)},displayable:function(){return this.rgb().displayable()},hex:Cn,formatHex:Cn,formatHsl:function(){return Fn(this).formatHsl()},formatRgb:Pn,toString:Pn}),yn($n,jn,mn(bn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new $n(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new $n(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:In,formatHex:In,formatRgb:Bn,toString:Bn})),yn(Hn,Yn,mn(bn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new Hn(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Hn(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new $n(Gn(t>=240?t-240:t+120,i,r),Gn(t,i,r),Gn(t<120?t+240:t-120,i,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===t?")":", "+t+")")}}));var Xn=function(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],a=t[r+1],o=r>0?t[r-1]:2*i-a,s=r<e-1?t[r+2]:2*a-i;return Vn((n-r/e)*e,o,i,a,s)}},Zn=function(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],a=t[r%e],o=t[(r+1)%e],s=t[(r+2)%e];return Vn((n-r/e)*e,i,a,o,s)}},Wn=function(t){return function(){return t}};function Jn(t,e){return function(n){return t+n*e}}function Kn(t,e){var n=e-t;return n?Jn(t,n>180||n<-180?n-360*Math.round(n/360):n):Wn(isNaN(t)?e:t)}function Qn(t){return 1==(t=+t)?tr:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):Wn(isNaN(e)?n:e)}}function tr(t,e){var n=e-t;return n?Jn(t,n):Wn(isNaN(t)?e:t)}var er=function t(e){var n=Qn(e);function r(t,e){var r=n((t=jn(t)).r,(e=jn(e)).r),i=n(t.g,e.g),a=n(t.b,e.b),o=tr(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=a(e),t.opacity=o(e),t+""}}return r.gamma=t,r}(1);function nr(t){return function(e){var n,r,i=e.length,a=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)r=jn(e[n]),a[n]=r.r||0,o[n]=r.g||0,s[n]=r.b||0;return a=t(a),o=t(o),s=t(s),r.opacity=1,function(t){return r.r=a(t),r.g=o(t),r.b=s(t),r+""}}}var rr=nr(Xn),ir=nr(Zn),ar=function(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(a){for(n=0;n<r;++n)i[n]=t[n]*(1-a)+e[n]*a;return i}};function or(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}var sr=function(t,e){return(or(e)?ar:ur)(t,e)};function ur(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,a=new Array(i),o=new Array(r);for(n=0;n<i;++n)a[n]=yr(t[n],e[n]);for(;n<r;++n)o[n]=e[n];return function(t){for(n=0;n<i;++n)o[n]=a[n](t);return o}}var lr=function(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}},cr=function(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}},hr=function(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=yr(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}},fr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dr=new RegExp(fr.source,"g");var pr,_r,gr=function(t,e){var n,r,i,a=fr.lastIndex=dr.lastIndex=0,o=-1,s=[],u=[];for(t+="",e+="";(n=fr.exec(t))&&(r=dr.exec(e));)(i=r.index)>a&&(i=e.slice(a,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(r=r[0])?s[o]?s[o]+=r:s[++o]=r:(s[++o]=null,u.push({i:o,x:cr(n,r)})),a=dr.lastIndex;return a<e.length&&(i=e.slice(a),s[o]?s[o]+=i:s[++o]=i),s.length<2?u[0]?function(t){return function(e){return t(e)+""}}(u[0].x):function(t){return function(){return t}}(e):(e=u.length,function(t){for(var n,r=0;r<e;++r)s[(n=u[r]).i]=n.x(t);return s.join("")})},yr=function(t,e){var n,r=typeof e;return null==e||"boolean"===r?Wn(e):("number"===r?cr:"string"===r?(n=Rn(e))?(e=n,er):gr:e instanceof Rn?er:e instanceof Date?lr:or(e)?ar:Array.isArray(e)?ur:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?hr:cr)(t,e)},mr=function(){for(var t,e=Je;t=e.sourceEvent;)e=t;return e},br=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,[(r=r.matrixTransform(t.getScreenCTM().inverse())).x,r.y]}var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]},vr=function(t,e,n){arguments.length<3&&(n=e,e=mr().changedTouches);for(var r,i=0,a=e?e.length:0;i<a;++i)if((r=e[i]).identifier===n)return br(t,r);return null},xr=function(t){var e=mr();return e.changedTouches&&(e=e.changedTouches[0]),br(t,e)},wr=0,Mr=0,kr=0,Er=0,Sr=0,zr=0,Nr="object"==typeof performance&&performance.now?performance:Date,Tr="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Ar(){return Sr||(Tr(Cr),Sr=Nr.now()+zr)}function Cr(){Sr=0}function Pr(){this._call=this._time=this._next=null}function Rr(t,e,n){var r=new Pr;return r.restart(t,e,n),r}function Or(){Ar(),++wr;for(var t,e=pr;e;)(t=Sr-e._time)>=0&&e._call.call(null,t),e=e._next;--wr}function Lr(){Sr=(Er=Nr.now())+zr,wr=Mr=0;try{Or()}finally{wr=0,function(){var t,e,n=pr,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:pr=e);_r=t,jr(r)}(),Sr=0}}function Dr(){var t=Nr.now(),e=t-Er;e>1e3&&(zr-=e,Er=t)}function jr(t){wr||(Mr&&(Mr=clearTimeout(Mr)),t-Sr>24?(t<1/0&&(Mr=setTimeout(Lr,t-Nr.now()-zr)),kr&&(kr=clearInterval(kr))):(kr||(Er=Nr.now(),kr=setInterval(Dr,1e3)),wr=1,Tr(Lr)))}Pr.prototype=Rr.prototype={constructor:Pr,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?Ar():+n)+(null==e?0:+e),this._next||_r===this||(_r?_r._next=this:pr=this,_r=this),this._call=t,this._time=n,jr()},stop:function(){this._call&&(this._call=null,this._time=1/0,jr())}};var $r=function(t,e,n){var r=new Pr;return e=null==e?0:+e,r.restart((function(n){r.stop(),t(n+e)}),e,n),r},Ir=Qt("start","end","cancel","interrupt"),Br=[],Ur=function(t,e,n,r,i,a){var o=t.__transition;if(o){if(n in o)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function a(u){var l,c,h,f;if(1!==n.state)return s();for(l in i)if((f=i[l]).name===n.name){if(3===f.state)return $r(a);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[l]):+l<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[l])}if($r((function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(u))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,r=new Array(h=n.tween.length),l=0,c=-1;l<h;++l)(f=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function o(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(s),n.state=5,1),a=-1,o=r.length;++a<o;)r[a].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),s())}function s(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=Rr((function(t){n.state=1,n.timer.restart(a,n.delay,n.time),n.delay<=t&&a(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:Ir,tween:Br,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:0})};function qr(t,e){var n=Yr(t,e);if(n.state>0)throw new Error("too late; already scheduled");return n}function Fr(t,e){var n=Yr(t,e);if(n.state>3)throw new Error("too late; already running");return n}function Yr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}var Hr,Gr,Vr,Xr,Zr=function(t,e){var n,r,i,a=t.__transition,o=!0;if(a){for(i in e=null==e?null:e+"",a)(n=a[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete a[i]):o=!1;o&&delete t.__transition}},Wr=180/Math.PI,Jr={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1},Kr=function(t,e,n,r,i,a){var o,s,u;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,o=-o),{translateX:i,translateY:a,rotate:Math.atan2(e,t)*Wr,skewX:Math.atan(u)*Wr,scaleX:o,scaleY:s}};function Qr(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(a,o){var s=[],u=[];return a=t(a),o=t(o),function(t,r,i,a,o,s){if(t!==i||r!==a){var u=o.push("translate(",null,e,null,n);s.push({i:u-4,x:cr(t,i)},{i:u-2,x:cr(r,a)})}else(i||a)&&o.push("translate("+i+e+a+n)}(a.translateX,a.translateY,o.translateX,o.translateY,s,u),function(t,e,n,a){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),a.push({i:n.push(i(n)+"rotate(",null,r)-2,x:cr(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(a.rotate,o.rotate,s,u),function(t,e,n,a){t!==e?a.push({i:n.push(i(n)+"skewX(",null,r)-2,x:cr(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(a.skewX,o.skewX,s,u),function(t,e,n,r,a,o){if(t!==n||e!==r){var s=a.push(i(a)+"scale(",null,",",null,")");o.push({i:s-4,x:cr(t,n)},{i:s-2,x:cr(e,r)})}else 1===n&&1===r||a.push(i(a)+"scale("+n+","+r+")")}(a.scaleX,a.scaleY,o.scaleX,o.scaleY,s,u),a=o=null,function(t){for(var e,n=-1,r=u.length;++n<r;)s[(e=u[n]).i]=e.x(t);return s.join("")}}}var ti=Qr((function(t){return"none"===t?Jr:(Hr||(Hr=document.createElement("DIV"),Gr=document.documentElement,Vr=document.defaultView),Hr.style.transform=t,t=Vr.getComputedStyle(Gr.appendChild(Hr),null).getPropertyValue("transform"),Gr.removeChild(Hr),t=t.slice(7,-1).split(","),Kr(+t[0],+t[1],+t[2],+t[3],+t[4],+t[5]))}),"px, ","px)","deg)"),ei=Qr((function(t){return null==t?Jr:(Xr||(Xr=document.createElementNS("http://www.w3.org/2000/svg","g")),Xr.setAttribute("transform",t),(t=Xr.transform.baseVal.consolidate())?(t=t.matrix,Kr(t.a,t.b,t.c,t.d,t.e,t.f)):Jr)}),", ",")",")");function ni(t,e){var n,r;return function(){var i=Fr(this,t),a=i.tween;if(a!==n)for(var o=0,s=(r=n=a).length;o<s;++o)if(r[o].name===e){(r=r.slice()).splice(o,1);break}i.tween=r}}function ri(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var a=Fr(this,t),o=a.tween;if(o!==r){i=(r=o).slice();for(var s={name:e,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=s;break}u===l&&i.push(s)}a.tween=i}}function ii(t,e,n){var r=t._id;return t.each((function(){var t=Fr(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return Yr(t,r).value[e]}}var ai=function(t,e){var n;return("number"==typeof e?cr:e instanceof Rn?er:(n=Rn(e))?(e=n,er):gr)(t,e)};function oi(t){return function(){this.removeAttribute(t)}}function si(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ui(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttribute(t);return o===a?null:o===r?i:i=e(r=o,n)}}function li(t,e,n){var r,i,a=n+"";return function(){var o=this.getAttributeNS(t.space,t.local);return o===a?null:o===r?i:i=e(r=o,n)}}function ci(t,e,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttribute(t))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,u));this.removeAttribute(t)}}function hi(t,e,n){var r,i,a;return function(){var o,s,u=n(this);if(null!=u)return(o=this.getAttributeNS(t.space,t.local))===(s=u+"")?null:o===r&&s===i?a:(i=s,a=e(r=o,u));this.removeAttributeNS(t.space,t.local)}}function fi(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function di(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function pi(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&di(t,i)),n}return i._value=e,i}function _i(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&fi(t,i)),n}return i._value=e,i}function gi(t,e){return function(){qr(this,t).delay=+e.apply(this,arguments)}}function yi(t,e){return e=+e,function(){qr(this,t).delay=e}}function mi(t,e){return function(){Fr(this,t).duration=+e.apply(this,arguments)}}function bi(t,e){return e=+e,function(){Fr(this,t).duration=e}}function vi(t,e){if("function"!=typeof e)throw new Error;return function(){Fr(this,t).ease=e}}function xi(t,e,n){var r,i,a=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?qr:Fr;return function(){var o=a(this,t),s=o.on;s!==r&&(i=(r=s).copy()).on(e,n),o.on=i}}var wi=hn.prototype.constructor;function Mi(t){return function(){this.style.removeProperty(t)}}function ki(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function Ei(t,e,n){var r,i;function a(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&ki(t,a,n)),r}return a._value=e,a}function Si(t){return function(e){this.textContent=t.call(this,e)}}function zi(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Si(r)),e}return r._value=t,r}var Ni=0;function Ti(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Ai(t){return hn().transition(t)}function Ci(){return++Ni}var Pi=hn.prototype;function Ri(t){return t*t*t}function Oi(t){return--t*t*t+1}function Li(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Ti.prototype=Ai.prototype={constructor:Ti,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ee(t));for(var r=this._groups,i=r.length,a=new Array(i),o=0;o<i;++o)for(var s,u,l=r[o],c=l.length,h=a[o]=new Array(c),f=0;f<c;++f)(s=l[f])&&(u=t.call(s,s.__data__,f,l))&&("__data__"in s&&(u.__data__=s.__data__),h[f]=u,Ur(h[f],e,n,f,h,Yr(s,n)));return new Ti(a,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=re(t));for(var r=this._groups,i=r.length,a=[],o=[],s=0;s<i;++s)for(var u,l=r[s],c=l.length,h=0;h<c;++h)if(u=l[h]){for(var f,d=t.call(u,u.__data__,h,l),p=Yr(u,n),_=0,g=d.length;_<g;++_)(f=d[_])&&Ur(f,e,n,_,d,p);a.push(d),o.push(u)}return new Ti(a,o,e,n)},filter:function(t){"function"!=typeof t&&(t=ie(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var a,o=e[i],s=o.length,u=r[i]=[],l=0;l<s;++l)(a=o[l])&&t.call(a,a.__data__,l,o)&&u.push(a);return new Ti(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,a=Math.min(r,i),o=new Array(r),s=0;s<a;++s)for(var u,l=e[s],c=n[s],h=l.length,f=o[s]=new Array(h),d=0;d<h;++d)(u=l[d]||c[d])&&(f[d]=u);for(;s<r;++s)o[s]=e[s];return new Ti(o,this._parents,this._name,this._id)},selection:function(){return new wi(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Ci(),r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)if(o=s[l]){var c=Yr(o,e);Ur(o,t,n,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new Ti(r,this._parents,t,n)},call:Pi.call,nodes:Pi.nodes,node:Pi.node,size:Pi.size,empty:Pi.empty,each:Pi.each,on:function(t,e){var n=this._id;return arguments.length<2?Yr(this.node(),n).on.on(t):this.each(xi(n,t,e))},attr:function(t,e){var n=fe(t),r="transform"===n?ei:ai;return this.attrTween(t,"function"==typeof e?(n.local?hi:ci)(n,r,ii(this,"attr."+t,e)):null==e?(n.local?si:oi)(n):(n.local?li:ui)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=fe(t);return this.tween(n,(r.local?pi:_i)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?ti:ai;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var a=Me(this,t),o=(this.style.removeProperty(t),Me(this,t));return a===o?null:a===n&&o===r?i:i=e(n=a,r=o)}}(t,r)).on("end.style."+t,Mi(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,a;return function(){var o=Me(this,t),s=n(this),u=s+"";return null==s&&(this.style.removeProperty(t),u=s=Me(this,t)),o===u?null:o===r&&u===i?a:(i=u,a=e(r=o,s))}}(t,r,ii(this,"style."+t,e))).each(function(t,e){var n,r,i,a,o="style."+e,s="end."+o;return function(){var u=Fr(this,t),l=u.on,c=null==u.value[o]?a||(a=Mi(e)):void 0;l===n&&i===c||(r=(n=l).copy()).on(s,i=c),u.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,a=n+"";return function(){var o=Me(this,t);return o===a?null:o===r?i:i=e(r=o,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,Ei(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(ii(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,zi(t))},remove:function(){return this.on("end.remove",(t=this._id,function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}));var t},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=Yr(this.node(),n).tween,a=0,o=i.length;a<o;++a)if((r=i[a]).name===t)return r.value;return null}return this.each((null==e?ni:ri)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?gi:yi)(e,t)):Yr(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?mi:bi)(e,t)):Yr(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(vi(e,t)):Yr(this.node(),e).ease},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(a,o){var s={value:o},u={value:function(){0==--i&&a()}};n.each((function(){var n=Fr(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(s),e._.interrupt.push(s),e._.end.push(u)),n.on=e}))}))}};var Di={time:null,delay:0,duration:250,ease:Li};function ji(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))return Di.time=Ar(),Di;return n}hn.prototype.interrupt=function(t){return this.each((function(){Zr(this,t)}))},hn.prototype.transition=function(t){var e,n;t instanceof Ti?(e=t._id,t=t._name):(e=Ci(),(n=Di).time=Ar(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var o,s=r[a],u=s.length,l=0;l<u;++l)(o=s[l])&&Ur(o,t,e,l,s,n||ji(o,e));return new Ti(r,this._parents,t,e)};var $i=[null],Ii=function(t,e){var n,r,i=t.__transition;if(i)for(r in e=null==e?null:e+"",i)if((n=i[r]).state>1&&n.name===e)return new Ti([[t]],$i,e,+r);return null},Bi=function(t){return function(){return t}},Ui=function(t,e,n){this.target=t,this.type=e,this.selection=n};function qi(){Je.stopImmediatePropagation()}var Fi=function(){Je.preventDefault(),Je.stopImmediatePropagation()},Yi={name:"drag"},Hi={name:"space"},Gi={name:"handle"},Vi={name:"center"};function Xi(t){return[+t[0],+t[1]]}function Zi(t){return[Xi(t[0]),Xi(t[1])]}function Wi(t){return function(e){return vr(e,Je.touches,t)}}var Ji={name:"x",handles:["w","e"].map(aa),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Ki={name:"y",handles:["n","s"].map(aa),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Qi={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(aa),input:function(t){return null==t?null:Zi(t)},output:function(t){return t}},ta={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},ea={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},na={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},ra={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},ia={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function aa(t){return{type:t}}function oa(){return!Je.ctrlKey&&!Je.button}function sa(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function ua(){return navigator.maxTouchPoints||"ontouchstart"in this}function la(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function ca(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function ha(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function fa(){return _a(Ji)}function da(){return _a(Ki)}var pa=function(){return _a(Qi)};function _a(t){var e,n=sa,r=oa,i=ua,a=!0,o=Qt("start","brush","end"),s=6;function u(e){var n=e.property("__brush",_).selectAll(".overlay").data([aa("overlay")]);n.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",ta.overlay).merge(n).each((function(){var t=la(this).extent;fn(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),e.selectAll(".selection").data([aa("selection")]).enter().append("rect").attr("class","selection").attr("cursor",ta.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var r=e.selectAll(".handle").data(t.handles,(function(t){return t.type}));r.exit().remove(),r.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return ta[t.type]})),e.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(i).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function l(){var t=fn(this),e=la(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-s/2:e[0][0]-s/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-s/2:e[0][1]-s/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+s:s})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+s:s}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function c(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new h(t,e,n):r}function h(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function f(){if((!e||Je.touches)&&r.apply(this,arguments)){var n,i,o,s,u,h,f,d,p,_,g,y=this,m=Je.target.__data__.type,b="selection"===(a&&Je.metaKey?m="overlay":m)?Yi:a&&Je.altKey?Vi:Gi,v=t===Ki?null:ra[m],x=t===Ji?null:ia[m],w=la(y),M=w.extent,k=w.selection,E=M[0][0],S=M[0][1],z=M[1][0],N=M[1][1],T=0,A=0,C=v&&x&&a&&Je.shiftKey,P=Je.touches?Wi(Je.changedTouches[0].identifier):xr,R=P(y),O=R,L=c(y,arguments,!0).beforestart();"overlay"===m?(k&&(p=!0),w.selection=k=[[n=t===Ki?E:R[0],o=t===Ji?S:R[1]],[u=t===Ki?z:n,f=t===Ji?N:o]]):(n=k[0][0],o=k[0][1],u=k[1][0],f=k[1][1]),i=n,s=o,h=u,d=f;var D=fn(y).attr("pointer-events","none"),j=D.selectAll(".overlay").attr("cursor",ta[m]);if(Je.touches)L.moved=I,L.ended=U;else{var $=fn(Je.view).on("mousemove.brush",I,!0).on("mouseup.brush",U,!0);a&&$.on("keydown.brush",q,!0).on("keyup.brush",F,!0),_n(Je.view)}qi(),Zr(y),l.call(y),L.start()}function I(){var t=P(y);!C||_||g||(Math.abs(t[0]-O[0])>Math.abs(t[1]-O[1])?g=!0:_=!0),O=t,p=!0,Fi(),B()}function B(){var t;switch(T=O[0]-R[0],A=O[1]-R[1],b){case Hi:case Yi:v&&(T=Math.max(E-n,Math.min(z-u,T)),i=n+T,h=u+T),x&&(A=Math.max(S-o,Math.min(N-f,A)),s=o+A,d=f+A);break;case Gi:v<0?(T=Math.max(E-n,Math.min(z-n,T)),i=n+T,h=u):v>0&&(T=Math.max(E-u,Math.min(z-u,T)),i=n,h=u+T),x<0?(A=Math.max(S-o,Math.min(N-o,A)),s=o+A,d=f):x>0&&(A=Math.max(S-f,Math.min(N-f,A)),s=o,d=f+A);break;case Vi:v&&(i=Math.max(E,Math.min(z,n-T*v)),h=Math.max(E,Math.min(z,u+T*v))),x&&(s=Math.max(S,Math.min(N,o-A*x)),d=Math.max(S,Math.min(N,f+A*x)))}h<i&&(v*=-1,t=n,n=u,u=t,t=i,i=h,h=t,m in ea&&j.attr("cursor",ta[m=ea[m]])),d<s&&(x*=-1,t=o,o=f,f=t,t=s,s=d,d=t,m in na&&j.attr("cursor",ta[m=na[m]])),w.selection&&(k=w.selection),_&&(i=k[0][0],h=k[1][0]),g&&(s=k[0][1],d=k[1][1]),k[0][0]===i&&k[0][1]===s&&k[1][0]===h&&k[1][1]===d||(w.selection=[[i,s],[h,d]],l.call(y),L.brush())}function U(){if(qi(),Je.touches){if(Je.touches.length)return;e&&clearTimeout(e),e=setTimeout((function(){e=null}),500)}else gn(Je.view,p),$.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);D.attr("pointer-events","all"),j.attr("cursor",ta.overlay),w.selection&&(k=w.selection),ca(k)&&(w.selection=null,l.call(y)),L.end()}function q(){switch(Je.keyCode){case 16:C=v&&x;break;case 18:b===Gi&&(v&&(u=h-T*v,n=i+T*v),x&&(f=d-A*x,o=s+A*x),b=Vi,B());break;case 32:b!==Gi&&b!==Vi||(v<0?u=h-T:v>0&&(n=i-T),x<0?f=d-A:x>0&&(o=s-A),b=Hi,j.attr("cursor",ta.selection),B());break;default:return}Fi()}function F(){switch(Je.keyCode){case 16:C&&(_=g=C=!1,B());break;case 18:b===Vi&&(v<0?u=h:v>0&&(n=i),x<0?f=d:x>0&&(o=s),b=Gi,B());break;case 32:b===Hi&&(Je.altKey?(v&&(u=h-T*v,n=i+T*v),x&&(f=d-A*x,o=s+A*x),b=Vi):(v<0?u=h:v>0&&(n=i),x<0?f=d:x>0&&(o=s),b=Gi),j.attr("cursor",ta[m]),B());break;default:return}Fi()}}function d(){c(this,arguments).moved()}function p(){c(this,arguments).ended()}function _(){var e=this.__brush||{selection:null};return e.extent=Zi(n.apply(this,arguments)),e.dim=t,e}return u.move=function(e,n){e.selection?e.on("start.brush",(function(){c(this,arguments).beforestart().start()})).on("interrupt.brush end.brush",(function(){c(this,arguments).end()})).tween("brush",(function(){var e=this,r=e.__brush,i=c(e,arguments),a=r.selection,o=t.input("function"==typeof n?n.apply(this,arguments):n,r.extent),s=yr(a,o);function u(t){r.selection=1===t&&null===o?null:s(t),l.call(e),i.brush()}return null!==a&&null!==o?u:u(1)})):e.each((function(){var e=this,r=arguments,i=e.__brush,a=t.input("function"==typeof n?n.apply(e,r):n,i.extent),o=c(e,r).beforestart();Zr(e),i.selection=null===a?null:a,l.call(e),o.start().brush().end()}))},u.clear=function(t){u.move(t,null)},h.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(){return this.starting?(this.starting=!1,this.emit("start")):this.emit("brush"),this},brush:function(){return this.emit("brush"),this},end:function(){return 0==--this.active&&(delete this.state.emitter,this.emit("end")),this},emit:function(e){rn(new Ui(u,e,t.output(this.state.selection)),o.apply,o,[e,this.that,this.args])}},u.extent=function(t){return arguments.length?(n="function"==typeof t?t:Bi(Zi(t)),u):n},u.filter=function(t){return arguments.length?(r="function"==typeof t?t:Bi(!!t),u):r},u.touchable=function(t){return arguments.length?(i="function"==typeof t?t:Bi(!!t),u):i},u.handleSize=function(t){return arguments.length?(s=+t,u):s},u.keyModifiers=function(t){return arguments.length?(a=!!t,u):a},u.on=function(){var t=o.on.apply(o,arguments);return t===o?u:t},u}var ga=Math.cos,ya=Math.sin,ma=Math.PI,ba=ma/2,va=2*ma,xa=Math.max;function wa(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}var Ma=function(){var t=0,e=null,n=null,r=null;function i(i){var a,o,s,u,l,c,h=i.length,f=[],d=ht(h),p=[],_=[],g=_.groups=new Array(h),y=new Array(h*h);for(a=0,l=-1;++l<h;){for(o=0,c=-1;++c<h;)o+=i[l][c];f.push(o),p.push(ht(h)),a+=o}for(e&&d.sort((function(t,n){return e(f[t],f[n])})),n&&p.forEach((function(t,e){t.sort((function(t,r){return n(i[e][t],i[e][r])}))})),u=(a=xa(0,va-t*h)/a)?t:va/h,o=0,l=-1;++l<h;){for(s=o,c=-1;++c<h;){var m=d[l],b=p[m][c],v=i[m][b],x=o,w=o+=v*a;y[b*h+m]={index:m,subindex:b,startAngle:x,endAngle:w,value:v}}g[m]={index:m,startAngle:s,endAngle:o,value:f[m]},o+=u}for(l=-1;++l<h;)for(c=l-1;++c<h;){var M=y[c*h+l],k=y[l*h+c];(M.value||k.value)&&_.push(M.value<k.value?{source:k,target:M}:{source:M,target:k})}return r?_.sort(r):_}return i.padAngle=function(e){return arguments.length?(t=xa(0,e),i):t},i.sortGroups=function(t){return arguments.length?(e=t,i):e},i.sortSubgroups=function(t){return arguments.length?(n=t,i):n},i.sortChords=function(t){return arguments.length?(null==t?r=null:(r=wa(t))._=t,i):r&&r._},i},ka=Array.prototype.slice,Ea=function(t){return function(){return t}},Sa=Math.PI,za=2*Sa,Na=za-1e-6;function Ta(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Aa(){return new Ta}Ta.prototype=Aa.prototype={constructor:Ta,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+a)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var a=this._x1,o=this._y1,s=n-t,u=r-e,l=a-t,c=o-e,h=l*l+c*c;if(i<0)throw new Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(h>1e-6)if(Math.abs(c*s-u*l)>1e-6&&i){var f=n-a,d=r-o,p=s*s+u*u,_=f*f+d*d,g=Math.sqrt(p),y=Math.sqrt(h),m=i*Math.tan((Sa-Math.acos((p+h-_)/(2*g*y)))/2),b=m/y,v=m/g;Math.abs(b-1)>1e-6&&(this._+="L"+(t+b*l)+","+(e+b*c)),this._+="A"+i+","+i+",0,0,"+ +(c*f>l*d)+","+(this._x1=t+v*s)+","+(this._y1=e+v*u)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,r,i,a){t=+t,e=+e,a=!!a;var o=(n=+n)*Math.cos(r),s=n*Math.sin(r),u=t+o,l=e+s,c=1^a,h=a?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+u+","+l:(Math.abs(this._x1-u)>1e-6||Math.abs(this._y1-l)>1e-6)&&(this._+="L"+u+","+l),n&&(h<0&&(h=h%za+za),h>Na?this._+="A"+n+","+n+",0,1,"+c+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+c+","+(this._x1=u)+","+(this._y1=l):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=Sa)+","+c+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var Ca=Aa;function Pa(t){return t.source}function Ra(t){return t.target}function Oa(t){return t.radius}function La(t){return t.startAngle}function Da(t){return t.endAngle}var ja=function(){var t=Pa,e=Ra,n=Oa,r=La,i=Da,a=null;function o(){var o,s=ka.call(arguments),u=t.apply(this,s),l=e.apply(this,s),c=+n.apply(this,(s[0]=u,s)),h=r.apply(this,s)-ba,f=i.apply(this,s)-ba,d=c*ga(h),p=c*ya(h),_=+n.apply(this,(s[0]=l,s)),g=r.apply(this,s)-ba,y=i.apply(this,s)-ba;if(a||(a=o=Ca()),a.moveTo(d,p),a.arc(0,0,c,h,f),h===g&&f===y||(a.quadraticCurveTo(0,0,_*ga(g),_*ya(g)),a.arc(0,0,_,g,y)),a.quadraticCurveTo(0,0,d,p),a.closePath(),o)return a=null,o+""||null}return o.radius=function(t){return arguments.length?(n="function"==typeof t?t:Ea(+t),o):n},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:Ea(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:Ea(+t),o):i},o.source=function(e){return arguments.length?(t=e,o):t},o.target=function(t){return arguments.length?(e=t,o):e},o.context=function(t){return arguments.length?(a=null==t?null:t,o):a},o};function $a(){}function Ia(t,e){var n=new $a;if(t instanceof $a)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,a=t.length;if(null==e)for(;++i<a;)n.set(i,t[i]);else for(;++i<a;)n.set(e(r=t[i],i,t),r)}else if(t)for(var o in t)n.set(o,t[o]);return n}$a.prototype=Ia.prototype={constructor:$a,has:function(t){return"$"+t in this},get:function(t){return this["$"+t]},set:function(t,e){return this["$"+t]=e,this},remove:function(t){var e="$"+t;return e in this&&delete this[e]},clear:function(){for(var t in this)"$"===t[0]&&delete this[t]},keys:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)"$"===e[0]&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)"$"===e[0]&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)"$"===e[0]&&++t;return t},empty:function(){for(var t in this)if("$"===t[0])return!1;return!0},each:function(t){for(var e in this)"$"===e[0]&&t(this[e],e.slice(1),this)}};var Ba=Ia,Ua=function(){var t,e,n,r=[],i=[];function a(n,i,o,s){if(i>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var u,l,c,h=-1,f=n.length,d=r[i++],p=Ba(),_=o();++h<f;)(c=p.get(u=d(l=n[h])+""))?c.push(l):p.set(u,[l]);return p.each((function(t,e){s(_,e,a(t,i,o,s))})),_}return n={object:function(t){return a(t,0,qa,Fa)},map:function(t){return a(t,0,Ya,Ha)},entries:function(t){return function t(n,a){if(++a>r.length)return n;var o,s=i[a-1];return null!=e&&a>=r.length?o=n.entries():(o=[],n.each((function(e,n){o.push({key:n,values:t(e,a)})}))),null!=s?o.sort((function(t,e){return s(t.key,e.key)})):o}(a(t,0,Ya,Ha),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return i[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}};function qa(){return{}}function Fa(t,e,n){t[e]=n}function Ya(){return Ba()}function Ha(t,e,n){t.set(e,n)}function Ga(){}var Va=Ba.prototype;function Xa(t,e){var n=new Ga;if(t instanceof Ga)t.each((function(t){n.add(t)}));else if(t){var r=-1,i=t.length;if(null==e)for(;++r<i;)n.add(t[r]);else for(;++r<i;)n.add(e(t[r],r,t))}return n}Ga.prototype=Xa.prototype={constructor:Ga,has:Va.has,add:function(t){return this["$"+(t+="")]=t,this},remove:Va.remove,clear:Va.clear,values:Va.keys,size:Va.size,empty:Va.empty,each:Va.each};var Za=Xa,Wa=function(t){var e=[];for(var n in t)e.push(n);return e},Ja=function(t){var e=[];for(var n in t)e.push(t[n]);return e},Ka=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},Qa=Math.PI/180,to=180/Math.PI;function eo(t){if(t instanceof io)return new io(t.l,t.a,t.b,t.opacity);if(t instanceof fo)return po(t);t instanceof $n||(t=Dn(t));var e,n,r=uo(t.r),i=uo(t.g),a=uo(t.b),o=ao((.2225045*r+.7168786*i+.0606169*a)/1);return r===i&&i===a?e=n=o:(e=ao((.4360747*r+.3850649*i+.1430804*a)/.96422),n=ao((.0139322*r+.0971045*i+.7141733*a)/.82521)),new io(116*o-16,500*(e-o),200*(o-n),t.opacity)}function no(t,e){return new io(t,0,0,null==e?1:e)}function ro(t,e,n,r){return 1===arguments.length?eo(t):new io(t,e,n,null==r?1:r)}function io(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function ao(t){return t>6/29*(6/29)*(6/29)?Math.pow(t,1/3):t/(6/29*3*(6/29))+4/29}function oo(t){return t>6/29?t*t*t:6/29*3*(6/29)*(t-4/29)}function so(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function uo(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function lo(t){if(t instanceof fo)return new fo(t.h,t.c,t.l,t.opacity);if(t instanceof io||(t=eo(t)),0===t.a&&0===t.b)return new fo(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*to;return new fo(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function co(t,e,n,r){return 1===arguments.length?lo(t):new fo(n,e,t,null==r?1:r)}function ho(t,e,n,r){return 1===arguments.length?lo(t):new fo(t,e,n,null==r?1:r)}function fo(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function po(t){if(isNaN(t.h))return new io(t.l,0,0,t.opacity);var e=t.h*Qa;return new io(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}yn(io,ro,mn(bn,{brighter:function(t){return new io(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new io(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new $n(so(3.1338561*(e=.96422*oo(e))-1.6168667*(t=1*oo(t))-.4906146*(n=.82521*oo(n))),so(-.9787684*e+1.9161415*t+.033454*n),so(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),yn(fo,ho,mn(bn,{brighter:function(t){return new fo(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new fo(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return po(this).rgb()}}));var _o=-.29227,go=-1.7884503806,yo=3.5172982438,mo=-.6557636667999999;function bo(t){if(t instanceof xo)return new xo(t.h,t.s,t.l,t.opacity);t instanceof $n||(t=Dn(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(mo*r+go*e-yo*n)/(mo+go-yo),a=r-i,o=(1.97294*(n-i)-_o*a)/-.90649,s=Math.sqrt(o*o+a*a)/(1.97294*i*(1-i)),u=s?Math.atan2(o,a)*to-120:NaN;return new xo(u<0?u+360:u,s,i,t.opacity)}function vo(t,e,n,r){return 1===arguments.length?bo(t):new xo(t,e,n,null==r?1:r)}function xo(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}yn(xo,vo,mn(bn,{brighter:function(t){return t=null==t?1/.7:Math.pow(1/.7,t),new xo(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new xo(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Qa,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new $n(255*(e+n*(-.14861*r+1.78277*i)),255*(e+n*(_o*r+-.90649*i)),255*(e+n*(1.97294*r)),this.opacity)}}));var wo=Array.prototype.slice,Mo=function(t,e){return t-e},ko=function(t){return function(){return t}},Eo=function(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=So(t,e[r]))return n;return 0};function So(t,e){for(var n=e[0],r=e[1],i=-1,a=0,o=t.length,s=o-1;a<o;s=a++){var u=t[a],l=u[0],c=u[1],h=t[s],f=h[0],d=h[1];if(zo(u,h,e))return 0;c>r!=d>r&&n<(f-l)*(r-c)/(d-c)+l&&(i=-i)}return i}function zo(t,e,n){var r,i,a,o;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],a=n[r],o=e[r],i<=a&&a<=o||o<=a&&a<=i)}var No=function(){},To=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]],Ao=function(){var t=1,e=1,n=mt,r=s;function i(t){var e=n(t);if(Array.isArray(e))e=e.slice().sort(Mo);else{var r=at(t),i=r[0],o=r[1];e=yt(i,o,e),e=ht(Math.floor(i/e)*e,Math.floor(o/e)*e,e)}return e.map((function(e){return a(t,e)}))}function a(n,i){var a=[],s=[];return function(n,r,i){var a,s,u,l,c,h,f=new Array,d=new Array;a=s=-1,l=n[0]>=r,To[l<<1].forEach(p);for(;++a<t-1;)u=l,l=n[a+1]>=r,To[u|l<<1].forEach(p);To[l<<0].forEach(p);for(;++s<e-1;){for(a=-1,l=n[s*t+t]>=r,c=n[s*t]>=r,To[l<<1|c<<2].forEach(p);++a<t-1;)u=l,l=n[s*t+t+a+1]>=r,h=c,c=n[s*t+a+1]>=r,To[u|l<<1|c<<2|h<<3].forEach(p);To[l|c<<3].forEach(p)}a=-1,c=n[s*t]>=r,To[c<<2].forEach(p);for(;++a<t-1;)h=c,c=n[s*t+a+1]>=r,To[c<<2|h<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+a,t[0][1]+s],u=[t[1][0]+a,t[1][1]+s],l=o(r),c=o(u);(e=d[l])?(n=f[c])?(delete d[e.end],delete f[n.start],e===n?(e.ring.push(u),i(e.ring)):f[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(u),d[e.end=c]=e):(e=f[c])?(n=d[l])?(delete f[e.start],delete d[n.end],e===n?(e.ring.push(u),i(e.ring)):f[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(r),f[e.start=l]=e):f[l]=d[c]={start:l,end:c,ring:[r,u]}}To[c<<3].forEach(p)}(n,i,(function(t){r(t,n,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):s.push(t)})),s.forEach((function(t){for(var e,n=0,r=a.length;n<r;++n)if(-1!==Eo((e=a[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:a}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,r,i){n.forEach((function(n){var a,o=n[0],s=n[1],u=0|o,l=0|s,c=r[l*t+u];o>0&&o<t&&u===o&&(a=r[l*t+u-1],n[0]=o+(i-a)/(c-a)-.5),s>0&&s<e&&l===s&&(a=r[(l-1)*t+u],n[1]=s+(i-a)/(c-a)-.5)}))}return i.contour=a,i.size=function(n){if(!arguments.length)return[t,e];var r=Math.ceil(n[0]),a=Math.ceil(n[1]);if(!(r>0&&a>0))throw new Error("invalid size");return t=r,e=a,i},i.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?ko(wo.call(t)):ko(t),i):n},i.smooth=function(t){return arguments.length?(r=t?s:No,i):r===s},i};function Co(t,e,n){for(var r=t.width,i=t.height,a=1+(n<<1),o=0;o<i;++o)for(var s=0,u=0;s<r+n;++s)s<r&&(u+=t.data[s+o*r]),s>=n&&(s>=a&&(u-=t.data[s-a+o*r]),e.data[s-n+o*r]=u/Math.min(s+1,r-1+a-s,a))}function Po(t,e,n){for(var r=t.width,i=t.height,a=1+(n<<1),o=0;o<r;++o)for(var s=0,u=0;s<i+n;++s)s<i&&(u+=t.data[o+s*r]),s>=n&&(s>=a&&(u-=t.data[o+(s-a)*r]),e.data[o+(s-n)*r]=u/Math.min(s+1,i-1+a-s,a))}function Ro(t){return t[0]}function Oo(t){return t[1]}function Lo(){return 1}var Do=function(){var t=Ro,e=Oo,n=Lo,r=960,i=500,a=20,o=2,s=3*a,u=r+2*s>>o,l=i+2*s>>o,c=ko(20);function h(r){var i=new Float32Array(u*l),h=new Float32Array(u*l);r.forEach((function(r,a,c){var h=+t(r,a,c)+s>>o,f=+e(r,a,c)+s>>o,d=+n(r,a,c);h>=0&&h<u&&f>=0&&f<l&&(i[h+f*u]+=d)})),Co({width:u,height:l,data:i},{width:u,height:l,data:h},a>>o),Po({width:u,height:l,data:h},{width:u,height:l,data:i},a>>o),Co({width:u,height:l,data:i},{width:u,height:l,data:h},a>>o),Po({width:u,height:l,data:h},{width:u,height:l,data:i},a>>o),Co({width:u,height:l,data:i},{width:u,height:l,data:h},a>>o),Po({width:u,height:l,data:h},{width:u,height:l,data:i},a>>o);var d=c(i);if(!Array.isArray(d)){var p=Mt(i);d=yt(0,p,d),(d=ht(0,Math.floor(p/d)*d,d)).shift()}return Ao().thresholds(d).size([u,l])(i).map(f)}function f(t){return t.value*=Math.pow(2,-2*o),t.coordinates.forEach(d),t}function d(t){t.forEach(p)}function p(t){t.forEach(_)}function _(t){t[0]=t[0]*Math.pow(2,o)-s,t[1]=t[1]*Math.pow(2,o)-s}function g(){return u=r+2*(s=3*a)>>o,l=i+2*s>>o,h}return h.x=function(e){return arguments.length?(t="function"==typeof e?e:ko(+e),h):t},h.y=function(t){return arguments.length?(e="function"==typeof t?t:ko(+t),h):e},h.weight=function(t){return arguments.length?(n="function"==typeof t?t:ko(+t),h):n},h.size=function(t){if(!arguments.length)return[r,i];var e=Math.ceil(t[0]),n=Math.ceil(t[1]);if(!(e>=0||e>=0))throw new Error("invalid size");return r=e,i=n,g()},h.cellSize=function(t){if(!arguments.length)return 1<<o;if(!((t=+t)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(t)/Math.LN2),g()},h.thresholds=function(t){return arguments.length?(c="function"==typeof t?t:Array.isArray(t)?ko(wo.call(t)):ko(t),h):c},h.bandwidth=function(t){if(!arguments.length)return Math.sqrt(a*(a+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return a=Math.round((Math.sqrt(4*t*t+1)-1)/2),g()},h},jo=function(t){return function(){return t}};function $o(t,e,n,r,i,a,o,s,u,l){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=i,this.x=a,this.y=o,this.dx=s,this.dy=u,this._=l}function Io(){return!Je.ctrlKey&&!Je.button}function Bo(){return this.parentNode}function Uo(t){return null==t?{x:Je.x,y:Je.y}:t}function qo(){return navigator.maxTouchPoints||"ontouchstart"in this}$o.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Fo=function(){var t,e,n,r,i=Io,a=Bo,o=Uo,s=qo,u={},l=Qt("start","drag","end"),c=0,h=0;function f(t){t.on("mousedown.drag",d).filter(s).on("touchstart.drag",g).on("touchmove.drag",y).on("touchend.drag touchcancel.drag",m).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(){if(!r&&i.apply(this,arguments)){var o=b("mouse",a.apply(this,arguments),xr,this,arguments);o&&(fn(Je.view).on("mousemove.drag",p,!0).on("mouseup.drag",_,!0),_n(Je.view),dn(),n=!1,t=Je.clientX,e=Je.clientY,o("start"))}}function p(){if(pn(),!n){var r=Je.clientX-t,i=Je.clientY-e;n=r*r+i*i>h}u.mouse("drag")}function _(){fn(Je.view).on("mousemove.drag mouseup.drag",null),gn(Je.view,n),pn(),u.mouse("end")}function g(){if(i.apply(this,arguments)){var t,e,n=Je.changedTouches,r=a.apply(this,arguments),o=n.length;for(t=0;t<o;++t)(e=b(n[t].identifier,r,vr,this,arguments))&&(dn(),e("start"))}}function y(){var t,e,n=Je.changedTouches,r=n.length;for(t=0;t<r;++t)(e=u[n[t].identifier])&&(pn(),e("drag"))}function m(){var t,e,n=Je.changedTouches,i=n.length;for(r&&clearTimeout(r),r=setTimeout((function(){r=null}),500),t=0;t<i;++t)(e=u[n[t].identifier])&&(dn(),e("end"))}function b(t,e,n,r,i){var a,s,h,d=n(e,t),p=l.copy();if(rn(new $o(f,"beforestart",a,t,c,d[0],d[1],0,0,p),(function(){return null!=(Je.subject=a=o.apply(r,i))&&(s=a.x-d[0]||0,h=a.y-d[1]||0,!0)})))return function o(l){var _,g=d;switch(l){case"start":u[t]=o,_=c++;break;case"end":delete u[t],--c;case"drag":d=n(e,t),_=c}rn(new $o(f,l,a,t,_,d[0]+s,d[1]+h,d[0]-g[0],d[1]-g[1],p),p.apply,p,[l,r,i])}}return f.filter=function(t){return arguments.length?(i="function"==typeof t?t:jo(!!t),f):i},f.container=function(t){return arguments.length?(a="function"==typeof t?t:jo(t),f):a},f.subject=function(t){return arguments.length?(o="function"==typeof t?t:jo(t),f):o},f.touchable=function(t){return arguments.length?(s="function"==typeof t?t:jo(!!t),f):s},f.on=function(){var t=l.on.apply(l,arguments);return t===l?f:t},f.clickDistance=function(t){return arguments.length?(h=(t=+t)*t,f):Math.sqrt(h)},f},Yo={},Ho={};function Go(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function Vo(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function Xo(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function Zo(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),a=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+Xo(-e,6):e>9999?"+"+Xo(e,6):Xo(e,4))+"-"+Xo(t.getUTCMonth()+1,2)+"-"+Xo(t.getUTCDate(),2)+(a?"T"+Xo(n,2)+":"+Xo(r,2)+":"+Xo(i,2)+"."+Xo(a,3)+"Z":i?"T"+Xo(n,2)+":"+Xo(r,2)+":"+Xo(i,2)+"Z":r||n?"T"+Xo(n,2)+":"+Xo(r,2)+"Z":"")}var Wo=function(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],a=t.length,o=0,s=0,u=a<=0,l=!1;function c(){if(u)return Ho;if(l)return l=!1,Yo;var e,r,i=o;if(34===t.charCodeAt(i)){for(;o++<a&&34!==t.charCodeAt(o)||34===t.charCodeAt(++o););return(e=o)>=a?u=!0:10===(r=t.charCodeAt(o++))?l=!0:13===r&&(l=!0,10===t.charCodeAt(o)&&++o),t.slice(i+1,e-1).replace(/""/g,'"')}for(;o<a;){if(10===(r=t.charCodeAt(e=o++)))l=!0;else if(13===r)l=!0,10===t.charCodeAt(o)&&++o;else if(r!==n)continue;return t.slice(i,e)}return u=!0,t.slice(i,a)}for(10===t.charCodeAt(a-1)&&--a,13===t.charCodeAt(a-1)&&--a;(r=c())!==Ho;){for(var h=[];r!==Yo&&r!==Ho;)h.push(r),r=c();e&&null==(h=e(h,s++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return o(e[t])})).join(t)}))}function a(e){return e.map(o).join(t)}function o(t){return null==t?"":t instanceof Date?Zo(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,a=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=Go(t);return function(r,i){return e(n(r),i,t)}}(t,e):Go(t)}));return a.columns=i||[],a},parseRows:r,format:function(e,n){return null==n&&(n=Vo(e)),[n.map(o).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=Vo(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:o}},Jo=Wo(","),Ko=Jo.parse,Qo=Jo.parseRows,ts=Jo.format,es=Jo.formatBody,ns=Jo.formatRows,rs=Jo.formatRow,is=Jo.formatValue,as=Wo("\t"),os=as.parse,ss=as.parseRows,us=as.format,ls=as.formatBody,cs=as.formatRows,hs=as.formatRow,fs=as.formatValue;function ds(t){for(var e in t){var n,r,i=t[e].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;ps&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;t[e]=i}return t}var ps=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function _s(t){return+t}function gs(t){return t*t}function ys(t){return t*(2-t)}function ms(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}var bs=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),vs=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),xs=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),ws=Math.PI,Ms=ws/2;function ks(t){return 1==+t?1:1-Math.cos(t*Ms)}function Es(t){return Math.sin(t*Ms)}function Ss(t){return(1-Math.cos(ws*t))/2}function zs(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}function Ns(t){return zs(1-+t)}function Ts(t){return 1-zs(t)}function As(t){return((t*=2)<=1?zs(1-t):2-zs(t-1))/2}function Cs(t){return 1-Math.sqrt(1-t*t)}function Ps(t){return Math.sqrt(1- --t*t)}function Rs(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}function Os(t){return 1-Ls(1-t)}function Ls(t){return(t=+t)<4/11?7.5625*t*t:t<8/11?7.5625*(t-=6/11)*t+3/4:t<10/11?7.5625*(t-=9/11)*t+15/16:7.5625*(t-=21/22)*t+63/64}function Ds(t){return((t*=2)<=1?1-Ls(1-t):Ls(t-1)+1)/2}var js=function t(e){function n(t){return(t=+t)*t*(e*(t-1)+t)}return e=+e,n.overshoot=t,n}(1.70158),$s=function t(e){function n(t){return--t*t*((t+1)*e+t)+1}return e=+e,n.overshoot=t,n}(1.70158),Is=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(1.70158),Bs=2*Math.PI,Us=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Bs);function i(t){return e*zs(- --t)*Math.sin((r-t)/n)}return i.amplitude=function(e){return t(e,n*Bs)},i.period=function(n){return t(e,n)},i}(1,.3),qs=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Bs);function i(t){return 1-e*zs(t=+t)*Math.sin((t+r)/n)}return i.amplitude=function(e){return t(e,n*Bs)},i.period=function(n){return t(e,n)},i}(1,.3),Fs=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Bs);function i(t){return((t=2*t-1)<0?e*zs(-t)*Math.sin((r-t)/n):2-e*zs(t)*Math.sin((r+t)/n))/2}return i.amplitude=function(e){return t(e,n*Bs)},i.period=function(n){return t(e,n)},i}(1,.3);function Ys(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}var Hs=function(t,e){return fetch(t,e).then(Ys)};function Gs(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}var Vs=function(t,e){return fetch(t,e).then(Gs)};function Xs(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}var Zs=function(t,e){return fetch(t,e).then(Xs)};function Ws(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=void 0),Zs(e,n).then((function(e){return t(e,r)}))}}function Js(t,e,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var i=Wo(t);return Zs(e,n).then((function(t){return i.parse(t,r)}))}var Ks=Ws(Ko),Qs=Ws(os),tu=function(t,e){return new Promise((function(n,r){var i=new Image;for(var a in e)i[a]=e[a];i.onerror=r,i.onload=function(){n(i)},i.src=t}))};function eu(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}var nu=function(t,e){return fetch(t,e).then(eu)};function ru(t){return function(e,n){return Zs(e,n).then((function(e){return(new DOMParser).parseFromString(e,t)}))}}var iu=ru("application/xml"),au=ru("text/html"),ou=ru("image/svg+xml"),su=function(t,e){var n;function r(){var r,i,a=n.length,o=0,s=0;for(r=0;r<a;++r)o+=(i=n[r]).x,s+=i.y;for(o=o/a-t,s=s/a-e,r=0;r<a;++r)(i=n[r]).x-=o,i.y-=s}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r},uu=function(t){return function(){return t}},lu=function(){return 1e-6*(Math.random()-.5)};function cu(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,a,o,s,u,l,c,h,f,d=t._root,p={data:r},_=t._x0,g=t._y0,y=t._x1,m=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((l=e>=(a=(_+y)/2))?_=a:y=a,(c=n>=(o=(g+m)/2))?g=o:m=o,i=d,!(d=d[h=c<<1|l]))return i[h]=p,t;if(s=+t._x.call(null,d.data),u=+t._y.call(null,d.data),e===s&&n===u)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(l=e>=(a=(_+y)/2))?_=a:y=a,(c=n>=(o=(g+m)/2))?g=o:m=o}while((h=c<<1|l)==(f=(u>=o)<<1|s>=a));return i[f]=d,i[h]=p,t}var hu=function(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i};function fu(t){return t[0]}function du(t){return t[1]}function pu(t,e,n){var r=new _u(null==e?fu:e,null==n?du:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function _u(t,e,n,r,i,a){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=a,this._root=void 0}function gu(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var yu=pu.prototype=_u.prototype;function mu(t){return t.x+t.vx}function bu(t){return t.y+t.vy}yu.copy=function(){var t,e,n=new _u(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=gu(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=gu(e));return n},yu.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return cu(this.cover(e,n),e,n,t)},yu.addAll=function(t){var e,n,r,i,a=t.length,o=new Array(a),s=new Array(a),u=1/0,l=1/0,c=-1/0,h=-1/0;for(n=0;n<a;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(o[n]=r,s[n]=i,r<u&&(u=r),r>c&&(c=r),i<l&&(l=i),i>h&&(h=i));if(u>c||l>h)return this;for(this.cover(u,l).cover(c,h),n=0;n<a;++n)cu(this,o[n],s[n],t[n]);return this},yu.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,a=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,a=(r=Math.floor(e))+1;else{for(var o,s,u=i-n,l=this._root;n>t||t>=i||r>e||e>=a;)switch(s=(e<r)<<1|t<n,(o=new Array(4))[s]=l,l=o,u*=2,s){case 0:i=n+u,a=r+u;break;case 1:n=i-u,a=r+u;break;case 2:i=n+u,r=a-u;break;case 3:n=i-u,r=a-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=i,this._y1=a,this},yu.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},yu.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},yu.find=function(t,e,n){var r,i,a,o,s,u,l,c=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],_=this._root;for(_&&p.push(new hu(_,c,h,f,d)),null==n?n=1/0:(c=t-n,h=e-n,f=t+n,d=e+n,n*=n);u=p.pop();)if(!(!(_=u.node)||(i=u.x0)>f||(a=u.y0)>d||(o=u.x1)<c||(s=u.y1)<h))if(_.length){var g=(i+o)/2,y=(a+s)/2;p.push(new hu(_[3],g,y,o,s),new hu(_[2],i,y,g,s),new hu(_[1],g,a,o,y),new hu(_[0],i,a,g,y)),(l=(e>=y)<<1|t>=g)&&(u=p[p.length-1],p[p.length-1]=p[p.length-1-l],p[p.length-1-l]=u)}else{var m=t-+this._x.call(null,_.data),b=e-+this._y.call(null,_.data),v=m*m+b*b;if(v<n){var x=Math.sqrt(n=v);c=t-x,h=e-x,f=t+x,d=e+x,r=_.data}}return r},yu.remove=function(t){if(isNaN(a=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,i,a,o,s,u,l,c,h,f,d=this._root,p=this._x0,_=this._y0,g=this._x1,y=this._y1;if(!d)return this;if(d.length)for(;;){if((l=a>=(s=(p+g)/2))?p=s:g=s,(c=o>=(u=(_+y)/2))?_=u:y=u,e=d,!(d=d[h=c<<1|l]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},yu.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},yu.root=function(){return this._root},yu.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},yu.visit=function(t){var e,n,r,i,a,o,s=[],u=this._root;for(u&&s.push(new hu(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,i=e.y0,a=e.x1,o=e.y1)&&u.length){var l=(r+a)/2,c=(i+o)/2;(n=u[3])&&s.push(new hu(n,l,c,a,o)),(n=u[2])&&s.push(new hu(n,r,c,l,o)),(n=u[1])&&s.push(new hu(n,l,i,a,c)),(n=u[0])&&s.push(new hu(n,r,i,l,c))}return this},yu.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new hu(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var a,o=e.x0,s=e.y0,u=e.x1,l=e.y1,c=(o+u)/2,h=(s+l)/2;(a=i[0])&&n.push(new hu(a,o,s,c,h)),(a=i[1])&&n.push(new hu(a,c,s,u,h)),(a=i[2])&&n.push(new hu(a,o,h,c,l)),(a=i[3])&&n.push(new hu(a,c,h,u,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},yu.x=function(t){return arguments.length?(this._x=t,this):this._x},yu.y=function(t){return arguments.length?(this._y=t,this):this._y};var vu=function(t){var e,n,r=1,i=1;function a(){for(var t,a,s,u,l,c,h,f=e.length,d=0;d<i;++d)for(a=pu(e,mu,bu).visitAfter(o),t=0;t<f;++t)s=e[t],c=n[s.index],h=c*c,u=s.x+s.vx,l=s.y+s.vy,a.visit(p);function p(t,e,n,i,a){var o=t.data,f=t.r,d=c+f;if(!o)return e>u+d||i<u-d||n>l+d||a<l-d;if(o.index>s.index){var p=u-o.x-o.vx,_=l-o.y-o.vy,g=p*p+_*_;g<d*d&&(0===p&&(g+=(p=lu())*p),0===_&&(g+=(_=lu())*_),g=(d-(g=Math.sqrt(g)))/g*r,s.vx+=(p*=g)*(d=(f*=f)/(h+f)),s.vy+=(_*=g)*d,o.vx-=p*(d=1-d),o.vy-=_*d)}}}function o(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function s(){if(e){var r,i,a=e.length;for(n=new Array(a),r=0;r<a;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=uu(null==t?1:+t)),a.initialize=function(t){e=t,s()},a.iterations=function(t){return arguments.length?(i=+t,a):i},a.strength=function(t){return arguments.length?(r=+t,a):r},a.radius=function(e){return arguments.length?(t="function"==typeof e?e:uu(+e),s(),a):t},a};function xu(t){return t.index}function wu(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}var Mu=function(t){var e,n,r,i,a,o=xu,s=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=uu(30),l=1;function c(r){for(var i=0,o=t.length;i<l;++i)for(var s,u,c,h,f,d,p,_=0;_<o;++_)u=(s=t[_]).source,h=(c=s.target).x+c.vx-u.x-u.vx||lu(),f=c.y+c.vy-u.y-u.vy||lu(),h*=d=((d=Math.sqrt(h*h+f*f))-n[_])/d*r*e[_],f*=d,c.vx-=h*(p=a[_]),c.vy-=f*p,u.vx+=h*(p=1-p),u.vy+=f*p}function h(){if(r){var s,u,l=r.length,c=t.length,h=Ba(r,o);for(s=0,i=new Array(l);s<c;++s)(u=t[s]).index=s,"object"!=typeof u.source&&(u.source=wu(h,u.source)),"object"!=typeof u.target&&(u.target=wu(h,u.target)),i[u.source.index]=(i[u.source.index]||0)+1,i[u.target.index]=(i[u.target.index]||0)+1;for(s=0,a=new Array(c);s<c;++s)u=t[s],a[s]=i[u.source.index]/(i[u.source.index]+i[u.target.index]);e=new Array(c),f(),n=new Array(c),d()}}function f(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+s(t[n],n,t)}function d(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),c.initialize=function(t){r=t,h()},c.links=function(e){return arguments.length?(t=e,h(),c):t},c.id=function(t){return arguments.length?(o=t,c):o},c.iterations=function(t){return arguments.length?(l=+t,c):l},c.strength=function(t){return arguments.length?(s="function"==typeof t?t:uu(+t),f(),c):s},c.distance=function(t){return arguments.length?(u="function"==typeof t?t:uu(+t),d(),c):u},c};function ku(t){return t.x}function Eu(t){return t.y}var Su=Math.PI*(3-Math.sqrt(5)),zu=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),a=0,o=.6,s=Ba(),u=Rr(c),l=Qt("tick","end");function c(){h(),l.call("tick",e),n<r&&(u.stop(),l.call("end",e))}function h(r){var u,l,c=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(a-n)*i,s.each((function(t){t(n)})),u=0;u<c;++u)null==(l=t[u]).fx?l.x+=l.vx*=o:(l.x=l.fx,l.vx=0),null==l.fy?l.y+=l.vy*=o:(l.y=l.fy,l.vy=0);return e}function f(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(n),a=n*Su;e.x=i*Math.cos(a),e.y=i*Math.sin(a)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),f(),e={tick:h,restart:function(){return u.restart(c),e},stop:function(){return u.stop(),e},nodes:function(n){return arguments.length?(t=n,f(),s.each(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(a=+t,e):a},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},force:function(t,n){return arguments.length>1?(null==n?s.remove(t):s.set(t,d(n)),e):s.get(t)},find:function(e,n,r){var i,a,o,s,u,l=0,c=t.length;for(null==r?r=1/0:r*=r,l=0;l<c;++l)(o=(i=e-(s=t[l]).x)*i+(a=n-s.y)*a)<r&&(u=s,r=o);return u},on:function(t,n){return arguments.length>1?(l.on(t,n),e):l.on(t)}}},Nu=function(){var t,e,n,r,i=uu(-30),a=1,o=1/0,s=.81;function u(r){var i,a=t.length,o=pu(t,ku,Eu).visitAfter(c);for(n=r,i=0;i<a;++i)e=t[i],o.visit(h)}function l(){if(t){var e,n,a=t.length;for(r=new Array(a),e=0;e<a;++e)n=t[e],r[n.index]=+i(n,e,t)}}function c(t){var e,n,i,a,o,s=0,u=0;if(t.length){for(i=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(s+=e.value,u+=n,i+=n*e.x,a+=n*e.y);t.x=i/u,t.y=a/u}else{(e=t).x=e.data.x,e.y=e.data.y;do{s+=r[e.data.index]}while(e=e.next)}t.value=s}function h(t,i,u,l){if(!t.value)return!0;var c=t.x-e.x,h=t.y-e.y,f=l-i,d=c*c+h*h;if(f*f/s<d)return d<o&&(0===c&&(d+=(c=lu())*c),0===h&&(d+=(h=lu())*h),d<a&&(d=Math.sqrt(a*d)),e.vx+=c*t.value*n/d,e.vy+=h*t.value*n/d),!0;if(!(t.length||d>=o)){(t.data!==e||t.next)&&(0===c&&(d+=(c=lu())*c),0===h&&(d+=(h=lu())*h),d<a&&(d=Math.sqrt(a*d)));do{t.data!==e&&(f=r[t.data.index]*n/d,e.vx+=c*f,e.vy+=h*f)}while(t=t.next)}}return u.initialize=function(e){t=e,l()},u.strength=function(t){return arguments.length?(i="function"==typeof t?t:uu(+t),l(),u):i},u.distanceMin=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.distanceMax=function(t){return arguments.length?(o=t*t,u):Math.sqrt(o)},u.theta=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u},Tu=function(t,e,n){var r,i,a,o=uu(.1);function s(t){for(var o=0,s=r.length;o<s;++o){var u=r[o],l=u.x-e||1e-6,c=u.y-n||1e-6,h=Math.sqrt(l*l+c*c),f=(a[o]-h)*i[o]*t/h;u.vx+=l*f,u.vy+=c*f}}function u(){if(r){var e,n=r.length;for(i=new Array(n),a=new Array(n),e=0;e<n;++e)a[e]=+t(r[e],e,r),i[e]=isNaN(a[e])?0:+o(r[e],e,r)}}return"function"!=typeof t&&(t=uu(+t)),null==e&&(e=0),null==n&&(n=0),s.initialize=function(t){r=t,u()},s.strength=function(t){return arguments.length?(o="function"==typeof t?t:uu(+t),u(),s):o},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:uu(+e),u(),s):t},s.x=function(t){return arguments.length?(e=+t,s):e},s.y=function(t){return arguments.length?(n=+t,s):n},s},Au=function(t){var e,n,r,i=uu(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vx+=(r[a]-i.x)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=uu(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:uu(+t),o(),a):i},a.x=function(e){return arguments.length?(t="function"==typeof e?e:uu(+e),o(),a):t},a},Cu=function(t){var e,n,r,i=uu(.1);function a(t){for(var i,a=0,o=e.length;a<o;++a)(i=e[a]).vy+=(r[a]-i.y)*n[a]*t}function o(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=uu(null==t?0:+t)),a.initialize=function(t){e=t,o()},a.strength=function(t){return arguments.length?(i="function"==typeof t?t:uu(+t),o(),a):i},a.y=function(e){return arguments.length?(t="function"==typeof e?e:uu(+e),o(),a):t},a};function Pu(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}var Ru=function(t){return(t=Pu(Math.abs(t)))?t[1]:NaN},Ou=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Lu(t){if(!(e=Ou.exec(t)))throw new Error("invalid format: "+t);var e;return new Du({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function Du(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}Lu.prototype=Du.prototype,Du.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var ju,$u,Iu,Bu,Uu=function(t,e){var n=Pu(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")},qu={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return Uu(100*t,e)},r:Uu,s:function(t,e){var n=Pu(t,e);if(!n)return t+"";var r=n[0],i=n[1],a=i-(ju=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=r.length;return a===o?r:a>o?r+new Array(a-o+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Pu(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}},Fu=function(t){return t},Yu=Array.prototype.map,Hu=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"],Gu=function(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?Fu:(e=Yu.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,a=[],o=0,s=e[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),a.push(t.substring(i-=s,i+s)),!((u+=s+1)>r));)s=e[o=(o+1)%e.length];return a.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",o=void 0===t.decimal?".":t.decimal+"",s=void 0===t.numerals?Fu:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(Yu.call(t.numerals,String)),u=void 0===t.percent?"%":t.percent+"",l=void 0===t.minus?"-":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=Lu(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,_=t.comma,g=t.precision,y=t.trim,m=t.type;"n"===m?(_=!0,m="g"):qu[m]||(void 0===g&&(g=12),y=!0,m="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var b="$"===f?i:"#"===f&&/[boxX]/.test(m)?"0"+m.toLowerCase():"",v="$"===f?a:/[%p]/.test(m)?u:"",x=qu[m],w=/[defgprs%]/.test(m);function M(t){var i,a,u,f=b,M=v;if("c"===m)M=x(t)+M,t="";else{var k=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:x(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),k&&0==+t&&"+"!==h&&(k=!1),f=(k?"("===h?h:l:"-"===h||"("===h?"":h)+f,M=("s"===m?Hu[8+ju/3]:"")+M+(k&&"("===h?")":""),w)for(i=-1,a=t.length;++i<a;)if(48>(u=t.charCodeAt(i))||u>57){M=(46===u?o+t.slice(i+1):t.slice(i))+M,t=t.slice(0,i);break}}_&&!d&&(t=r(t,1/0));var E=f.length+t.length+M.length,S=E<p?new Array(p-E+1).join(e):"";switch(_&&d&&(t=r(S+t,S.length?p-M.length:1/0),S=""),n){case"<":t=f+t+M+S;break;case"=":t=f+S+t+M;break;case"^":t=S.slice(0,E=S.length>>1)+f+t+M+S.slice(E);break;default:t=S+f+t+M}return s(t)}return g=void 0===g?6:/[gprs]/.test(m)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),M.toString=function(){return t+""},M}return{format:h,formatPrefix:function(t,e){var n=h(((t=Lu(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(Ru(e)/3))),i=Math.pow(10,-r),a=Hu[8+r/3];return function(t){return n(i*t)+a}}}};function Vu(t){return $u=Gu(t),Iu=$u.format,Bu=$u.formatPrefix,$u}Vu({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});var Xu=function(t){return Math.max(0,-Ru(Math.abs(t)))},Zu=function(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Ru(e)/3)))-Ru(Math.abs(t)))},Wu=function(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Ru(e)-Ru(t))+1},Ju=function(){return new Ku};function Ku(){this.reset()}Ku.prototype={constructor:Ku,reset:function(){this.s=this.t=0},add:function(t){tl(Qu,t,this.t),tl(this,Qu.s,this.s),this.s?this.t+=Qu.t:this.s=Qu.t},valueOf:function(){return this.s}};var Qu=new Ku;function tl(t,e,n){var r=t.s=e+n,i=r-e,a=r-i;t.t=e-a+(n-i)}var el=Math.PI,nl=el/2,rl=el/4,il=2*el,al=180/el,ol=el/180,sl=Math.abs,ul=Math.atan,ll=Math.atan2,cl=Math.cos,hl=Math.ceil,fl=Math.exp,dl=(Math.floor,Math.log),pl=Math.pow,_l=Math.sin,gl=Math.sign||function(t){return t>0?1:t<0?-1:0},yl=Math.sqrt,ml=Math.tan;function bl(t){return t>1?0:t<-1?el:Math.acos(t)}function vl(t){return t>1?nl:t<-1?-nl:Math.asin(t)}function xl(t){return(t=_l(t/2))*t}function wl(){}function Ml(t,e){t&&El.hasOwnProperty(t.type)&&El[t.type](t,e)}var kl={Feature:function(t,e){Ml(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Ml(n[r].geometry,e)}},El={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Sl(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Sl(n[r],e,0)},Polygon:function(t,e){zl(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)zl(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Ml(n[r],e)}};function Sl(t,e,n){var r,i=-1,a=t.length-n;for(e.lineStart();++i<a;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function zl(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Sl(t[n],e,1);e.polygonEnd()}var Nl,Tl,Al,Cl,Pl,Rl=function(t,e){t&&kl.hasOwnProperty(t.type)?kl[t.type](t,e):Ml(t,e)},Ol=Ju(),Ll=Ju(),Dl={point:wl,lineStart:wl,lineEnd:wl,polygonStart:function(){Ol.reset(),Dl.lineStart=jl,Dl.lineEnd=$l},polygonEnd:function(){var t=+Ol;Ll.add(t<0?il+t:t),this.lineStart=this.lineEnd=this.point=wl},sphere:function(){Ll.add(il)}};function jl(){Dl.point=Il}function $l(){Bl(Nl,Tl)}function Il(t,e){Dl.point=Bl,Nl=t,Tl=e,Al=t*=ol,Cl=cl(e=(e*=ol)/2+rl),Pl=_l(e)}function Bl(t,e){var n=(t*=ol)-Al,r=n>=0?1:-1,i=r*n,a=cl(e=(e*=ol)/2+rl),o=_l(e),s=Pl*o,u=Cl*a+s*cl(i),l=s*r*_l(i);Ol.add(ll(l,u)),Al=t,Cl=a,Pl=o}var Ul=function(t){return Ll.reset(),Rl(t,Dl),2*Ll};function ql(t){return[ll(t[1],t[0]),vl(t[2])]}function Fl(t){var e=t[0],n=t[1],r=cl(n);return[r*cl(e),r*_l(e),_l(n)]}function Yl(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Hl(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Gl(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Vl(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Xl(t){var e=yl(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Zl,Wl,Jl,Kl,Ql,tc,ec,nc,rc,ic,ac=Ju(),oc={point:sc,lineStart:lc,lineEnd:cc,polygonStart:function(){oc.point=hc,oc.lineStart=fc,oc.lineEnd=dc,ac.reset(),Dl.polygonStart()},polygonEnd:function(){Dl.polygonEnd(),oc.point=sc,oc.lineStart=lc,oc.lineEnd=cc,Ol<0?(Zl=-(Jl=180),Wl=-(Kl=90)):ac>1e-6?Kl=90:ac<-1e-6&&(Wl=-90),ic[0]=Zl,ic[1]=Jl},sphere:function(){Zl=-(Jl=180),Wl=-(Kl=90)}};function sc(t,e){rc.push(ic=[Zl=t,Jl=t]),e<Wl&&(Wl=e),e>Kl&&(Kl=e)}function uc(t,e){var n=Fl([t*ol,e*ol]);if(nc){var r=Hl(nc,n),i=Hl([r[1],-r[0],0],r);Xl(i),i=ql(i);var a,o=t-Ql,s=o>0?1:-1,u=i[0]*al*s,l=sl(o)>180;l^(s*Ql<u&&u<s*t)?(a=i[1]*al)>Kl&&(Kl=a):l^(s*Ql<(u=(u+360)%360-180)&&u<s*t)?(a=-i[1]*al)<Wl&&(Wl=a):(e<Wl&&(Wl=e),e>Kl&&(Kl=e)),l?t<Ql?pc(Zl,t)>pc(Zl,Jl)&&(Jl=t):pc(t,Jl)>pc(Zl,Jl)&&(Zl=t):Jl>=Zl?(t<Zl&&(Zl=t),t>Jl&&(Jl=t)):t>Ql?pc(Zl,t)>pc(Zl,Jl)&&(Jl=t):pc(t,Jl)>pc(Zl,Jl)&&(Zl=t)}else rc.push(ic=[Zl=t,Jl=t]);e<Wl&&(Wl=e),e>Kl&&(Kl=e),nc=n,Ql=t}function lc(){oc.point=uc}function cc(){ic[0]=Zl,ic[1]=Jl,oc.point=sc,nc=null}function hc(t,e){if(nc){var n=t-Ql;ac.add(sl(n)>180?n+(n>0?360:-360):n)}else tc=t,ec=e;Dl.point(t,e),uc(t,e)}function fc(){Dl.lineStart()}function dc(){hc(tc,ec),Dl.lineEnd(),sl(ac)>1e-6&&(Zl=-(Jl=180)),ic[0]=Zl,ic[1]=Jl,nc=null}function pc(t,e){return(e-=t)<0?e+360:e}function _c(t,e){return t[0]-e[0]}function gc(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var yc,mc,bc,vc,xc,wc,Mc,kc,Ec,Sc,zc,Nc,Tc,Ac,Cc,Pc,Rc=function(t){var e,n,r,i,a,o,s;if(Kl=Jl=-(Zl=Wl=1/0),rc=[],Rl(t,oc),n=rc.length){for(rc.sort(_c),e=1,a=[r=rc[0]];e<n;++e)gc(r,(i=rc[e])[0])||gc(r,i[1])?(pc(r[0],i[1])>pc(r[0],r[1])&&(r[1]=i[1]),pc(i[0],r[1])>pc(r[0],r[1])&&(r[0]=i[0])):a.push(r=i);for(o=-1/0,e=0,r=a[n=a.length-1];e<=n;r=i,++e)i=a[e],(s=pc(r[1],i[0]))>o&&(o=s,Zl=i[0],Jl=r[1])}return rc=ic=null,Zl===1/0||Wl===1/0?[[NaN,NaN],[NaN,NaN]]:[[Zl,Wl],[Jl,Kl]]},Oc={sphere:wl,point:Lc,lineStart:jc,lineEnd:Bc,polygonStart:function(){Oc.lineStart=Uc,Oc.lineEnd=qc},polygonEnd:function(){Oc.lineStart=jc,Oc.lineEnd=Bc}};function Lc(t,e){t*=ol;var n=cl(e*=ol);Dc(n*cl(t),n*_l(t),_l(e))}function Dc(t,e,n){++yc,bc+=(t-bc)/yc,vc+=(e-vc)/yc,xc+=(n-xc)/yc}function jc(){Oc.point=$c}function $c(t,e){t*=ol;var n=cl(e*=ol);Ac=n*cl(t),Cc=n*_l(t),Pc=_l(e),Oc.point=Ic,Dc(Ac,Cc,Pc)}function Ic(t,e){t*=ol;var n=cl(e*=ol),r=n*cl(t),i=n*_l(t),a=_l(e),o=ll(yl((o=Cc*a-Pc*i)*o+(o=Pc*r-Ac*a)*o+(o=Ac*i-Cc*r)*o),Ac*r+Cc*i+Pc*a);mc+=o,wc+=o*(Ac+(Ac=r)),Mc+=o*(Cc+(Cc=i)),kc+=o*(Pc+(Pc=a)),Dc(Ac,Cc,Pc)}function Bc(){Oc.point=Lc}function Uc(){Oc.point=Fc}function qc(){Yc(Nc,Tc),Oc.point=Lc}function Fc(t,e){Nc=t,Tc=e,t*=ol,e*=ol,Oc.point=Yc;var n=cl(e);Ac=n*cl(t),Cc=n*_l(t),Pc=_l(e),Dc(Ac,Cc,Pc)}function Yc(t,e){t*=ol;var n=cl(e*=ol),r=n*cl(t),i=n*_l(t),a=_l(e),o=Cc*a-Pc*i,s=Pc*r-Ac*a,u=Ac*i-Cc*r,l=yl(o*o+s*s+u*u),c=vl(l),h=l&&-c/l;Ec+=h*o,Sc+=h*s,zc+=h*u,mc+=c,wc+=c*(Ac+(Ac=r)),Mc+=c*(Cc+(Cc=i)),kc+=c*(Pc+(Pc=a)),Dc(Ac,Cc,Pc)}var Hc=function(t){yc=mc=bc=vc=xc=wc=Mc=kc=Ec=Sc=zc=0,Rl(t,Oc);var e=Ec,n=Sc,r=zc,i=e*e+n*n+r*r;return i<1e-12&&(e=wc,n=Mc,r=kc,mc<1e-6&&(e=bc,n=vc,r=xc),(i=e*e+n*n+r*r)<1e-12)?[NaN,NaN]:[ll(n,e)*al,vl(r/yl(i))*al]},Gc=function(t){return function(){return t}},Vc=function(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n};function Xc(t,e){return[sl(t)>el?t+Math.round(-t/il)*il:t,e]}function Zc(t,e,n){return(t%=il)?e||n?Vc(Jc(t),Kc(e,n)):Jc(t):e||n?Kc(e,n):Xc}function Wc(t){return function(e,n){return[(e+=t)>el?e-il:e<-el?e+il:e,n]}}function Jc(t){var e=Wc(t);return e.invert=Wc(-t),e}function Kc(t,e){var n=cl(t),r=_l(t),i=cl(e),a=_l(e);function o(t,e){var o=cl(e),s=cl(t)*o,u=_l(t)*o,l=_l(e),c=l*n+s*r;return[ll(u*i-c*a,s*n-l*r),vl(c*i+u*a)]}return o.invert=function(t,e){var o=cl(e),s=cl(t)*o,u=_l(t)*o,l=_l(e),c=l*i-u*a;return[ll(u*i+l*a,s*n+c*r),vl(c*n-s*r)]},o}Xc.invert=Xc;var Qc=function(t){function e(e){return(e=t(e[0]*ol,e[1]*ol))[0]*=al,e[1]*=al,e}return t=Zc(t[0]*ol,t[1]*ol,t.length>2?t[2]*ol:0),e.invert=function(e){return(e=t.invert(e[0]*ol,e[1]*ol))[0]*=al,e[1]*=al,e},e};function th(t,e,n,r,i,a){if(n){var o=cl(e),s=_l(e),u=r*n;null==i?(i=e+r*il,a=e-u/2):(i=eh(o,i),a=eh(o,a),(r>0?i<a:i>a)&&(i+=r*il));for(var l,c=i;r>0?c>a:c<a;c-=u)l=ql([o,-s*cl(c),-s*_l(c)]),t.point(l[0],l[1])}}function eh(t,e){(e=Fl(e))[0]-=t,Xl(e);var n=bl(-e[1]);return((-e[2]<0?-n:n)+il-1e-6)%il}var nh=function(){var t,e,n=Gc([0,0]),r=Gc(90),i=Gc(6),a={point:function(n,r){t.push(n=e(n,r)),n[0]*=al,n[1]*=al}};function o(){var o=n.apply(this,arguments),s=r.apply(this,arguments)*ol,u=i.apply(this,arguments)*ol;return t=[],e=Zc(-o[0]*ol,-o[1]*ol,0).invert,th(a,s,u,1),o={type:"Polygon",coordinates:[t]},t=e=null,o}return o.center=function(t){return arguments.length?(n="function"==typeof t?t:Gc([+t[0],+t[1]]),o):n},o.radius=function(t){return arguments.length?(r="function"==typeof t?t:Gc(+t),o):r},o.precision=function(t){return arguments.length?(i="function"==typeof t?t:Gc(+t),o):i},o},rh=function(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:wl,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}},ih=function(t,e){return sl(t[0]-e[0])<1e-6&&sl(t[1]-e[1])<1e-6};function ah(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}var oh=function(t,e,n,r,i){var a,o,s=[],u=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],o=t[e];if(ih(r,o)){if(!r[2]&&!o[2]){for(i.lineStart(),a=0;a<e;++a)i.point((r=t[a])[0],r[1]);return void i.lineEnd()}o[0]+=2e-6}s.push(n=new ah(r,t,null,!0)),u.push(n.o=new ah(r,null,n,!1)),s.push(n=new ah(o,t,null,!1)),u.push(n.o=new ah(o,null,n,!0))}})),s.length){for(u.sort(e),sh(s),sh(u),a=0,o=u.length;a<o;++a)u[a].e=n=!n;for(var l,c,h=s[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;l=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(a=0,o=l.length;a<o;++a)i.point((c=l[a])[0],c[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(l=f.p.z,a=l.length-1;a>=0;--a)i.point((c=l[a])[0],c[1]);else r(f.x,f.p.x,-1,i);f=f.p}l=(f=f.o).z,d=!d}while(!f.v);i.lineEnd()}}};function sh(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}var uh=Ju();function lh(t){return sl(t[0])<=el?t[0]:gl(t[0])*((sl(t[0])+el)%il-el)}var ch=function(t,e){var n=lh(e),r=e[1],i=_l(r),a=[_l(n),-cl(n),0],o=0,s=0;uh.reset(),1===i?r=nl+1e-6:-1===i&&(r=-nl-1e-6);for(var u=0,l=t.length;u<l;++u)if(h=(c=t[u]).length)for(var c,h,f=c[h-1],d=lh(f),p=f[1]/2+rl,_=_l(p),g=cl(p),y=0;y<h;++y,d=b,_=x,g=w,f=m){var m=c[y],b=lh(m),v=m[1]/2+rl,x=_l(v),w=cl(v),M=b-d,k=M>=0?1:-1,E=k*M,S=E>el,z=_*x;if(uh.add(ll(z*k*_l(E),g*w+z*cl(E))),o+=S?M+k*il:M,S^d>=n^b>=n){var N=Hl(Fl(f),Fl(m));Xl(N);var T=Hl(a,N);Xl(T);var A=(S^M>=0?-1:1)*vl(T[2]);(r>A||r===A&&(N[0]||N[1]))&&(s+=S^M>=0?1:-1)}}return(o<-1e-6||o<1e-6&&uh<-1e-6)^1&s},hh=function(t,e,n,r){return function(i){var a,o,s,u=e(i),l=rh(),c=e(l),h=!1,f={point:d,lineStart:_,lineEnd:g,polygonStart:function(){f.point=y,f.lineStart=m,f.lineEnd=b,o=[],a=[]},polygonEnd:function(){f.point=d,f.lineStart=_,f.lineEnd=g,o=St(o);var t=ch(a,r);o.length?(h||(i.polygonStart(),h=!0),oh(o,dh,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),o=a=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(e,n){t(e,n)&&i.point(e,n)}function p(t,e){u.point(t,e)}function _(){f.point=p,u.lineStart()}function g(){f.point=d,u.lineEnd()}function y(t,e){s.push([t,e]),c.point(t,e)}function m(){c.lineStart(),s=[]}function b(){y(s[0][0],s[0][1]),c.lineEnd();var t,e,n,r,u=c.clean(),f=l.result(),d=f.length;if(s.pop(),a.push(s),s=null,d)if(1&u){if((e=(n=f[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else d>1&&2&u&&f.push(f.pop().concat(f.shift())),o.push(f.filter(fh))}return f}};function fh(t){return t.length>1}function dh(t,e){return((t=t.x)[0]<0?t[1]-nl-1e-6:nl-t[1])-((e=e.x)[0]<0?e[1]-nl-1e-6:nl-e[1])}var ph=hh((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(a,o){var s=a>0?el:-el,u=sl(a-n);sl(u-el)<1e-6?(t.point(n,r=(r+o)/2>0?nl:-nl),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),t.point(a,r),e=0):i!==s&&u>=el&&(sl(n-i)<1e-6&&(n-=1e-6*i),sl(a-s)<1e-6&&(a-=1e-6*s),r=function(t,e,n,r){var i,a,o=_l(t-n);return sl(o)>1e-6?ul((_l(e)*(a=cl(r))*_l(n)-_l(r)*(i=cl(e))*_l(t))/(i*a*o)):(e+r)/2}(n,r,a,o),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(s,r),e=0),t.point(n=a,r=o),i=s},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*nl,r.point(-el,i),r.point(0,i),r.point(el,i),r.point(el,0),r.point(el,-i),r.point(0,-i),r.point(-el,-i),r.point(-el,0),r.point(-el,i);else if(sl(t[0]-e[0])>1e-6){var a=t[0]<e[0]?el:-el;i=n*a/2,r.point(-a,i),r.point(0,i),r.point(a,i)}else r.point(e[0],e[1])}),[-el,-nl]);var _h=function(t){var e=cl(t),n=6*ol,r=e>0,i=sl(e)>1e-6;function a(t,n){return cl(t)*cl(n)>e}function o(t,n,r){var i=[1,0,0],a=Hl(Fl(t),Fl(n)),o=Yl(a,a),s=a[0],u=o-s*s;if(!u)return!r&&t;var l=e*o/u,c=-e*s/u,h=Hl(i,a),f=Vl(i,l);Gl(f,Vl(a,c));var d=h,p=Yl(f,d),_=Yl(d,d),g=p*p-_*(Yl(f,f)-1);if(!(g<0)){var y=yl(g),m=Vl(d,(-p-y)/_);if(Gl(m,f),m=ql(m),!r)return m;var b,v=t[0],x=n[0],w=t[1],M=n[1];x<v&&(b=v,v=x,x=b);var k=x-v,E=sl(k-el)<1e-6;if(!E&&M<w&&(b=w,w=M,M=b),E||k<1e-6?E?w+M>0^m[1]<(sl(m[0]-v)<1e-6?w:M):w<=m[1]&&m[1]<=M:k>el^(v<=m[0]&&m[0]<=x)){var S=Vl(d,(-p+y)/_);return Gl(S,f),[m,ql(S)]}}}function s(e,n){var i=r?t:el-t,a=0;return e<-i?a|=1:e>i&&(a|=2),n<-i?a|=4:n>i&&(a|=8),a}return hh(a,(function(t){var e,n,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(h,f){var d,p=[h,f],_=a(h,f),g=r?_?0:s(h,f):_?s(h+(h<0?el:-el),f):0;if(!e&&(l=u=_)&&t.lineStart(),_!==u&&(!(d=o(e,p))||ih(e,d)||ih(p,d))&&(p[2]=1),_!==u)c=0,_?(t.lineStart(),d=o(p,e),t.point(d[0],d[1])):(d=o(e,p),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(i&&e&&r^_){var y;g&n||!(y=o(p,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!_||e&&ih(e,p)||t.point(p[0],p[1]),e=p,u=_,n=g},lineEnd:function(){u&&t.lineEnd(),e=null},clean:function(){return c|(l&&u)<<1}}}),(function(e,r,i,a){th(a,t,n,i,e,r)}),r?[0,-t]:[-el,t-el])};function gh(t,e,n,r){function i(i,a){return t<=i&&i<=n&&e<=a&&a<=r}function a(i,a,s,l){var c=0,h=0;if(null==i||(c=o(i,s))!==(h=o(a,s))||u(i,a)<0^s>0)do{l.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+s+4)%4)!==h);else l.point(a[0],a[1])}function o(r,i){return sl(r[0]-t)<1e-6?i>0?0:3:sl(r[0]-n)<1e-6?i>0?2:1:sl(r[1]-e)<1e-6?i>0?1:0:i>0?3:2}function s(t,e){return u(t.x,e.x)}function u(t,e){var n=o(t,1),r=o(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){var u,l,c,h,f,d,p,_,g,y,m,b=o,v=rh(),x={point:w,lineStart:function(){x.point=M,l&&l.push(c=[]);y=!0,g=!1,p=_=NaN},lineEnd:function(){u&&(M(h,f),d&&g&&v.rejoin(),u.push(v.result()));x.point=w,g&&b.lineEnd()},polygonStart:function(){b=v,u=[],l=[],m=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=l.length;n<i;++n)for(var a,o,s=l[n],u=1,c=s.length,h=s[0],f=h[0],d=h[1];u<c;++u)a=f,o=d,h=s[u],f=h[0],d=h[1],o<=r?d>r&&(f-a)*(r-o)>(d-o)*(t-a)&&++e:d<=r&&(f-a)*(r-o)<(d-o)*(t-a)&&--e;return e}(),n=m&&e,i=(u=St(u)).length;(n||i)&&(o.polygonStart(),n&&(o.lineStart(),a(null,null,1,o),o.lineEnd()),i&&oh(u,s,e,a,o),o.polygonEnd());b=o,u=l=c=null}};function w(t,e){i(t,e)&&b.point(t,e)}function M(a,o){var s=i(a,o);if(l&&c.push([a,o]),y)h=a,f=o,d=s,y=!1,s&&(b.lineStart(),b.point(a,o));else if(s&&g)b.point(a,o);else{var u=[p=Math.max(-1e9,Math.min(1e9,p)),_=Math.max(-1e9,Math.min(1e9,_))],v=[a=Math.max(-1e9,Math.min(1e9,a)),o=Math.max(-1e9,Math.min(1e9,o))];!function(t,e,n,r,i,a){var o,s=t[0],u=t[1],l=0,c=1,h=e[0]-s,f=e[1]-u;if(o=n-s,h||!(o>0)){if(o/=h,h<0){if(o<l)return;o<c&&(c=o)}else if(h>0){if(o>c)return;o>l&&(l=o)}if(o=i-s,h||!(o<0)){if(o/=h,h<0){if(o>c)return;o>l&&(l=o)}else if(h>0){if(o<l)return;o<c&&(c=o)}if(o=r-u,f||!(o>0)){if(o/=f,f<0){if(o<l)return;o<c&&(c=o)}else if(f>0){if(o>c)return;o>l&&(l=o)}if(o=a-u,f||!(o<0)){if(o/=f,f<0){if(o>c)return;o>l&&(l=o)}else if(f>0){if(o<l)return;o<c&&(c=o)}return l>0&&(t[0]=s+l*h,t[1]=u+l*f),c<1&&(e[0]=s+c*h,e[1]=u+c*f),!0}}}}}(u,v,t,e,n,r)?s&&(b.lineStart(),b.point(a,o),m=!1):(g||(b.lineStart(),b.point(u[0],u[1])),b.point(v[0],v[1]),s||b.lineEnd(),m=!1)}p=a,_=o,g=s}return x}}var yh,mh,bh,vh=function(){var t,e,n,r=0,i=0,a=960,o=500;return n={stream:function(n){return t&&e===n?t:t=gh(r,i,a,o)(e=n)},extent:function(s){return arguments.length?(r=+s[0][0],i=+s[0][1],a=+s[1][0],o=+s[1][1],t=e=null,n):[[r,i],[a,o]]}}},xh=Ju(),wh={sphere:wl,point:wl,lineStart:function(){wh.point=kh,wh.lineEnd=Mh},lineEnd:wl,polygonStart:wl,polygonEnd:wl};function Mh(){wh.point=wh.lineEnd=wl}function kh(t,e){yh=t*=ol,mh=_l(e*=ol),bh=cl(e),wh.point=Eh}function Eh(t,e){t*=ol;var n=_l(e*=ol),r=cl(e),i=sl(t-yh),a=cl(i),o=r*_l(i),s=bh*n-mh*r*a,u=mh*n+bh*r*a;xh.add(ll(yl(o*o+s*s),u)),yh=t,mh=n,bh=r}var Sh=function(t){return xh.reset(),Rl(t,wh),+xh},zh=[null,null],Nh={type:"LineString",coordinates:zh},Th=function(t,e){return zh[0]=t,zh[1]=e,Sh(Nh)},Ah={Feature:function(t,e){return Ph(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(Ph(n[r].geometry,e))return!0;return!1}},Ch={Sphere:function(){return!0},Point:function(t,e){return Rh(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Rh(n[r],e))return!0;return!1},LineString:function(t,e){return Oh(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Oh(n[r],e))return!0;return!1},Polygon:function(t,e){return Lh(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(Lh(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(Ph(n[r],e))return!0;return!1}};function Ph(t,e){return!(!t||!Ch.hasOwnProperty(t.type))&&Ch[t.type](t,e)}function Rh(t,e){return 0===Th(t,e)}function Oh(t,e){for(var n,r,i,a=0,o=t.length;a<o;a++){if(0===(r=Th(t[a],e)))return!0;if(a>0&&(i=Th(t[a],t[a-1]))>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<1e-12*i)return!0;n=r}return!1}function Lh(t,e){return!!ch(t.map(Dh),jh(e))}function Dh(t){return(t=t.map(jh)).pop(),t}function jh(t){return[t[0]*ol,t[1]*ol]}var $h=function(t,e){return(t&&Ah.hasOwnProperty(t.type)?Ah[t.type]:Ph)(t,e)};function Ih(t,e,n){var r=ht(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function Bh(t,e,n){var r=ht(t,e-1e-6,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function Uh(){var t,e,n,r,i,a,o,s,u,l,c,h,f=10,d=f,p=90,_=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:m()}}function m(){return ht(hl(r/p)*p,n,p).map(c).concat(ht(hl(s/_)*_,o,_).map(h)).concat(ht(hl(e/f)*f,t,f).filter((function(t){return sl(t%p)>1e-6})).map(u)).concat(ht(hl(a/d)*d,i,d).filter((function(t){return sl(t%_)>1e-6})).map(l))}return y.lines=function(){return m().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(h(o).slice(1),c(n).reverse().slice(1),h(s).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],s=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),s>o&&(t=s,s=o,o=t),y.precision(g)):[[r,s],[n,o]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],a=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),a>i&&(n=a,a=i,i=n),y.precision(g)):[[e,a],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],_=+t[1],y):[p,_]},y.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],y):[f,d]},y.precision=function(f){return arguments.length?(g=+f,u=Ih(a,i,90),l=Bh(e,t,g),c=Ih(s,o,90),h=Bh(r,n,g),y):g},y.extentMajor([[-180,-89.999999],[180,89.999999]]).extentMinor([[-180,-80.000001],[180,80.000001]])}function qh(){return Uh()()}var Fh,Yh,Hh,Gh,Vh=function(t,e){var n=t[0]*ol,r=t[1]*ol,i=e[0]*ol,a=e[1]*ol,o=cl(r),s=_l(r),u=cl(a),l=_l(a),c=o*cl(n),h=o*_l(n),f=u*cl(i),d=u*_l(i),p=2*vl(yl(xl(a-r)+o*u*xl(i-n))),_=_l(p),g=p?function(t){var e=_l(t*=p)/_,n=_l(p-t)/_,r=n*c+e*f,i=n*h+e*d,a=n*s+e*l;return[ll(i,r)*al,ll(a,yl(r*r+i*i))*al]}:function(){return[n*al,r*al]};return g.distance=p,g},Xh=function(t){return t},Zh=Ju(),Wh=Ju(),Jh={point:wl,lineStart:wl,lineEnd:wl,polygonStart:function(){Jh.lineStart=Kh,Jh.lineEnd=ef},polygonEnd:function(){Jh.lineStart=Jh.lineEnd=Jh.point=wl,Zh.add(sl(Wh)),Wh.reset()},result:function(){var t=Zh/2;return Zh.reset(),t}};function Kh(){Jh.point=Qh}function Qh(t,e){Jh.point=tf,Fh=Hh=t,Yh=Gh=e}function tf(t,e){Wh.add(Gh*t-Hh*e),Hh=t,Gh=e}function ef(){tf(Fh,Yh)}var nf=Jh,rf=1/0,af=rf,of=-rf,sf=of;var uf,lf,cf,hf,ff={point:function(t,e){t<rf&&(rf=t);t>of&&(of=t);e<af&&(af=e);e>sf&&(sf=e)},lineStart:wl,lineEnd:wl,polygonStart:wl,polygonEnd:wl,result:function(){var t=[[rf,af],[of,sf]];return of=sf=-(af=rf=1/0),t}},df=0,pf=0,_f=0,gf=0,yf=0,mf=0,bf=0,vf=0,xf=0,wf={point:Mf,lineStart:kf,lineEnd:zf,polygonStart:function(){wf.lineStart=Nf,wf.lineEnd=Tf},polygonEnd:function(){wf.point=Mf,wf.lineStart=kf,wf.lineEnd=zf},result:function(){var t=xf?[bf/xf,vf/xf]:mf?[gf/mf,yf/mf]:_f?[df/_f,pf/_f]:[NaN,NaN];return df=pf=_f=gf=yf=mf=bf=vf=xf=0,t}};function Mf(t,e){df+=t,pf+=e,++_f}function kf(){wf.point=Ef}function Ef(t,e){wf.point=Sf,Mf(cf=t,hf=e)}function Sf(t,e){var n=t-cf,r=e-hf,i=yl(n*n+r*r);gf+=i*(cf+t)/2,yf+=i*(hf+e)/2,mf+=i,Mf(cf=t,hf=e)}function zf(){wf.point=Mf}function Nf(){wf.point=Af}function Tf(){Cf(uf,lf)}function Af(t,e){wf.point=Cf,Mf(uf=cf=t,lf=hf=e)}function Cf(t,e){var n=t-cf,r=e-hf,i=yl(n*n+r*r);gf+=i*(cf+t)/2,yf+=i*(hf+e)/2,mf+=i,bf+=(i=hf*t-cf*e)*(cf+t),vf+=i*(hf+e),xf+=3*i,Mf(cf=t,hf=e)}var Pf=wf;function Rf(t){this._context=t}Rf.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,il)}},result:wl};var Of,Lf,Df,jf,$f,If=Ju(),Bf={point:wl,lineStart:function(){Bf.point=Uf},lineEnd:function(){Of&&qf(Lf,Df),Bf.point=wl},polygonStart:function(){Of=!0},polygonEnd:function(){Of=null},result:function(){var t=+If;return If.reset(),t}};function Uf(t,e){Bf.point=qf,Lf=jf=t,Df=$f=e}function qf(t,e){jf-=t,$f-=e,If.add(yl(jf*jf+$f*$f)),jf=t,$f=e}var Ff=Bf;function Yf(){this._string=[]}function Hf(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}Yf.prototype={_radius:4.5,_circle:Hf(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._string.push("M",t,",",e),this._point=1;break;case 1:this._string.push("L",t,",",e);break;default:null==this._circle&&(this._circle=Hf(this._radius)),this._string.push("M",t,",",e,this._circle)}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}return null}};var Gf=function(t,e){var n,r,i=4.5;function a(t){return t&&("function"==typeof i&&r.pointRadius(+i.apply(this,arguments)),Rl(t,n(r))),r.result()}return a.area=function(t){return Rl(t,n(nf)),nf.result()},a.measure=function(t){return Rl(t,n(Ff)),Ff.result()},a.bounds=function(t){return Rl(t,n(ff)),ff.result()},a.centroid=function(t){return Rl(t,n(Pf)),Pf.result()},a.projection=function(e){return arguments.length?(n=null==e?(t=null,Xh):(t=e).stream,a):t},a.context=function(t){return arguments.length?(r=null==t?(e=null,new Yf):new Rf(e=t),"function"!=typeof i&&r.pointRadius(i),a):e},a.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(r.pointRadius(+t),+t),a):i},a.projection(t).context(e)},Vf=function(t){return{stream:Xf(t)}};function Xf(t){return function(e){var n=new Zf;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Zf(){}function Wf(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),Rl(n,t.stream(ff)),e(ff.result()),null!=r&&t.clipExtent(r),t}function Jf(t,e,n){return Wf(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],a=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),o=+e[0][0]+(r-a*(n[1][0]+n[0][0]))/2,s=+e[0][1]+(i-a*(n[1][1]+n[0][1]))/2;t.scale(150*a).translate([o,s])}),n)}function Kf(t,e,n){return Jf(t,[[0,0],e],n)}function Qf(t,e,n){return Wf(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),a=(r-i*(n[1][0]+n[0][0]))/2,o=-i*n[0][1];t.scale(150*i).translate([a,o])}),n)}function td(t,e,n){return Wf(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),a=-i*n[0][0],o=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([a,o])}),n)}Zf.prototype={constructor:Zf,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var ed=cl(30*ol),nd=function(t,e){return+e?function(t,e){function n(r,i,a,o,s,u,l,c,h,f,d,p,_,g){var y=l-r,m=c-i,b=y*y+m*m;if(b>4*e&&_--){var v=o+f,x=s+d,w=u+p,M=yl(v*v+x*x+w*w),k=vl(w/=M),E=sl(sl(w)-1)<1e-6||sl(a-h)<1e-6?(a+h)/2:ll(x,v),S=t(E,k),z=S[0],N=S[1],T=z-r,A=N-i,C=m*T-y*A;(C*C/b>e||sl((y*T+m*A)/b-.5)>.3||o*f+s*d+u*p<ed)&&(n(r,i,a,o,s,u,z,N,E,v/=M,x/=M,w,_,g),g.point(z,N),n(z,N,E,v,x,w,l,c,h,f,d,p,_,g))}}return function(e){var r,i,a,o,s,u,l,c,h,f,d,p,_={point:g,lineStart:y,lineEnd:b,polygonStart:function(){e.polygonStart(),_.lineStart=v},polygonEnd:function(){e.polygonEnd(),_.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,_.point=m,e.lineStart()}function m(r,i){var a=Fl([r,i]),o=t(r,i);n(c,h,l,f,d,p,c=o[0],h=o[1],l=r,f=a[0],d=a[1],p=a[2],16,e),e.point(c,h)}function b(){_.point=g,e.lineEnd()}function v(){y(),_.point=x,_.lineEnd=w}function x(t,e){m(r=t,e),i=c,a=h,o=f,s=d,u=p,_.point=m}function w(){n(c,h,l,f,d,p,i,a,r,o,s,u,16,e),_.lineEnd=b,b()}return _}}(t,e):function(t){return Xf({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)};var rd=Xf({point:function(t,e){this.stream.point(t*ol,e*ol)}});function id(t,e,n,r,i){function a(a,o){return[e+t*(a*=r),n-t*(o*=i)]}return a.invert=function(a,o){return[(a-e)/t*r,(n-o)/t*i]},a}function ad(t,e,n,r,i,a){var o=cl(a),s=_l(a),u=o*t,l=s*t,c=o/t,h=s/t,f=(s*n-o*e)/t,d=(s*e+o*n)/t;function p(t,a){return[u*(t*=r)-l*(a*=i)+e,n-l*t-u*a]}return p.invert=function(t,e){return[r*(c*t-h*e+f),i*(d-h*t-c*e)]},p}function od(t){return sd((function(){return t}))()}function sd(t){var e,n,r,i,a,o,s,u,l,c,h=150,f=480,d=250,p=0,_=0,g=0,y=0,m=0,b=0,v=1,x=1,w=null,M=ph,k=null,E=Xh,S=.5;function z(t){return u(t[0]*ol,t[1]*ol)}function N(t){return(t=u.invert(t[0],t[1]))&&[t[0]*al,t[1]*al]}function T(){var t=ad(h,0,0,v,x,b).apply(null,e(p,_)),r=(b?ad:id)(h,f-t[0],d-t[1],v,x,b);return n=Zc(g,y,m),s=Vc(e,r),u=Vc(n,s),o=nd(s,S),A()}function A(){return l=c=null,z}return z.stream=function(t){return l&&c===t?l:l=rd(function(t){return Xf({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(M(o(E(c=t)))))},z.preclip=function(t){return arguments.length?(M=t,w=void 0,A()):M},z.postclip=function(t){return arguments.length?(E=t,k=r=i=a=null,A()):E},z.clipAngle=function(t){return arguments.length?(M=+t?_h(w=t*ol):(w=null,ph),A()):w*al},z.clipExtent=function(t){return arguments.length?(E=null==t?(k=r=i=a=null,Xh):gh(k=+t[0][0],r=+t[0][1],i=+t[1][0],a=+t[1][1]),A()):null==k?null:[[k,r],[i,a]]},z.scale=function(t){return arguments.length?(h=+t,T()):h},z.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],T()):[f,d]},z.center=function(t){return arguments.length?(p=t[0]%360*ol,_=t[1]%360*ol,T()):[p*al,_*al]},z.rotate=function(t){return arguments.length?(g=t[0]%360*ol,y=t[1]%360*ol,m=t.length>2?t[2]%360*ol:0,T()):[g*al,y*al,m*al]},z.angle=function(t){return arguments.length?(b=t%360*ol,T()):b*al},z.reflectX=function(t){return arguments.length?(v=t?-1:1,T()):v<0},z.reflectY=function(t){return arguments.length?(x=t?-1:1,T()):x<0},z.precision=function(t){return arguments.length?(o=nd(s,S=t*t),A()):yl(S)},z.fitExtent=function(t,e){return Jf(z,t,e)},z.fitSize=function(t,e){return Kf(z,t,e)},z.fitWidth=function(t,e){return Qf(z,t,e)},z.fitHeight=function(t,e){return td(z,t,e)},function(){return e=t.apply(this,arguments),z.invert=e.invert&&N,T()}}function ud(t){var e=0,n=el/3,r=sd(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*ol,n=t[1]*ol):[e*al,n*al]},i}function ld(t,e){var n=_l(t),r=(n+_l(e))/2;if(sl(r)<1e-6)return function(t){var e=cl(t);function n(t,n){return[t*e,_l(n)/e]}return n.invert=function(t,n){return[t/e,vl(n*e)]},n}(t);var i=1+n*(2*r-n),a=yl(i)/r;function o(t,e){var n=yl(i-2*r*_l(e))/r;return[n*_l(t*=r),a-n*cl(t)]}return o.invert=function(t,e){var n=a-e,o=ll(t,sl(n))*gl(n);return n*r<0&&(o-=el*gl(t)*gl(n)),[o/r,vl((i-(t*t+n*n)*r*r)/(2*r))]},o}var cd=function(){return ud(ld).scale(155.424).center([0,33.6442])},hd=function(){return cd().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])};var fd=function(){var t,e,n,r,i,a,o=hd(),s=cd().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=cd().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,e){a=[t,e]}};function c(t){var e=t[0],o=t[1];return a=null,n.point(e,o),a||(r.point(e,o),a)||(i.point(e,o),a)}function h(){return t=e=null,c}return c.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?s:i>=.166&&i<.234&&r>=-.214&&r<-.115?u:o).invert(t)},c.stream=function(n){return t&&e===n?t:(r=[o.stream(e=n),s.stream(n),u.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},c.precision=function(t){return arguments.length?(o.precision(t),s.precision(t),u.precision(t),h()):o.precision()},c.scale=function(t){return arguments.length?(o.scale(t),s.scale(.35*t),u.scale(t),c.translate(o.translate())):o.scale()},c.translate=function(t){if(!arguments.length)return o.translate();var e=o.scale(),a=+t[0],c=+t[1];return n=o.translate(t).clipExtent([[a-.455*e,c-.238*e],[a+.455*e,c+.238*e]]).stream(l),r=s.translate([a-.307*e,c+.201*e]).clipExtent([[a-.425*e+1e-6,c+.12*e+1e-6],[a-.214*e-1e-6,c+.234*e-1e-6]]).stream(l),i=u.translate([a-.205*e,c+.212*e]).clipExtent([[a-.214*e+1e-6,c+.166*e+1e-6],[a-.115*e-1e-6,c+.234*e-1e-6]]).stream(l),h()},c.fitExtent=function(t,e){return Jf(c,t,e)},c.fitSize=function(t,e){return Kf(c,t,e)},c.fitWidth=function(t,e){return Qf(c,t,e)},c.fitHeight=function(t,e){return td(c,t,e)},c.scale(1070)};function dd(t){return function(e,n){var r=cl(e),i=cl(n),a=t(r*i);return[a*i*_l(e),a*_l(n)]}}function pd(t){return function(e,n){var r=yl(e*e+n*n),i=t(r),a=_l(i),o=cl(i);return[ll(e*a,r*o),vl(r&&n*a/r)]}}var _d=dd((function(t){return yl(2/(1+t))}));_d.invert=pd((function(t){return 2*vl(t/2)}));var gd=function(){return od(_d).scale(124.75).clipAngle(179.999)},yd=dd((function(t){return(t=bl(t))&&t/_l(t)}));yd.invert=pd((function(t){return t}));var md=function(){return od(yd).scale(79.4188).clipAngle(179.999)};function bd(t,e){return[t,dl(ml((nl+e)/2))]}bd.invert=function(t,e){return[t,2*ul(fl(e))-nl]};var vd=function(){return xd(bd).scale(961/il)};function xd(t){var e,n,r,i=od(t),a=i.center,o=i.scale,s=i.translate,u=i.clipExtent,l=null;function c(){var a=el*o(),s=i(Qc(i.rotate()).invert([0,0]));return u(null==l?[[s[0]-a,s[1]-a],[s[0]+a,s[1]+a]]:t===bd?[[Math.max(s[0]-a,l),e],[Math.min(s[0]+a,n),r]]:[[l,Math.max(s[1]-a,e)],[n,Math.min(s[1]+a,r)]])}return i.scale=function(t){return arguments.length?(o(t),c()):o()},i.translate=function(t){return arguments.length?(s(t),c()):s()},i.center=function(t){return arguments.length?(a(t),c()):a()},i.clipExtent=function(t){return arguments.length?(null==t?l=e=n=r=null:(l=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),c()):null==l?null:[[l,e],[n,r]]},c()}function wd(t){return ml((nl+t)/2)}function Md(t,e){var n=cl(t),r=t===e?_l(t):dl(n/cl(e))/dl(wd(e)/wd(t)),i=n*pl(wd(t),r)/r;if(!r)return bd;function a(t,e){i>0?e<1e-6-nl&&(e=1e-6-nl):e>nl-1e-6&&(e=nl-1e-6);var n=i/pl(wd(e),r);return[n*_l(r*t),i-n*cl(r*t)]}return a.invert=function(t,e){var n=i-e,a=gl(r)*yl(t*t+n*n),o=ll(t,sl(n))*gl(n);return n*r<0&&(o-=el*gl(t)*gl(n)),[o/r,2*ul(pl(i/a,1/r))-nl]},a}var kd=function(){return ud(Md).scale(109.5).parallels([30,30])};function Ed(t,e){return[t,e]}Ed.invert=Ed;var Sd=function(){return od(Ed).scale(152.63)};function zd(t,e){var n=cl(t),r=t===e?_l(t):(n-cl(e))/(e-t),i=n/r+t;if(sl(r)<1e-6)return Ed;function a(t,e){var n=i-e,a=r*t;return[n*_l(a),i-n*cl(a)]}return a.invert=function(t,e){var n=i-e,a=ll(t,sl(n))*gl(n);return n*r<0&&(a-=el*gl(t)*gl(n)),[a/r,i-gl(r)*yl(t*t+n*n)]},a}var Nd=function(){return ud(zd).scale(131.154).center([0,13.9389])},Td=1.340264,Ad=-.081106,Cd=893e-6,Pd=.003796,Rd=yl(3)/2;function Od(t,e){var n=vl(Rd*_l(e)),r=n*n,i=r*r*r;return[t*cl(n)/(Rd*(Td+3*Ad*r+i*(7*Cd+9*Pd*r))),n*(Td+Ad*r+i*(Cd+Pd*r))]}Od.invert=function(t,e){for(var n,r=e,i=r*r,a=i*i*i,o=0;o<12&&(a=(i=(r-=n=(r*(Td+Ad*i+a*(Cd+Pd*i))-e)/(Td+3*Ad*i+a*(7*Cd+9*Pd*i)))*r)*i*i,!(sl(n)<1e-12));++o);return[Rd*t*(Td+3*Ad*i+a*(7*Cd+9*Pd*i))/cl(r),vl(_l(r)/Rd)]};var Ld=function(){return od(Od).scale(177.158)};function Dd(t,e){var n=cl(e),r=cl(t)*n;return[n*_l(t)/r,_l(e)/r]}Dd.invert=pd(ul);var jd=function(){return od(Dd).scale(144.049).clipAngle(60)},$d=function(){var t,e,n,r,i,a,o,s=1,u=0,l=0,c=1,h=1,f=0,d=null,p=1,_=1,g=Xf({point:function(t,e){var n=b([t,e]);this.stream.point(n[0],n[1])}}),y=Xh;function m(){return p=s*c,_=s*h,a=o=null,b}function b(n){var r=n[0]*p,i=n[1]*_;if(f){var a=i*t-r*e;r=r*t+i*e,i=a}return[r+u,i+l]}return b.invert=function(n){var r=n[0]-u,i=n[1]-l;if(f){var a=i*t+r*e;r=r*t-i*e,i=a}return[r/p,i/_]},b.stream=function(t){return a&&o===t?a:a=g(y(o=t))},b.postclip=function(t){return arguments.length?(y=t,d=n=r=i=null,m()):y},b.clipExtent=function(t){return arguments.length?(y=null==t?(d=n=r=i=null,Xh):gh(d=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),m()):null==d?null:[[d,n],[r,i]]},b.scale=function(t){return arguments.length?(s=+t,m()):s},b.translate=function(t){return arguments.length?(u=+t[0],l=+t[1],m()):[u,l]},b.angle=function(n){return arguments.length?(e=_l(f=n%360*ol),t=cl(f),m()):f*al},b.reflectX=function(t){return arguments.length?(c=t?-1:1,m()):c<0},b.reflectY=function(t){return arguments.length?(h=t?-1:1,m()):h<0},b.fitExtent=function(t,e){return Jf(b,t,e)},b.fitSize=function(t,e){return Kf(b,t,e)},b.fitWidth=function(t,e){return Qf(b,t,e)},b.fitHeight=function(t,e){return td(b,t,e)},b};function Id(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}Id.invert=function(t,e){var n,r=e,i=25;do{var a=r*r,o=a*a;r-=n=(r*(1.007226+a*(.015085+o*(.028874*a-.044475-.005916*o)))-e)/(1.007226+a*(.045255+o*(.259866*a-.311325-.005916*11*o)))}while(sl(n)>1e-6&&--i>0);return[t/(.8707+(a=r*r)*(a*(a*a*a*(.003971-.001529*a)-.013791)-.131979)),r]};var Bd=function(){return od(Id).scale(175.295)};function Ud(t,e){return[cl(e)*_l(t),_l(e)]}Ud.invert=pd(vl);var qd=function(){return od(Ud).scale(249.5).clipAngle(90.000001)};function Fd(t,e){var n=cl(e),r=1+cl(t)*n;return[n*_l(t)/r,_l(e)/r]}Fd.invert=pd((function(t){return 2*ul(t)}));var Yd=function(){return od(Fd).scale(250).clipAngle(142)};function Hd(t,e){return[dl(ml((nl+e)/2)),-t]}Hd.invert=function(t,e){return[-e,2*ul(fl(t))-nl]};var Gd=function(){var t=xd(Hd),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)};function Vd(t,e){return t.parent===e.parent?1:2}function Xd(t,e){return t+e.x}function Zd(t,e){return Math.max(t,e.y)}var Wd=function(){var t=Vd,e=1,n=1,r=!1;function i(i){var a,o=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(Xd,0)/t.length}(n),e.y=function(t){return 1+t.reduce(Zd,0)}(n)):(e.x=a?o+=t(e,a):0,e.y=0,a=e)}));var s=function(t){for(var e;e=t.children;)t=e[0];return t}(i),u=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),l=s.x-t(s,u)/2,c=u.x+t(u,s)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-l)/(c-l)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i};function Jd(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function Kd(t,e){var n,r,i,a,o,s=new np(t),u=+t.value&&(s.value=t.value),l=[s];for(null==e&&(e=Qd);n=l.pop();)if(u&&(n.value=+n.data.value),(i=e(n.data))&&(o=i.length))for(n.children=new Array(o),a=o-1;a>=0;--a)l.push(r=n.children[a]=new np(i[a])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(ep)}function Qd(t){return t.children}function tp(t){t.data=t.data.data}function ep(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function np(t){this.data=t,this.depth=this.height=0,this.parent=null}np.prototype=Kd.prototype={constructor:np,count:function(){return this.eachAfter(Jd)},each:function(t){var e,n,r,i,a=this,o=[a];do{for(e=o.reverse(),o=[];a=e.pop();)if(t(a),n=a.children)for(r=0,i=n.length;r<i;++r)o.push(n[r])}while(o.length);return this},eachAfter:function(t){for(var e,n,r,i=this,a=[i],o=[];i=a.pop();)if(o.push(i),e=i.children)for(n=0,r=e.length;n<r;++n)a.push(e[n]);for(;i=o.pop();)t(i);return this},eachBefore:function(t){for(var e,n,r=this,i=[r];r=i.pop();)if(t(r),e=r.children)for(n=e.length-1;n>=0;--n)i.push(e[n]);return this},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;t=n.pop(),e=r.pop();for(;t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){var t=[];return this.each((function(e){t.push(e)})),t},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return Kd(this).eachBefore(tp)}};var rp=Array.prototype.slice;var ip=function(t){for(var e,n,r=0,i=(t=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t}(rp.call(t))).length,a=[];r<i;)e=t[r],n&&sp(n,e)?++r:(n=lp(a=ap(a,e)),r=0);return n};function ap(t,e){var n,r;if(up(e,t))return[e];for(n=0;n<t.length;++n)if(op(e,t[n])&&up(cp(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(op(cp(t[n],t[r]),e)&&op(cp(t[n],e),t[r])&&op(cp(t[r],e),t[n])&&up(hp(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function op(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function sp(t,e){var n=t.r-e.r+1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function up(t,e){for(var n=0;n<e.length;++n)if(!sp(t,e[n]))return!1;return!0}function lp(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return cp(t[0],t[1]);case 3:return hp(t[0],t[1],t[2])}var e}function cp(t,e){var n=t.x,r=t.y,i=t.r,a=e.x,o=e.y,s=e.r,u=a-n,l=o-r,c=s-i,h=Math.sqrt(u*u+l*l);return{x:(n+a+u/h*c)/2,y:(r+o+l/h*c)/2,r:(h+i+s)/2}}function hp(t,e,n){var r=t.x,i=t.y,a=t.r,o=e.x,s=e.y,u=e.r,l=n.x,c=n.y,h=n.r,f=r-o,d=r-l,p=i-s,_=i-c,g=u-a,y=h-a,m=r*r+i*i-a*a,b=m-o*o-s*s+u*u,v=m-l*l-c*c+h*h,x=d*p-f*_,w=(p*v-_*b)/(2*x)-r,M=(_*g-p*y)/x,k=(d*b-f*v)/(2*x)-i,E=(f*y-d*g)/x,S=M*M+E*E-1,z=2*(a+w*M+k*E),N=w*w+k*k-a*a,T=-(S?(z+Math.sqrt(z*z-4*S*N))/(2*S):N/z);return{x:r+w+M*T,y:i+k+E*T,r:T}}function fp(t,e,n){var r,i,a,o,s=t.x-e.x,u=t.y-e.y,l=s*s+u*u;l?(i=e.r+n.r,i*=i,o=t.r+n.r,i>(o*=o)?(r=(l+o-i)/(2*l),a=Math.sqrt(Math.max(0,o/l-r*r)),n.x=t.x-r*s-a*u,n.y=t.y-r*u+a*s):(r=(l+i-o)/(2*l),a=Math.sqrt(Math.max(0,i/l-r*r)),n.x=e.x+r*s-a*u,n.y=e.y+r*u+a*s)):(n.x=e.x+n.r,n.y=e.y)}function dp(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function pp(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,a=(e.y*n.r+n.y*e.r)/r;return i*i+a*a}function _p(t){this._=t,this.next=null,this.previous=null}function gp(t){if(!(i=t.length))return 0;var e,n,r,i,a,o,s,u,l,c,h;if((e=t[0]).x=0,e.y=0,!(i>1))return e.r;if(n=t[1],e.x=-n.r,n.x=e.r,n.y=0,!(i>2))return e.r+n.r;fp(n,e,r=t[2]),e=new _p(e),n=new _p(n),r=new _p(r),e.next=r.previous=n,n.next=e.previous=r,r.next=n.previous=e;t:for(s=3;s<i;++s){fp(e._,n._,r=t[s]),r=new _p(r),u=n.next,l=e.previous,c=n._.r,h=e._.r;do{if(c<=h){if(dp(u._,r._)){n=u,e.next=n,n.previous=e,--s;continue t}c+=u._.r,u=u.next}else{if(dp(l._,r._)){(e=l).next=n,n.previous=e,--s;continue t}h+=l._.r,l=l.previous}}while(u!==l.next);for(r.previous=e,r.next=n,e.next=n.previous=n=r,a=pp(e);(r=r.next)!==n;)(o=pp(r))<a&&(e=r,a=o);n=e.next}for(e=[n._],r=n;(r=r.next)!==n;)e.push(r._);for(r=ip(e),s=0;s<i;++s)(e=t[s]).x-=r.x,e.y-=r.y;return r.r}var yp=function(t){return gp(t),t};function mp(t){return null==t?null:bp(t)}function bp(t){if("function"!=typeof t)throw new Error;return t}function vp(){return 0}var xp=function(t){return function(){return t}};function wp(t){return Math.sqrt(t.value)}var Mp=function(){var t=null,e=1,n=1,r=vp;function i(i){return i.x=e/2,i.y=n/2,t?i.eachBefore(kp(t)).eachAfter(Ep(r,.5)).eachBefore(Sp(1)):i.eachBefore(kp(wp)).eachAfter(Ep(vp,1)).eachAfter(Ep(r,i.r/Math.min(e,n))).eachBefore(Sp(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=mp(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:xp(+t),i):r},i};function kp(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function Ep(t,e){return function(n){if(r=n.children){var r,i,a,o=r.length,s=t(n)*e||0;if(s)for(i=0;i<o;++i)r[i].r+=s;if(a=gp(r),s)for(i=0;i<o;++i)r[i].r-=s;n.r=a+s}}}function Sp(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}var zp=function(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)},Np=function(t,e,n,r,i){for(var a,o=t.children,s=-1,u=o.length,l=t.value&&(r-e)/t.value;++s<u;)(a=o[s]).y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*l},Tp=function(){var t=1,e=1,n=0,r=!1;function i(i){var a=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/a,i.eachBefore(function(t,e){return function(r){r.children&&Np(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,a=r.y0,o=r.x1-n,s=r.y1-n;o<i&&(i=o=(i+o)/2),s<a&&(a=s=(a+s)/2),r.x0=i,r.y0=a,r.x1=o,r.y1=s}}(e,a)),r&&i.eachBefore(zp),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},Ap={depth:-1},Cp={};function Pp(t){return t.id}function Rp(t){return t.parentId}var Op=function(){var t=Pp,e=Rp;function n(n){var r,i,a,o,s,u,l,c=n.length,h=new Array(c),f={};for(i=0;i<c;++i)r=n[i],s=h[i]=new np(r),null!=(u=t(r,i,n))&&(u+="")&&(f[l="$"+(s.id=u)]=l in f?Cp:s);for(i=0;i<c;++i)if(s=h[i],null!=(u=e(n[i],i,n))&&(u+="")){if(!(o=f["$"+u]))throw new Error("missing: "+u);if(o===Cp)throw new Error("ambiguous: "+u);o.children?o.children.push(s):o.children=[s],s.parent=o}else{if(a)throw new Error("multiple roots");a=s}if(!a)throw new Error("no root");if(a.parent=Ap,a.eachBefore((function(t){t.depth=t.parent.depth+1,--c})).eachBefore(ep),a.parent=null,c>0)throw new Error("cycle");return a}return n.id=function(e){return arguments.length?(t=bp(e),n):t},n.parentId=function(t){return arguments.length?(e=bp(t),n):e},n};function Lp(t,e){return t.parent===e.parent?1:2}function Dp(t){var e=t.children;return e?e[0]:t.t}function jp(t){var e=t.children;return e?e[e.length-1]:t.t}function $p(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Ip(t,e,n){return t.a.parent===e.parent?t.a:n}function Bp(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Bp.prototype=Object.create(np.prototype);var Up=function(){var t=Lp,e=1,n=1,r=null;function i(i){var u=function(t){for(var e,n,r,i,a,o=new Bp(t,0),s=[o];e=s.pop();)if(r=e._.children)for(e.children=new Array(a=r.length),i=a-1;i>=0;--i)s.push(n=e.children[i]=new Bp(r[i],i)),n.parent=e;return(o.parent=new Bp(null,0)).children=[o],o}(i);if(u.eachAfter(a),u.parent.m=-u.z,u.eachBefore(o),r)i.eachBefore(s);else{var l=i,c=i,h=i;i.eachBefore((function(t){t.x<l.x&&(l=t),t.x>c.x&&(c=t),t.depth>h.depth&&(h=t)}));var f=l===c?1:t(l,c)/2,d=f-l.x,p=e/(c.x+f+d),_=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*_}))}return i}function a(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,a=i.length;--a>=0;)(e=i[a]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var a=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-a):e.z=a}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,a=e,o=e,s=n,u=a.parent.children[0],l=a.m,c=o.m,h=s.m,f=u.m;s=jp(s),a=Dp(a),s&&a;)u=Dp(u),(o=jp(o)).a=e,(i=s.z+h-a.z-l+t(s._,a._))>0&&($p(Ip(s,e,r),e,i),l+=i,c+=i),h+=s.m,l+=a.m,f+=u.m,c+=o.m;s&&!jp(o)&&(o.t=s,o.m+=h-c),a&&!Dp(u)&&(u.t=a,u.m+=l-f,r=e)}return r}(e,i,e.parent.A||r[0])}function o(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function s(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},qp=function(t,e,n,r,i){for(var a,o=t.children,s=-1,u=o.length,l=t.value&&(i-n)/t.value;++s<u;)(a=o[s]).x0=e,a.x1=r,a.y0=n,a.y1=n+=a.value*l},Fp=(1+Math.sqrt(5))/2;function Yp(t,e,n,r,i,a){for(var o,s,u,l,c,h,f,d,p,_,g,y=[],m=e.children,b=0,v=0,x=m.length,w=e.value;b<x;){u=i-n,l=a-r;do{c=m[v++].value}while(!c&&v<x);for(h=f=c,g=c*c*(_=Math.max(l/u,u/l)/(w*t)),p=Math.max(f/g,g/h);v<x;++v){if(c+=s=m[v].value,s<h&&(h=s),s>f&&(f=s),g=c*c*_,(d=Math.max(f/g,g/h))>p){c-=s;break}p=d}y.push(o={value:c,dice:u<l,children:m.slice(b,v)}),o.dice?Np(o,n,r,i,w?r+=l*c/w:a):qp(o,n,r,w?n+=u*c/w:i,a),w-=c,b=v}return y}var Hp=function t(e){function n(t,n,r,i,a){Yp(e,t,n,r,i,a)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Fp),Gp=function(){var t=Hp,e=!1,n=1,r=1,i=[0],a=vp,o=vp,s=vp,u=vp,l=vp;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(zp),t}function h(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<c&&(c=f=(c+f)/2),e.x0=r,e.y0=c,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=a(e)/2,r+=l(e)-n,c+=o(e)-n,(h-=s(e)-n)<r&&(r=h=(r+h)/2),(f-=u(e)-n)<c&&(c=f=(c+f)/2),t(e,r,c,h,f))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=bp(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(a="function"==typeof t?t:xp(+t),c):a},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(o="function"==typeof t?t:xp(+t),c):o},c.paddingRight=function(t){return arguments.length?(s="function"==typeof t?t:xp(+t),c):s},c.paddingBottom=function(t){return arguments.length?(u="function"==typeof t?t:xp(+t),c):u},c.paddingLeft=function(t){return arguments.length?(l="function"==typeof t?t:xp(+t),c):l},c},Vp=function(t,e,n,r,i){var a,o,s=t.children,u=s.length,l=new Array(u+1);for(l[0]=o=a=0;a<u;++a)l[a+1]=o+=s[a].value;!function t(e,n,r,i,a,o,u){if(e>=n-1){var c=s[e];return c.x0=i,c.y0=a,c.x1=o,void(c.y1=u)}var h=l[e],f=r/2+h,d=e+1,p=n-1;for(;d<p;){var _=d+p>>>1;l[_]<f?d=_+1:p=_}f-l[d-1]<l[d]-f&&e+1<d&&--d;var g=l[d]-h,y=r-g;if(o-i>u-a){var m=(i*y+o*g)/r;t(e,d,g,i,a,m,u),t(d,n,y,m,a,o,u)}else{var b=(a*y+u*g)/r;t(e,d,g,i,a,o,b),t(d,n,y,i,b,o,u)}}(0,u,t.value,e,n,r,i)},Xp=function(t,e,n,r,i){(1&t.depth?qp:Np)(t,e,n,r,i)},Zp=function t(e){function n(t,n,r,i,a){if((o=t._squarify)&&o.ratio===e)for(var o,s,u,l,c,h=-1,f=o.length,d=t.value;++h<f;){for(u=(s=o[h]).children,l=s.value=0,c=u.length;l<c;++l)s.value+=u[l].value;s.dice?Np(s,n,r,i,r+=(a-r)*s.value/d):qp(s,n,r,n+=(i-n)*s.value/d,a),d-=s.value}else t._squarify=o=Yp(e,t,n,r,i,a),o.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(Fp),Wp=function(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}},Jp=function(t,e){var n=Kn(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},Kp=function(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}},Qp=Math.SQRT2;function t_(t){return((t=Math.exp(t))+1/t)/2}var e_=function(t,e){var n,r,i=t[0],a=t[1],o=t[2],s=e[0],u=e[1],l=e[2],c=s-i,h=u-a,f=c*c+h*h;if(f<1e-12)r=Math.log(l/o)/Qp,n=function(t){return[i+t*c,a+t*h,o*Math.exp(Qp*t*r)]};else{var d=Math.sqrt(f),p=(l*l-o*o+4*f)/(2*o*2*d),_=(l*l-o*o-4*f)/(2*l*2*d),g=Math.log(Math.sqrt(p*p+1)-p),y=Math.log(Math.sqrt(_*_+1)-_);r=(y-g)/Qp,n=function(t){var e,n=t*r,s=t_(g),u=o/(2*d)*(s*(e=Qp*n+g,((e=Math.exp(2*e))-1)/(e+1))-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[i+u*c,a+u*h,o*s/t_(Qp*n+g)]}}return n.duration=1e3*r,n};function n_(t){return function(e,n){var r=t((e=Yn(e)).h,(n=Yn(n)).h),i=tr(e.s,n.s),a=tr(e.l,n.l),o=tr(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var r_=n_(Kn),i_=n_(tr);function a_(t,e){var n=tr((t=ro(t)).l,(e=ro(e)).l),r=tr(t.a,e.a),i=tr(t.b,e.b),a=tr(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=a(e),t+""}}function o_(t){return function(e,n){var r=t((e=ho(e)).h,(n=ho(n)).h),i=tr(e.c,n.c),a=tr(e.l,n.l),o=tr(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=a(t),e.opacity=o(t),e+""}}}var s_=o_(Kn),u_=o_(tr);function l_(t){return function e(n){function r(e,r){var i=t((e=vo(e)).h,(r=vo(r)).h),a=tr(e.s,r.s),o=tr(e.l,r.l),s=tr(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=a(t),e.l=o(Math.pow(t,n)),e.opacity=s(t),e+""}}return n=+n,r.gamma=e,r}(1)}var c_=l_(Kn),h_=l_(tr);function f_(t,e){for(var n=0,r=e.length-1,i=e[0],a=new Array(r<0?0:r);n<r;)a[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return a[e](t-e)}}var d_=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n},p_=function(t){for(var e,n=-1,r=t.length,i=t[r-1],a=0;++n<r;)e=i,i=t[n],a+=e[1]*i[0]-e[0]*i[1];return a/2},__=function(t){for(var e,n,r=-1,i=t.length,a=0,o=0,s=t[i-1],u=0;++r<i;)e=s,s=t[r],u+=n=e[0]*s[1]-s[0]*e[1],a+=(e[0]+s[0])*n,o+=(e[1]+s[1])*n;return[a/(u*=3),o/u]};function g_(t,e){return t[0]-e[0]||t[1]-e[1]}function y_(t){for(var e,n,r,i=t.length,a=[0,1],o=2,s=2;s<i;++s){for(;o>1&&(e=t[a[o-2]],n=t[a[o-1]],r=t[s],(n[0]-e[0])*(r[1]-e[1])-(n[1]-e[1])*(r[0]-e[0])<=0);)--o;a[o++]=s}return a.slice(0,o)}var m_=function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(g_),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var a=y_(r),o=y_(i),s=o[0]===a[0],u=o[o.length-1]===a[a.length-1],l=[];for(e=a.length-1;e>=0;--e)l.push(t[r[a[e]][2]]);for(e=+s;e<o.length-u;++e)l.push(t[r[o[e]][2]]);return l},b_=function(t,e){for(var n,r,i=t.length,a=t[i-1],o=e[0],s=e[1],u=a[0],l=a[1],c=!1,h=0;h<i;++h)n=(a=t[h])[0],(r=a[1])>s!=l>s&&o<(u-n)*(s-r)/(l-r)+n&&(c=!c),u=n,l=r;return c},v_=function(t){for(var e,n,r=-1,i=t.length,a=t[i-1],o=a[0],s=a[1],u=0;++r<i;)e=o,n=s,e-=o=(a=t[r])[0],n-=s=a[1],u+=Math.sqrt(e*e+n*n);return u},x_=function(){return Math.random()},w_=function t(e){function n(t,n){return t=null==t?0:+t,n=null==n?1:+n,1===arguments.length?(n=t,t=0):n-=t,function(){return e()*n+t}}return n.source=t,n}(x_),M_=function t(e){function n(t,n){var r,i;return t=null==t?0:+t,n=null==n?1:+n,function(){var a;if(null!=r)a=r,r=null;else do{r=2*e()-1,a=2*e()-1,i=r*r+a*a}while(!i||i>1);return t+n*a*Math.sqrt(-2*Math.log(i)/i)}}return n.source=t,n}(x_),k_=function t(e){function n(){var t=M_.source(e).apply(this,arguments);return function(){return Math.exp(t())}}return n.source=t,n}(x_),E_=function t(e){function n(t){return function(){for(var n=0,r=0;r<t;++r)n+=e();return n}}return n.source=t,n}(x_),S_=function t(e){function n(t){var n=E_.source(e)(t);return function(){return n()/t}}return n.source=t,n}(x_),z_=function t(e){function n(t){return function(){return-Math.log(1-e())/t}}return n.source=t,n}(x_);function N_(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function T_(t,e){switch(arguments.length){case 0:break;case 1:this.interpolator(t);break;default:this.interpolator(e).domain(t)}return this}var A_=Array.prototype,C_=A_.map,P_=A_.slice,R_={name:"implicit"};function O_(){var t=Ba(),e=[],n=[],r=R_;function i(i){var a=i+"",o=t.get(a);if(!o){if(r!==R_)return r;t.set(a,o=e.push(i))}return n[(o-1)%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=Ba();for(var r,a,o=-1,s=n.length;++o<s;)t.has(a=(r=n[o])+"")||t.set(a,e.push(r));return i},i.range=function(t){return arguments.length?(n=P_.call(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return O_(e,n).unknown(r)},N_.apply(i,arguments),i}function L_(){var t,e,n=O_().unknown(void 0),r=n.domain,i=n.range,a=[0,1],o=!1,s=0,u=0,l=.5;function c(){var n=r().length,c=a[1]<a[0],h=a[c-0],f=a[1-c];t=(f-h)/Math.max(1,n-s+2*u),o&&(t=Math.floor(t)),h+=(f-h-t*(n-s))*l,e=t*(1-s),o&&(h=Math.round(h),e=Math.round(e));var d=ht(n).map((function(e){return h+t*e}));return i(c?d.reverse():d)}return delete n.unknown,n.domain=function(t){return arguments.length?(r(t),c()):r()},n.range=function(t){return arguments.length?(a=[+t[0],+t[1]],c()):a.slice()},n.rangeRound=function(t){return a=[+t[0],+t[1]],o=!0,c()},n.bandwidth=function(){return e},n.step=function(){return t},n.round=function(t){return arguments.length?(o=!!t,c()):o},n.padding=function(t){return arguments.length?(s=Math.min(1,u=+t),c()):s},n.paddingInner=function(t){return arguments.length?(s=Math.min(1,t),c()):s},n.paddingOuter=function(t){return arguments.length?(u=+t,c()):u},n.align=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},n.copy=function(){return L_(r(),a).round(o).paddingInner(s).paddingOuter(u).align(l)},N_.apply(c(),arguments)}function D_(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return D_(e())},t}function j_(){return D_(L_.apply(null,arguments).paddingInner(1))}var $_=function(t){return+t},I_=[0,1];function B_(t){return t}function U_(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:(n=isNaN(e)?NaN:.5,function(){return n});var n}function q_(t){var e,n=t[0],r=t[t.length-1];return n>r&&(e=n,n=r,r=e),function(t){return Math.max(n,Math.min(r,t))}}function F_(t,e,n){var r=t[0],i=t[1],a=e[0],o=e[1];return i<r?(r=U_(i,r),a=n(o,a)):(r=U_(r,i),a=n(a,o)),function(t){return a(r(t))}}function Y_(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),a=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=U_(t[o],t[o+1]),a[o]=n(e[o],e[o+1]);return function(e){var n=J(t,e,1,r)-1;return a[n](i[n](e))}}function H_(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function G_(){var t,e,n,r,i,a,o=I_,s=I_,u=yr,l=B_;function c(){return r=Math.min(o.length,s.length)>2?Y_:F_,i=a=null,h}function h(e){return isNaN(e=+e)?n:(i||(i=r(o.map(t),s,u)))(t(l(e)))}return h.invert=function(n){return l(e((a||(a=r(s,o.map(t),cr)))(n)))},h.domain=function(t){return arguments.length?(o=C_.call(t,$_),l===B_||(l=q_(o)),c()):o.slice()},h.range=function(t){return arguments.length?(s=P_.call(t),c()):s.slice()},h.rangeRound=function(t){return s=P_.call(t),u=Kp,c()},h.clamp=function(t){return arguments.length?(l=t?q_(o):B_,h):l!==B_},h.interpolate=function(t){return arguments.length?(u=t,c()):u},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}function V_(t,e){return G_()(t,e)}var X_=function(t,e,n,r){var i,a=yt(t,e,n);switch((r=Lu(null==r?",f":r)).type){case"s":var o=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=Zu(a,o))||(r.precision=i),Bu(r,o);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=Wu(a,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=Xu(a))||(r.precision=i-2*("%"===r.type))}return Iu(r)};function Z_(t){var e=t.domain;return t.ticks=function(t){var n=e();return _t(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return X_(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i=e(),a=0,o=i.length-1,s=i[a],u=i[o];return u<s&&(r=s,s=u,u=r,r=a,a=o,o=r),(r=gt(s,u,n))>0?r=gt(s=Math.floor(s/r)*r,u=Math.ceil(u/r)*r,n):r<0&&(r=gt(s=Math.ceil(s*r)/r,u=Math.floor(u*r)/r,n)),r>0?(i[a]=Math.floor(s/r)*r,i[o]=Math.ceil(u/r)*r,e(i)):r<0&&(i[a]=Math.ceil(s*r)/r,i[o]=Math.floor(u*r)/r,e(i)),t},t}function W_(){var t=V_(B_,B_);return t.copy=function(){return H_(t,W_())},N_.apply(t,arguments),Z_(t)}function J_(t){var e;function n(t){return isNaN(t=+t)?e:t}return n.invert=n,n.domain=n.range=function(e){return arguments.length?(t=C_.call(e,$_),n):t.slice()},n.unknown=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return J_(t).unknown(e)},t=arguments.length?C_.call(t,$_):[0,1],Z_(n)}var K_=function(t,e){var n,r=0,i=(t=t.slice()).length-1,a=t[r],o=t[i];return o<a&&(n=r,r=i,i=n,n=a,a=o,o=n),t[r]=e.floor(a),t[i]=e.ceil(o),t};function Q_(t){return Math.log(t)}function tg(t){return Math.exp(t)}function eg(t){return-Math.log(-t)}function ng(t){return-Math.exp(-t)}function rg(t){return isFinite(t)?+("1e"+t):t<0?0:t}function ig(t){return function(e){return-t(-e)}}function ag(t){var e,n,r=t(Q_,tg),i=r.domain,a=10;function o(){return e=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),function(e){return Math.log(e)/t})}(a),n=function(t){return 10===t?rg:t===Math.E?Math.exp:function(e){return Math.pow(t,e)}}(a),i()[0]<0?(e=ig(e),n=ig(n),t(eg,ng)):t(Q_,tg),r}return r.base=function(t){return arguments.length?(a=+t,o()):a},r.domain=function(t){return arguments.length?(i(t),o()):i()},r.ticks=function(t){var r,o=i(),s=o[0],u=o[o.length-1];(r=u<s)&&(f=s,s=u,u=f);var l,c,h,f=e(s),d=e(u),p=null==t?10:+t,_=[];if(!(a%1)&&d-f<p){if(f=Math.round(f)-1,d=Math.round(d)+1,s>0){for(;f<d;++f)for(c=1,l=n(f);c<a;++c)if(!((h=l*c)<s)){if(h>u)break;_.push(h)}}else for(;f<d;++f)for(c=a-1,l=n(f);c>=1;--c)if(!((h=l*c)<s)){if(h>u)break;_.push(h)}}else _=_t(f,d,Math.min(d-f,p)).map(n);return r?_.reverse():_},r.tickFormat=function(t,i){if(null==i&&(i=10===a?".0e":","),"function"!=typeof i&&(i=Iu(i)),t===1/0)return i;null==t&&(t=10);var o=Math.max(1,a*t/r.ticks().length);return function(t){var r=t/n(Math.round(e(t)));return r*a<a-.5&&(r*=a),r<=o?i(t):""}},r.nice=function(){return i(K_(i(),{floor:function(t){return n(Math.floor(e(t)))},ceil:function(t){return n(Math.ceil(e(t)))}}))},r}function og(){var t=ag(G_()).domain([1,10]);return t.copy=function(){return H_(t,og()).base(t.base())},N_.apply(t,arguments),t}function sg(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function ug(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function lg(t){var e=1,n=t(sg(e),ug(e));return n.constant=function(n){return arguments.length?t(sg(e=+n),ug(e)):e},Z_(n)}function cg(){var t=lg(G_());return t.copy=function(){return H_(t,cg()).constant(t.constant())},N_.apply(t,arguments)}function hg(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function fg(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function dg(t){return t<0?-t*t:t*t}function pg(t){var e=t(B_,B_),n=1;function r(){return 1===n?t(B_,B_):.5===n?t(fg,dg):t(hg(n),hg(1/n))}return e.exponent=function(t){return arguments.length?(n=+t,r()):n},Z_(e)}function _g(){var t=pg(G_());return t.copy=function(){return H_(t,_g()).exponent(t.exponent())},N_.apply(t,arguments),t}function gg(){return _g.apply(null,arguments).exponent(.5)}function yg(){var t,e=[],n=[],r=[];function i(){var t=0,i=Math.max(1,n.length);for(r=new Array(i-1);++t<i;)r[t-1]=vt(e,t/i);return a}function a(e){return isNaN(e=+e)?t:n[J(r,e)]}return a.invertExtent=function(t){var i=n.indexOf(t);return i<0?[NaN,NaN]:[i>0?r[i-1]:e[0],i<r.length?r[i]:e[e.length-1]]},a.domain=function(t){if(!arguments.length)return e.slice();e=[];for(var n,r=0,a=t.length;r<a;++r)null==(n=t[r])||isNaN(n=+n)||e.push(n);return e.sort(G),i()},a.range=function(t){return arguments.length?(n=P_.call(t),i()):n.slice()},a.unknown=function(e){return arguments.length?(t=e,a):t},a.quantiles=function(){return r.slice()},a.copy=function(){return yg().domain(e).range(n).unknown(t)},N_.apply(a,arguments)}function mg(){var t,e=0,n=1,r=1,i=[.5],a=[0,1];function o(e){return e<=e?a[J(i,e,0,r)]:t}function s(){var t=-1;for(i=new Array(r);++t<r;)i[t]=((t+1)*n-(t-r)*e)/(r+1);return o}return o.domain=function(t){return arguments.length?(e=+t[0],n=+t[1],s()):[e,n]},o.range=function(t){return arguments.length?(r=(a=P_.call(t)).length-1,s()):a.slice()},o.invertExtent=function(t){var o=a.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,i[0]]:o>=r?[i[r-1],n]:[i[o-1],i[o]]},o.unknown=function(e){return arguments.length?(t=e,o):o},o.thresholds=function(){return i.slice()},o.copy=function(){return mg().domain([e,n]).range(a).unknown(t)},N_.apply(Z_(o),arguments)}function bg(){var t,e=[.5],n=[0,1],r=1;function i(i){return i<=i?n[J(e,i,0,r)]:t}return i.domain=function(t){return arguments.length?(e=P_.call(t),r=Math.min(e.length,n.length-1),i):e.slice()},i.range=function(t){return arguments.length?(n=P_.call(t),r=Math.min(e.length,n.length-1),i):n.slice()},i.invertExtent=function(t){var r=n.indexOf(t);return[e[r-1],e[r]]},i.unknown=function(e){return arguments.length?(t=e,i):t},i.copy=function(){return bg().domain(e).range(n).unknown(t)},N_.apply(i,arguments)}var vg=new Date,xg=new Date;function wg(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=function(e){return t(e=new Date(+e)),e},i.ceil=function(n){return t(n=new Date(n-1)),e(n,1),t(n),n},i.round=function(t){var e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=function(t,n){return e(t=new Date(+t),null==n?1:Math.floor(n)),t},i.range=function(n,r,a){var o,s=[];if(n=i.ceil(n),a=null==a?1:Math.floor(a),!(n<r&&a>0))return s;do{s.push(o=new Date(+n)),e(n,a),t(n)}while(o<n&&n<r);return s},i.filter=function(n){return wg((function(e){if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),(function(t,r){if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););}))},n&&(i.count=function(e,r){return vg.setTime(+e),xg.setTime(+r),t(vg),t(xg),Math.floor(n(vg,xg))},i.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?function(e){return r(e)%t==0}:function(e){return i.count(0,e)%t==0}):i:null}),i}var Mg=wg((function(t){t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,e){t.setFullYear(t.getFullYear()+e)}),(function(t,e){return e.getFullYear()-t.getFullYear()}),(function(t){return t.getFullYear()}));Mg.every=function(t){return isFinite(t=Math.floor(t))&&t>0?wg((function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,n){e.setFullYear(e.getFullYear()+n*t)})):null};var kg=Mg,Eg=Mg.range,Sg=wg((function(t){t.setDate(1),t.setHours(0,0,0,0)}),(function(t,e){t.setMonth(t.getMonth()+e)}),(function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}),(function(t){return t.getMonth()})),zg=Sg,Ng=Sg.range;function Tg(t){return wg((function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+7*e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/6048e5}))}var Ag=Tg(0),Cg=Tg(1),Pg=Tg(2),Rg=Tg(3),Og=Tg(4),Lg=Tg(5),Dg=Tg(6),jg=Ag.range,$g=Cg.range,Ig=Pg.range,Bg=Rg.range,Ug=Og.range,qg=Lg.range,Fg=Dg.range,Yg=wg((function(t){t.setHours(0,0,0,0)}),(function(t,e){t.setDate(t.getDate()+e)}),(function(t,e){return(e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5}),(function(t){return t.getDate()-1})),Hg=Yg,Gg=Yg.range,Vg=wg((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds()-6e4*t.getMinutes())}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getHours()})),Xg=Vg,Zg=Vg.range,Wg=wg((function(t){t.setTime(t-t.getMilliseconds()-1e3*t.getSeconds())}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getMinutes()})),Jg=Wg,Kg=Wg.range,Qg=wg((function(t){t.setTime(t-t.getMilliseconds())}),(function(t,e){t.setTime(+t+1e3*e)}),(function(t,e){return(e-t)/1e3}),(function(t){return t.getUTCSeconds()})),ty=Qg,ey=Qg.range,ny=wg((function(){}),(function(t,e){t.setTime(+t+e)}),(function(t,e){return e-t}));ny.every=function(t){return t=Math.floor(t),isFinite(t)&&t>0?t>1?wg((function(e){e.setTime(Math.floor(e/t)*t)}),(function(e,n){e.setTime(+e+n*t)}),(function(e,n){return(n-e)/t})):ny:null};var ry=ny,iy=ny.range;function ay(t){return wg((function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+7*e)}),(function(t,e){return(e-t)/6048e5}))}var oy=ay(0),sy=ay(1),uy=ay(2),ly=ay(3),cy=ay(4),hy=ay(5),fy=ay(6),dy=oy.range,py=sy.range,_y=uy.range,gy=ly.range,yy=cy.range,my=hy.range,by=fy.range,vy=wg((function(t){t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCDate(t.getUTCDate()+e)}),(function(t,e){return(e-t)/864e5}),(function(t){return t.getUTCDate()-1})),xy=vy,wy=vy.range,My=wg((function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)}),(function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()}),(function(t){return t.getUTCFullYear()}));My.every=function(t){return isFinite(t=Math.floor(t))&&t>0?wg((function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null};var ky=My,Ey=My.range;function Sy(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function zy(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Ny(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Ty(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,a=t.days,o=t.shortDays,s=t.months,u=t.shortMonths,l=Uy(i),c=qy(i),h=Uy(a),f=qy(a),d=Uy(o),p=qy(o),_=Uy(s),g=qy(s),y=Uy(u),m=qy(u),b={a:function(t){return o[t.getDay()]},A:function(t){return a[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:lm,e:lm,f:pm,g:Em,G:zm,H:cm,I:hm,j:fm,L:dm,m:_m,M:gm,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:Wm,s:Jm,S:ym,u:mm,U:bm,V:xm,w:wm,W:Mm,x:null,X:null,y:km,Y:Sm,Z:Nm,"%":Zm},v={a:function(t){return o[t.getUTCDay()]},A:function(t){return a[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:Tm,e:Tm,f:Om,g:Hm,G:Vm,H:Am,I:Cm,j:Pm,L:Rm,m:Lm,M:Dm,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:Wm,s:Jm,S:jm,u:$m,U:Im,V:Um,w:qm,W:Fm,x:null,X:null,y:Ym,Y:Gm,Z:Xm,"%":Zm},x={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p[r[0].toLowerCase()],n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f[r[0].toLowerCase()],n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=m[r[0].toLowerCase()],n+r[0].length):-1},B:function(t,e,n){var r=_.exec(e.slice(n));return r?(t.m=g[r[0].toLowerCase()],n+r[0].length):-1},c:function(t,n,r){return k(t,e,n,r)},d:Qy,e:Qy,f:am,g:Zy,G:Xy,H:em,I:em,j:tm,L:im,m:Ky,M:nm,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=c[r[0].toLowerCase()],n+r[0].length):-1},q:Jy,Q:sm,s:um,S:rm,u:Yy,U:Hy,V:Gy,w:Fy,W:Vy,x:function(t,e,r){return k(t,n,e,r)},X:function(t,e,n){return k(t,r,e,n)},y:Zy,Y:Xy,Z:Wy,"%":om};function w(t,e){return function(n){var r,i,a,o=[],s=-1,u=0,l=t.length;for(n instanceof Date||(n=new Date(+n));++s<l;)37===t.charCodeAt(s)&&(o.push(t.slice(u,s)),null!=(i=Ly[r=t.charAt(++s)])?r=t.charAt(++s):i="e"===r?" ":"0",(a=e[r])&&(r=a(n,i)),o.push(r),u=s+1);return o.push(t.slice(u,s)),o.join("")}}function M(t,e){return function(n){var r,i,a=Ny(1900,void 0,1);if(k(a,t,n+="",0)!=n.length)return null;if("Q"in a)return new Date(a.Q);if("s"in a)return new Date(1e3*a.s+("L"in a?a.L:0));if(e&&!("Z"in a)&&(a.Z=0),"p"in a&&(a.H=a.H%12+12*a.p),void 0===a.m&&(a.m="q"in a?a.q:0),"V"in a){if(a.V<1||a.V>53)return null;"w"in a||(a.w=1),"Z"in a?(i=(r=zy(Ny(a.y,0,1))).getUTCDay(),r=i>4||0===i?sy.ceil(r):sy(r),r=xy.offset(r,7*(a.V-1)),a.y=r.getUTCFullYear(),a.m=r.getUTCMonth(),a.d=r.getUTCDate()+(a.w+6)%7):(i=(r=Sy(Ny(a.y,0,1))).getDay(),r=i>4||0===i?Cg.ceil(r):Cg(r),r=Hg.offset(r,7*(a.V-1)),a.y=r.getFullYear(),a.m=r.getMonth(),a.d=r.getDate()+(a.w+6)%7)}else("W"in a||"U"in a)&&("w"in a||(a.w="u"in a?a.u%7:"W"in a?1:0),i="Z"in a?zy(Ny(a.y,0,1)).getUTCDay():Sy(Ny(a.y,0,1)).getDay(),a.m=0,a.d="W"in a?(a.w+6)%7+7*a.W-(i+5)%7:a.w+7*a.U-(i+6)%7);return"Z"in a?(a.H+=a.Z/100|0,a.M+=a.Z%100,zy(a)):Sy(a)}}function k(t,e,n,r){for(var i,a,o=0,s=e.length,u=n.length;o<s;){if(r>=u)return-1;if(37===(i=e.charCodeAt(o++))){if(i=e.charAt(o++),!(a=x[i in Ly?e.charAt(o++):i])||(r=a(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return b.x=w(n,b),b.X=w(r,b),b.c=w(e,b),v.x=w(n,v),v.X=w(r,v),v.c=w(e,v),{format:function(t){var e=w(t+="",b);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=w(t+="",v);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t+="",!0);return e.toString=function(){return t},e}}}var Ay,Cy,Py,Ry,Oy,Ly={"-":"",_:" ",0:"0"},Dy=/^\s*\d+/,jy=/^%/,$y=/[\\^$*+?|[\]().{}]/g;function Iy(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",a=i.length;return r+(a<n?new Array(n-a+1).join(e)+i:i)}function By(t){return t.replace($y,"\\$&")}function Uy(t){return new RegExp("^(?:"+t.map(By).join("|")+")","i")}function qy(t){for(var e={},n=-1,r=t.length;++n<r;)e[t[n].toLowerCase()]=n;return e}function Fy(t,e,n){var r=Dy.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Yy(t,e,n){var r=Dy.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Hy(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Gy(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Vy(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Xy(t,e,n){var r=Dy.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Zy(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Wy(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Jy(t,e,n){var r=Dy.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function Ky(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Qy(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function tm(t,e,n){var r=Dy.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function em(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function nm(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function rm(t,e,n){var r=Dy.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function im(t,e,n){var r=Dy.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function am(t,e,n){var r=Dy.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function om(t,e,n){var r=jy.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function sm(t,e,n){var r=Dy.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function um(t,e,n){var r=Dy.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function lm(t,e){return Iy(t.getDate(),e,2)}function cm(t,e){return Iy(t.getHours(),e,2)}function hm(t,e){return Iy(t.getHours()%12||12,e,2)}function fm(t,e){return Iy(1+Hg.count(kg(t),t),e,3)}function dm(t,e){return Iy(t.getMilliseconds(),e,3)}function pm(t,e){return dm(t,e)+"000"}function _m(t,e){return Iy(t.getMonth()+1,e,2)}function gm(t,e){return Iy(t.getMinutes(),e,2)}function ym(t,e){return Iy(t.getSeconds(),e,2)}function mm(t){var e=t.getDay();return 0===e?7:e}function bm(t,e){return Iy(Ag.count(kg(t)-1,t),e,2)}function vm(t){var e=t.getDay();return e>=4||0===e?Og(t):Og.ceil(t)}function xm(t,e){return t=vm(t),Iy(Og.count(kg(t),t)+(4===kg(t).getDay()),e,2)}function wm(t){return t.getDay()}function Mm(t,e){return Iy(Cg.count(kg(t)-1,t),e,2)}function km(t,e){return Iy(t.getFullYear()%100,e,2)}function Em(t,e){return Iy((t=vm(t)).getFullYear()%100,e,2)}function Sm(t,e){return Iy(t.getFullYear()%1e4,e,4)}function zm(t,e){var n=t.getDay();return Iy((t=n>=4||0===n?Og(t):Og.ceil(t)).getFullYear()%1e4,e,4)}function Nm(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Iy(e/60|0,"0",2)+Iy(e%60,"0",2)}function Tm(t,e){return Iy(t.getUTCDate(),e,2)}function Am(t,e){return Iy(t.getUTCHours(),e,2)}function Cm(t,e){return Iy(t.getUTCHours()%12||12,e,2)}function Pm(t,e){return Iy(1+xy.count(ky(t),t),e,3)}function Rm(t,e){return Iy(t.getUTCMilliseconds(),e,3)}function Om(t,e){return Rm(t,e)+"000"}function Lm(t,e){return Iy(t.getUTCMonth()+1,e,2)}function Dm(t,e){return Iy(t.getUTCMinutes(),e,2)}function jm(t,e){return Iy(t.getUTCSeconds(),e,2)}function $m(t){var e=t.getUTCDay();return 0===e?7:e}function Im(t,e){return Iy(oy.count(ky(t)-1,t),e,2)}function Bm(t){var e=t.getUTCDay();return e>=4||0===e?cy(t):cy.ceil(t)}function Um(t,e){return t=Bm(t),Iy(cy.count(ky(t),t)+(4===ky(t).getUTCDay()),e,2)}function qm(t){return t.getUTCDay()}function Fm(t,e){return Iy(sy.count(ky(t)-1,t),e,2)}function Ym(t,e){return Iy(t.getUTCFullYear()%100,e,2)}function Hm(t,e){return Iy((t=Bm(t)).getUTCFullYear()%100,e,2)}function Gm(t,e){return Iy(t.getUTCFullYear()%1e4,e,4)}function Vm(t,e){var n=t.getUTCDay();return Iy((t=n>=4||0===n?cy(t):cy.ceil(t)).getUTCFullYear()%1e4,e,4)}function Xm(){return"+0000"}function Zm(){return"%"}function Wm(t){return+t}function Jm(t){return Math.floor(+t/1e3)}function Km(t){return Ay=Ty(t),Cy=Ay.format,Py=Ay.parse,Ry=Ay.utcFormat,Oy=Ay.utcParse,Ay}Km({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Qm(t){return new Date(t)}function tb(t){return t instanceof Date?+t:+new Date(+t)}function eb(t,e,n,r,i,a,o,s,u){var l=V_(B_,B_),c=l.invert,h=l.domain,f=u(".%L"),d=u(":%S"),p=u("%I:%M"),_=u("%I %p"),g=u("%a %d"),y=u("%b %d"),m=u("%B"),b=u("%Y"),v=[[o,1,1e3],[o,5,5e3],[o,15,15e3],[o,30,3e4],[a,1,6e4],[a,5,3e5],[a,15,9e5],[a,30,18e5],[i,1,36e5],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,864e5],[r,2,1728e5],[n,1,6048e5],[e,1,2592e6],[e,3,7776e6],[t,1,31536e6]];function x(s){return(o(s)<s?f:a(s)<s?d:i(s)<s?p:r(s)<s?_:e(s)<s?n(s)<s?g:y:t(s)<s?m:b)(s)}function w(e,n,r,i){if(null==e&&(e=10),"number"==typeof e){var a=Math.abs(r-n)/e,o=V((function(t){return t[2]})).right(v,a);o===v.length?(i=yt(n/31536e6,r/31536e6,e),e=t):o?(i=(o=v[a/v[o-1][2]<v[o][2]/a?o-1:o])[1],e=o[0]):(i=Math.max(yt(n,r,e),1),e=s)}return null==i?e:e.every(i)}return l.invert=function(t){return new Date(c(t))},l.domain=function(t){return arguments.length?h(C_.call(t,tb)):h().map(Qm)},l.ticks=function(t,e){var n,r=h(),i=r[0],a=r[r.length-1],o=a<i;return o&&(n=i,i=a,a=n),n=(n=w(t,i,a,e))?n.range(i,a+1):[],o?n.reverse():n},l.tickFormat=function(t,e){return null==e?x:u(e)},l.nice=function(t,e){var n=h();return(t=w(t,n[0],n[n.length-1],e))?h(K_(n,t)):l},l.copy=function(){return H_(l,eb(t,e,n,r,i,a,o,s,u))},l}var nb=function(){return N_.apply(eb(kg,zg,Ag,Hg,Xg,Jg,ty,ry,Cy).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},rb=wg((function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),(function(t,e){t.setUTCMonth(t.getUTCMonth()+e)}),(function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())}),(function(t){return t.getUTCMonth()})),ib=rb,ab=rb.range,ob=wg((function(t){t.setUTCMinutes(0,0,0)}),(function(t,e){t.setTime(+t+36e5*e)}),(function(t,e){return(e-t)/36e5}),(function(t){return t.getUTCHours()})),sb=ob,ub=ob.range,lb=wg((function(t){t.setUTCSeconds(0,0)}),(function(t,e){t.setTime(+t+6e4*e)}),(function(t,e){return(e-t)/6e4}),(function(t){return t.getUTCMinutes()})),cb=lb,hb=lb.range,fb=function(){return N_.apply(eb(ky,ib,oy,xy,sb,cb,ty,ry,Ry).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)};function db(){var t,e,n,r,i,a=0,o=1,s=B_,u=!1;function l(e){return isNaN(e=+e)?i:s(0===n?.5:(e=(r(e)-t)*n,u?Math.max(0,Math.min(1,e)):e))}return l.domain=function(i){return arguments.length?(t=r(a=+i[0]),e=r(o=+i[1]),n=t===e?0:1/(e-t),l):[a,o]},l.clamp=function(t){return arguments.length?(u=!!t,l):u},l.interpolator=function(t){return arguments.length?(s=t,l):s},l.unknown=function(t){return arguments.length?(i=t,l):i},function(i){return r=i,t=i(a),e=i(o),n=t===e?0:1/(e-t),l}}function pb(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function _b(){var t=Z_(db()(B_));return t.copy=function(){return pb(t,_b())},T_.apply(t,arguments)}function gb(){var t=ag(db()).domain([1,10]);return t.copy=function(){return pb(t,gb()).base(t.base())},T_.apply(t,arguments)}function yb(){var t=lg(db());return t.copy=function(){return pb(t,yb()).constant(t.constant())},T_.apply(t,arguments)}function mb(){var t=pg(db());return t.copy=function(){return pb(t,mb()).exponent(t.exponent())},T_.apply(t,arguments)}function bb(){return mb.apply(null,arguments).exponent(.5)}function vb(){var t=[],e=B_;function n(n){if(!isNaN(n=+n))return e((J(t,n)-1)/(t.length-1))}return n.domain=function(e){if(!arguments.length)return t.slice();t=[];for(var r,i=0,a=e.length;i<a;++i)null==(r=e[i])||isNaN(r=+r)||t.push(r);return t.sort(G),n},n.interpolator=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return vb(e).domain(t)},T_.apply(n,arguments)}function xb(){var t,e,n,r,i,a,o,s=0,u=.5,l=1,c=B_,h=!1;function f(t){return isNaN(t=+t)?o:(t=.5+((t=+a(t))-e)*(t<e?r:i),c(h?Math.max(0,Math.min(1,t)):t))}return f.domain=function(o){return arguments.length?(t=a(s=+o[0]),e=a(u=+o[1]),n=a(l=+o[2]),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),f):[s,u,l]},f.clamp=function(t){return arguments.length?(h=!!t,f):h},f.interpolator=function(t){return arguments.length?(c=t,f):c},f.unknown=function(t){return arguments.length?(o=t,f):o},function(o){return a=o,t=o(s),e=o(u),n=o(l),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),f}}function wb(){var t=Z_(xb()(B_));return t.copy=function(){return pb(t,wb())},T_.apply(t,arguments)}function Mb(){var t=ag(xb()).domain([.1,1,10]);return t.copy=function(){return pb(t,Mb()).base(t.base())},T_.apply(t,arguments)}function kb(){var t=lg(xb());return t.copy=function(){return pb(t,kb()).constant(t.constant())},T_.apply(t,arguments)}function Eb(){var t=pg(xb());return t.copy=function(){return pb(t,Eb()).exponent(t.exponent())},T_.apply(t,arguments)}function Sb(){return Eb.apply(null,arguments).exponent(.5)}var zb=function(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n},Nb=zb("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Tb=zb("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Ab=zb("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Cb=zb("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Pb=zb("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Rb=zb("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Ob=zb("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Lb=zb("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Db=zb("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),jb=zb("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),$b=function(t){return rr(t[t.length-1])},Ib=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(zb),Bb=$b(Ib),Ub=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(zb),qb=$b(Ub),Fb=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(zb),Yb=$b(Fb),Hb=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(zb),Gb=$b(Hb),Vb=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(zb),Xb=$b(Vb),Zb=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(zb),Wb=$b(Zb),Jb=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(zb),Kb=$b(Jb),Qb=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(zb),tv=$b(Qb),ev=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(zb),nv=$b(ev),rv=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(zb),iv=$b(rv),av=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(zb),ov=$b(av),sv=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(zb),uv=$b(sv),lv=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(zb),cv=$b(lv),hv=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(zb),fv=$b(hv),dv=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(zb),pv=$b(dv),_v=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(zb),gv=$b(_v),yv=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(zb),mv=$b(yv),bv=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(zb),vv=$b(bv),xv=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(zb),wv=$b(xv),Mv=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(zb),kv=$b(Mv),Ev=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(zb),Sv=$b(Ev),zv=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(zb),Nv=$b(zv),Tv=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(zb),Av=$b(Tv),Cv=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(zb),Pv=$b(Cv),Rv=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(zb),Ov=$b(Rv),Lv=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(zb),Dv=$b(Lv),jv=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(zb),$v=$b(jv),Iv=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},Bv=h_(vo(300,.5,0),vo(-240,.5,1)),Uv=h_(vo(-100,.75,.35),vo(80,1.5,.8)),qv=h_(vo(260,.75,.35),vo(80,1.5,.8)),Fv=vo(),Yv=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return Fv.h=360*t-100,Fv.s=1.5-1.5*e,Fv.l=.8-.9*e,Fv+""},Hv=jn(),Gv=Math.PI/3,Vv=2*Math.PI/3,Xv=function(t){var e;return t=(.5-t)*Math.PI,Hv.r=255*(e=Math.sin(t))*e,Hv.g=255*(e=Math.sin(t+Gv))*e,Hv.b=255*(e=Math.sin(t+Vv))*e,Hv+""},Zv=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"};function Wv(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}var Jv=Wv(zb("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Kv=Wv(zb("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Qv=Wv(zb("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),tx=Wv(zb("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921")),ex=function(t){return fn(He(t).call(document.documentElement))},nx=0;function rx(){return new ix}function ix(){this._="@"+(++nx).toString(36)}ix.prototype=rx.prototype={constructor:ix,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var ax=function(t){return"string"==typeof t?new ln([document.querySelectorAll(t)],[document.documentElement]):new ln([null==t?[]:t],un)},ox=function(t,e){null==e&&(e=mr().touches);for(var n=0,r=e?e.length:0,i=new Array(r);n<r;++n)i[n]=br(t,e[n]);return i},sx=function(t){return function(){return t}},ux=Math.abs,lx=Math.atan2,cx=Math.cos,hx=Math.max,fx=Math.min,dx=Math.sin,px=Math.sqrt,_x=Math.PI,gx=_x/2,yx=2*_x;function mx(t){return t>1?0:t<-1?_x:Math.acos(t)}function bx(t){return t>=1?gx:t<=-1?-gx:Math.asin(t)}function vx(t){return t.innerRadius}function xx(t){return t.outerRadius}function wx(t){return t.startAngle}function Mx(t){return t.endAngle}function kx(t){return t&&t.padAngle}function Ex(t,e,n,r,i,a,o,s){var u=n-t,l=r-e,c=o-i,h=s-a,f=h*u-c*l;if(!(f*f<1e-12))return[t+(f=(c*(e-a)-h*(t-i))/f)*u,e+f*l]}function Sx(t,e,n,r,i,a,o){var s=t-n,u=e-r,l=(o?a:-a)/px(s*s+u*u),c=l*u,h=-l*s,f=t+c,d=e+h,p=n+c,_=r+h,g=(f+p)/2,y=(d+_)/2,m=p-f,b=_-d,v=m*m+b*b,x=i-a,w=f*_-p*d,M=(b<0?-1:1)*px(hx(0,x*x*v-w*w)),k=(w*b-m*M)/v,E=(-w*m-b*M)/v,S=(w*b+m*M)/v,z=(-w*m+b*M)/v,N=k-g,T=E-y,A=S-g,C=z-y;return N*N+T*T>A*A+C*C&&(k=S,E=z),{cx:k,cy:E,x01:-c,y01:-h,x11:k*(i/x-1),y11:E*(i/x-1)}}var zx=function(){var t=vx,e=xx,n=sx(0),r=null,i=wx,a=Mx,o=kx,s=null;function u(){var u,l,c=+t.apply(this,arguments),h=+e.apply(this,arguments),f=i.apply(this,arguments)-gx,d=a.apply(this,arguments)-gx,p=ux(d-f),_=d>f;if(s||(s=u=Ca()),h<c&&(l=h,h=c,c=l),h>1e-12)if(p>yx-1e-12)s.moveTo(h*cx(f),h*dx(f)),s.arc(0,0,h,f,d,!_),c>1e-12&&(s.moveTo(c*cx(d),c*dx(d)),s.arc(0,0,c,d,f,_));else{var g,y,m=f,b=d,v=f,x=d,w=p,M=p,k=o.apply(this,arguments)/2,E=k>1e-12&&(r?+r.apply(this,arguments):px(c*c+h*h)),S=fx(ux(h-c)/2,+n.apply(this,arguments)),z=S,N=S;if(E>1e-12){var T=bx(E/c*dx(k)),A=bx(E/h*dx(k));(w-=2*T)>1e-12?(v+=T*=_?1:-1,x-=T):(w=0,v=x=(f+d)/2),(M-=2*A)>1e-12?(m+=A*=_?1:-1,b-=A):(M=0,m=b=(f+d)/2)}var C=h*cx(m),P=h*dx(m),R=c*cx(x),O=c*dx(x);if(S>1e-12){var L,D=h*cx(b),j=h*dx(b),$=c*cx(v),I=c*dx(v);if(p<_x&&(L=Ex(C,P,$,I,D,j,R,O))){var B=C-L[0],U=P-L[1],q=D-L[0],F=j-L[1],Y=1/dx(mx((B*q+U*F)/(px(B*B+U*U)*px(q*q+F*F)))/2),H=px(L[0]*L[0]+L[1]*L[1]);z=fx(S,(c-H)/(Y-1)),N=fx(S,(h-H)/(Y+1))}}M>1e-12?N>1e-12?(g=Sx($,I,C,P,h,N,_),y=Sx(D,j,R,O,h,N,_),s.moveTo(g.cx+g.x01,g.cy+g.y01),N<S?s.arc(g.cx,g.cy,N,lx(g.y01,g.x01),lx(y.y01,y.x01),!_):(s.arc(g.cx,g.cy,N,lx(g.y01,g.x01),lx(g.y11,g.x11),!_),s.arc(0,0,h,lx(g.cy+g.y11,g.cx+g.x11),lx(y.cy+y.y11,y.cx+y.x11),!_),s.arc(y.cx,y.cy,N,lx(y.y11,y.x11),lx(y.y01,y.x01),!_))):(s.moveTo(C,P),s.arc(0,0,h,m,b,!_)):s.moveTo(C,P),c>1e-12&&w>1e-12?z>1e-12?(g=Sx(R,O,D,j,c,-z,_),y=Sx(C,P,$,I,c,-z,_),s.lineTo(g.cx+g.x01,g.cy+g.y01),z<S?s.arc(g.cx,g.cy,z,lx(g.y01,g.x01),lx(y.y01,y.x01),!_):(s.arc(g.cx,g.cy,z,lx(g.y01,g.x01),lx(g.y11,g.x11),!_),s.arc(0,0,c,lx(g.cy+g.y11,g.cx+g.x11),lx(y.cy+y.y11,y.cx+y.x11),_),s.arc(y.cx,y.cy,z,lx(y.y11,y.x11),lx(y.y01,y.x01),!_))):s.arc(0,0,c,x,v,_):s.lineTo(R,O)}else s.moveTo(0,0);if(s.closePath(),u)return s=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +a.apply(this,arguments))/2-_x/2;return[cx(r)*n,dx(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:sx(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:sx(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:sx(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:sx(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:sx(+t),u):i},u.endAngle=function(t){return arguments.length?(a="function"==typeof t?t:sx(+t),u):a},u.padAngle=function(t){return arguments.length?(o="function"==typeof t?t:sx(+t),u):o},u.context=function(t){return arguments.length?(s=null==t?null:t,u):s},u};function Nx(t){this._context=t}Nx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Tx=function(t){return new Nx(t)};function Ax(t){return t[0]}function Cx(t){return t[1]}var Px=function(){var t=Ax,e=Cx,n=sx(!0),r=null,i=Tx,a=null;function o(o){var s,u,l,c=o.length,h=!1;for(null==r&&(a=i(l=Ca())),s=0;s<=c;++s)!(s<c&&n(u=o[s],s,o))===h&&((h=!h)?a.lineStart():a.lineEnd()),h&&a.point(+t(u,s,o),+e(u,s,o));if(l)return a=null,l+""||null}return o.x=function(e){return arguments.length?(t="function"==typeof e?e:sx(+e),o):t},o.y=function(t){return arguments.length?(e="function"==typeof t?t:sx(+t),o):e},o.defined=function(t){return arguments.length?(n="function"==typeof t?t:sx(!!t),o):n},o.curve=function(t){return arguments.length?(i=t,null!=r&&(a=i(r)),o):i},o.context=function(t){return arguments.length?(null==t?r=a=null:a=i(r=t),o):r},o},Rx=function(){var t=Ax,e=null,n=sx(0),r=Cx,i=sx(!0),a=null,o=Tx,s=null;function u(u){var l,c,h,f,d,p=u.length,_=!1,g=new Array(p),y=new Array(p);for(null==a&&(s=o(d=Ca())),l=0;l<=p;++l){if(!(l<p&&i(f=u[l],l,u))===_)if(_=!_)c=l,s.areaStart(),s.lineStart();else{for(s.lineEnd(),s.lineStart(),h=l-1;h>=c;--h)s.point(g[h],y[h]);s.lineEnd(),s.areaEnd()}_&&(g[l]=+t(f,l,u),y[l]=+n(f,l,u),s.point(e?+e(f,l,u):g[l],r?+r(f,l,u):y[l]))}if(d)return s=null,d+""||null}function l(){return Px().defined(i).curve(o).context(a)}return u.x=function(n){return arguments.length?(t="function"==typeof n?n:sx(+n),e=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:sx(+e),u):t},u.x1=function(t){return arguments.length?(e=null==t?null:"function"==typeof t?t:sx(+t),u):e},u.y=function(t){return arguments.length?(n="function"==typeof t?t:sx(+t),r=null,u):n},u.y0=function(t){return arguments.length?(n="function"==typeof t?t:sx(+t),u):n},u.y1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:sx(+t),u):r},u.lineX0=u.lineY0=function(){return l().x(t).y(n)},u.lineY1=function(){return l().x(t).y(r)},u.lineX1=function(){return l().x(e).y(n)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:sx(!!t),u):i},u.curve=function(t){return arguments.length?(o=t,null!=a&&(s=o(a)),u):o},u.context=function(t){return arguments.length?(null==t?a=s=null:s=o(a=t),u):a},u},Ox=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},Lx=function(t){return t},Dx=function(){var t=Lx,e=Ox,n=null,r=sx(0),i=sx(yx),a=sx(0);function o(o){var s,u,l,c,h,f=o.length,d=0,p=new Array(f),_=new Array(f),g=+r.apply(this,arguments),y=Math.min(yx,Math.max(-yx,i.apply(this,arguments)-g)),m=Math.min(Math.abs(y)/f,a.apply(this,arguments)),b=m*(y<0?-1:1);for(s=0;s<f;++s)(h=_[p[s]=s]=+t(o[s],s,o))>0&&(d+=h);for(null!=e?p.sort((function(t,n){return e(_[t],_[n])})):null!=n&&p.sort((function(t,e){return n(o[t],o[e])})),s=0,l=d?(y-f*b)/d:0;s<f;++s,g=c)u=p[s],c=g+((h=_[u])>0?h*l:0)+b,_[u]={data:o[u],index:s,value:h,startAngle:g,endAngle:c,padAngle:m};return _}return o.value=function(e){return arguments.length?(t="function"==typeof e?e:sx(+e),o):t},o.sortValues=function(t){return arguments.length?(e=t,n=null,o):e},o.sort=function(t){return arguments.length?(n=t,e=null,o):n},o.startAngle=function(t){return arguments.length?(r="function"==typeof t?t:sx(+t),o):r},o.endAngle=function(t){return arguments.length?(i="function"==typeof t?t:sx(+t),o):i},o.padAngle=function(t){return arguments.length?(a="function"==typeof t?t:sx(+t),o):a},o},jx=Ix(Tx);function $x(t){this._curve=t}function Ix(t){function e(e){return new $x(t(e))}return e._curve=t,e}function Bx(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(Ix(t)):e()._curve},t}$x.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};var Ux=function(){return Bx(Px().curve(jx))},qx=function(){var t=Rx().curve(jx),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,a=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Bx(n())},delete t.lineX0,t.lineEndAngle=function(){return Bx(r())},delete t.lineX1,t.lineInnerRadius=function(){return Bx(i())},delete t.lineY0,t.lineOuterRadius=function(){return Bx(a())},delete t.lineY1,t.curve=function(t){return arguments.length?e(Ix(t)):e()._curve},t},Fx=function(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]},Yx=Array.prototype.slice;function Hx(t){return t.source}function Gx(t){return t.target}function Vx(t){var e=Hx,n=Gx,r=Ax,i=Cx,a=null;function o(){var o,s=Yx.call(arguments),u=e.apply(this,s),l=n.apply(this,s);if(a||(a=o=Ca()),t(a,+r.apply(this,(s[0]=u,s)),+i.apply(this,s),+r.apply(this,(s[0]=l,s)),+i.apply(this,s)),o)return a=null,o+""||null}return o.source=function(t){return arguments.length?(e=t,o):e},o.target=function(t){return arguments.length?(n=t,o):n},o.x=function(t){return arguments.length?(r="function"==typeof t?t:sx(+t),o):r},o.y=function(t){return arguments.length?(i="function"==typeof t?t:sx(+t),o):i},o.context=function(t){return arguments.length?(a=null==t?null:t,o):a},o}function Xx(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,i,r,i)}function Zx(t,e,n,r,i){t.moveTo(e,n),t.bezierCurveTo(e,n=(n+i)/2,r,n,r,i)}function Wx(t,e,n,r,i){var a=Fx(e,n),o=Fx(e,n=(n+i)/2),s=Fx(r,n),u=Fx(r,i);t.moveTo(a[0],a[1]),t.bezierCurveTo(o[0],o[1],s[0],s[1],u[0],u[1])}function Jx(){return Vx(Xx)}function Kx(){return Vx(Zx)}function Qx(){var t=Vx(Wx);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}var tw={draw:function(t,e){var n=Math.sqrt(e/_x);t.moveTo(n,0),t.arc(0,0,n,0,yx)}},ew={draw:function(t,e){var n=Math.sqrt(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},nw=Math.sqrt(1/3),rw=2*nw,iw={draw:function(t,e){var n=Math.sqrt(e/rw),r=n*nw;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},aw=Math.sin(_x/10)/Math.sin(7*_x/10),ow=Math.sin(yx/10)*aw,sw=-Math.cos(yx/10)*aw,uw={draw:function(t,e){var n=Math.sqrt(.8908130915292852*e),r=ow*n,i=sw*n;t.moveTo(0,-n),t.lineTo(r,i);for(var a=1;a<5;++a){var o=yx*a/5,s=Math.cos(o),u=Math.sin(o);t.lineTo(u*n,-s*n),t.lineTo(s*r-u*i,u*r+s*i)}t.closePath()}},lw={draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},cw=Math.sqrt(3),hw={draw:function(t,e){var n=-Math.sqrt(e/(3*cw));t.moveTo(0,2*n),t.lineTo(-cw*n,-n),t.lineTo(cw*n,-n),t.closePath()}},fw=Math.sqrt(3)/2,dw=1/Math.sqrt(12),pw=3*(dw/2+1),_w={draw:function(t,e){var n=Math.sqrt(e/pw),r=n/2,i=n*dw,a=r,o=n*dw+n,s=-a,u=o;t.moveTo(r,i),t.lineTo(a,o),t.lineTo(s,u),t.lineTo(-.5*r-fw*i,fw*r+-.5*i),t.lineTo(-.5*a-fw*o,fw*a+-.5*o),t.lineTo(-.5*s-fw*u,fw*s+-.5*u),t.lineTo(-.5*r+fw*i,-.5*i-fw*r),t.lineTo(-.5*a+fw*o,-.5*o-fw*a),t.lineTo(-.5*s+fw*u,-.5*u-fw*s),t.closePath()}},gw=[tw,ew,iw,lw,uw,hw,_w],yw=function(){var t=sx(tw),e=sx(64),n=null;function r(){var r;if(n||(n=r=Ca()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),r)return n=null,r+""||null}return r.type=function(e){return arguments.length?(t="function"==typeof e?e:sx(e),r):t},r.size=function(t){return arguments.length?(e="function"==typeof t?t:sx(+t),r):e},r.context=function(t){return arguments.length?(n=null==t?null:t,r):n},r},mw=function(){};function bw(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function vw(t){this._context=t}vw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:bw(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:bw(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var xw=function(t){return new vw(t)};function ww(t){this._context=t}ww.prototype={areaStart:mw,areaEnd:mw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:bw(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Mw=function(t){return new ww(t)};function kw(t){this._context=t}kw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:bw(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};var Ew=function(t){return new kw(t)};function Sw(t,e){this._basis=new vw(t),this._beta=e}Sw.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],a=e[0],o=t[n]-i,s=e[n]-a,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(i+r*o),this._beta*e[u]+(1-this._beta)*(a+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var zw=function t(e){function n(t){return 1===e?new vw(t):new Sw(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function Nw(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Tw(t,e){this._context=t,this._k=(1-e)/6}Tw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Nw(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Nw(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Aw=function t(e){function n(t){return new Tw(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Cw(t,e){this._context=t,this._k=(1-e)/6}Cw.prototype={areaStart:mw,areaEnd:mw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Nw(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Pw=function t(e){function n(t){return new Cw(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Rw(t,e){this._context=t,this._k=(1-e)/6}Rw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Nw(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ow=function t(e){function n(t){return new Rw(t,e)}return n.tension=function(e){return t(+e)},n}(0);function Lw(t,e,n){var r=t._x1,i=t._y1,a=t._x2,o=t._y2;if(t._l01_a>1e-12){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,i=(i*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>1e-12){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/c,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,a,o,t._x2,t._y2)}function Dw(t,e){this._context=t,this._alpha=e}Dw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Lw(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var jw=function t(e){function n(t){return e?new Dw(t,e):new Tw(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function $w(t,e){this._context=t,this._alpha=e}$w.prototype={areaStart:mw,areaEnd:mw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Lw(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Iw=function t(e){function n(t){return e?new $w(t,e):new Cw(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function Bw(t,e){this._context=t,this._alpha=e}Bw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Lw(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Uw=function t(e){function n(t){return e?new Bw(t,e):new Rw(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function qw(t){this._context=t}qw.prototype={areaStart:mw,areaEnd:mw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};var Fw=function(t){return new qw(t)};function Yw(t){return t<0?-1:1}function Hw(t,e,n){var r=t._x1-t._x0,i=e-t._x1,a=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),s=(a*i+o*r)/(r+i);return(Yw(a)+Yw(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function Gw(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Vw(t,e,n){var r=t._x0,i=t._y0,a=t._x1,o=t._y1,s=(a-r)/3;t._context.bezierCurveTo(r+s,i+s*e,a-s,o-s*n,a,o)}function Xw(t){this._context=t}function Zw(t){this._context=new Ww(t)}function Ww(t){this._context=t}function Jw(t){return new Xw(t)}function Kw(t){return new Zw(t)}function Qw(t){this._context=t}function tM(t){var e,n,r=t.length-1,i=new Array(r),a=new Array(r),o=new Array(r);for(i[0]=0,a[0]=2,o[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,a[r-1]=7,o[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(i[r-1]=o[r-1]/a[r-1],e=r-2;e>=0;--e)i[e]=(o[e]-i[e+1])/a[e];for(a[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)a[e]=2*t[e+1]-i[e+1];return[i,a]}Xw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Vw(this,this._t0,Gw(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Vw(this,Gw(this,n=Hw(this,t,e)),n);break;default:Vw(this,this._t0,n=Hw(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(Zw.prototype=Object.create(Xw.prototype)).point=function(t,e){Xw.prototype.point.call(this,e,t)},Ww.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,a){this._context.bezierCurveTo(e,t,r,n,a,i)}},Qw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=tM(t),i=tM(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(r[0][a],i[0][a],r[1][a],i[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var eM=function(t){return new Qw(t)};function nM(t,e){this._context=t,this._t=e}nM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var rM=function(t){return new nM(t,.5)};function iM(t){return new nM(t,0)}function aM(t){return new nM(t,1)}var oM=function(t,e){if((i=t.length)>1)for(var n,r,i,a=1,o=t[e[0]],s=o.length;a<i;++a)for(r=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]},sM=function(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n};function uM(t,e){return t[e]}var lM=function(){var t=sx([]),e=sM,n=oM,r=uM;function i(i){var a,o,s=t.apply(this,arguments),u=i.length,l=s.length,c=new Array(l);for(a=0;a<l;++a){for(var h,f=s[a],d=c[a]=new Array(u),p=0;p<u;++p)d[p]=h=[0,+r(i[p],f,p,i)],h.data=i[p];d.key=f}for(a=0,o=e(c);a<l;++a)c[o[a]].index=a;return n(c,o),c}return i.keys=function(e){return arguments.length?(t="function"==typeof e?e:sx(Yx.call(e)),i):t},i.value=function(t){return arguments.length?(r="function"==typeof t?t:sx(+t),i):r},i.order=function(t){return arguments.length?(e=null==t?sM:"function"==typeof t?t:sx(Yx.call(t)),i):e},i.offset=function(t){return arguments.length?(n=null==t?oM:t,i):n},i},cM=function(t,e){if((r=t.length)>0){for(var n,r,i,a=0,o=t[0].length;a<o;++a){for(i=n=0;n<r;++n)i+=t[n][a][1]||0;if(i)for(n=0;n<r;++n)t[n][a][1]/=i}oM(t,e)}},hM=function(t,e){if((s=t.length)>0)for(var n,r,i,a,o,s,u=0,l=t[e[0]].length;u<l;++u)for(a=o=0,n=0;n<s;++n)(i=(r=t[e[n]][u])[1]-r[0])>0?(r[0]=a,r[1]=a+=i):i<0?(r[1]=o,r[0]=o+=i):(r[0]=0,r[1]=i)},fM=function(t,e){if((n=t.length)>0){for(var n,r=0,i=t[e[0]],a=i.length;r<a;++r){for(var o=0,s=0;o<n;++o)s+=t[o][r][1]||0;i[r][1]+=i[r][0]=-s/2}oM(t,e)}},dM=function(t,e){if((i=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,i,a=0,o=1;o<r;++o){for(var s=0,u=0,l=0;s<i;++s){for(var c=t[e[s]],h=c[o][1]||0,f=(h-(c[o-1][1]||0))/2,d=0;d<s;++d){var p=t[e[d]];f+=(p[o][1]||0)-(p[o-1][1]||0)}u+=h,l+=f*h}n[o-1][1]+=n[o-1][0]=a,u&&(a-=l/u)}n[o-1][1]+=n[o-1][0]=a,oM(t,e)}},pM=function(t){var e=t.map(_M);return sM(t).sort((function(t,n){return e[t]-e[n]}))};function _M(t){for(var e,n=-1,r=0,i=t.length,a=-1/0;++n<i;)(e=+t[n][1])>a&&(a=e,r=n);return r}var gM=function(t){var e=t.map(yM);return sM(t).sort((function(t,n){return e[t]-e[n]}))};function yM(t){for(var e,n=0,r=-1,i=t.length;++r<i;)(e=+t[r][1])&&(n+=e);return n}var mM=function(t){return gM(t).reverse()},bM=function(t){var e,n,r=t.length,i=t.map(yM),a=pM(t),o=0,s=0,u=[],l=[];for(e=0;e<r;++e)n=a[e],o<s?(o+=i[n],u.push(n)):(s+=i[n],l.push(n));return l.reverse().concat(u)},vM=function(t){return sM(t).reverse()};var xM=Date.prototype.toISOString?function(t){return t.toISOString()}:Ry("%Y-%m-%dT%H:%M:%S.%LZ");var wM=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:Oy("%Y-%m-%dT%H:%M:%S.%LZ"),MM=function(t,e,n){var r=new Pr,i=e;return null==e?(r.restart(t,e,n),r):(e=+e,n=null==n?Ar():+n,r.restart((function a(o){o+=i,r.restart(a,i+=e,n),t(o)}),e,n),r)},kM=function(t){return function(){return t}};function EM(t){return t[0]}function SM(t){return t[1]}function zM(){this._=null}function NM(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function TM(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function AM(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function CM(t){for(;t.L;)t=t.L;return t}zM.prototype={constructor:zM,insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=CM(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(r=n.U).L?(i=r.R)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(TM(this,n),n=(t=n).U),n.C=!1,r.C=!0,AM(this,r)):(i=r.L)&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(AM(this,n),n=(t=n).U),n.C=!1,r.C=!0,TM(this,r)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,a=t.L,o=t.R;if(n=a?o?CM(o):a:o,i?i.L===t?i.L=n:i.R=n:this._=n,a&&o?(r=n.C,n.C=t.C,n.L=a,a.U=n,n!==o?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=o,o.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===i.L){if((e=i.R).C&&(e.C=!1,i.C=!0,TM(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,AM(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,TM(this,i),t=this._;break}}else if((e=i.L).C&&(e.C=!1,i.C=!0,AM(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,TM(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,AM(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}};var PM=zM;function RM(t,e,n,r){var i=[null,null],a=rk.push(i)-1;return i.left=t,i.right=e,n&&LM(i,t,e,n),r&&LM(i,e,t,r),ek[t.index].halfedges.push(a),ek[e.index].halfedges.push(a),i}function OM(t,e,n){var r=[e,n];return r.left=t,r}function LM(t,e,n,r){t[0]||t[1]?t.left===n?t[1]=r:t[0]=r:(t[0]=r,t.left=e,t.right=n)}function DM(t,e,n,r,i){var a,o=t[0],s=t[1],u=o[0],l=o[1],c=0,h=1,f=s[0]-u,d=s[1]-l;if(a=e-u,f||!(a>0)){if(a/=f,f<0){if(a<c)return;a<h&&(h=a)}else if(f>0){if(a>h)return;a>c&&(c=a)}if(a=r-u,f||!(a<0)){if(a/=f,f<0){if(a>h)return;a>c&&(c=a)}else if(f>0){if(a<c)return;a<h&&(h=a)}if(a=n-l,d||!(a>0)){if(a/=d,d<0){if(a<c)return;a<h&&(h=a)}else if(d>0){if(a>h)return;a>c&&(c=a)}if(a=i-l,d||!(a<0)){if(a/=d,d<0){if(a>h)return;a>c&&(c=a)}else if(d>0){if(a<c)return;a<h&&(h=a)}return!(c>0||h<1)||(c>0&&(t[0]=[u+c*f,l+c*d]),h<1&&(t[1]=[u+h*f,l+h*d]),!0)}}}}}function jM(t,e,n,r,i){var a=t[1];if(a)return!0;var o,s,u=t[0],l=t.left,c=t.right,h=l[0],f=l[1],d=c[0],p=c[1],_=(h+d)/2,g=(f+p)/2;if(p===f){if(_<e||_>=r)return;if(h>d){if(u){if(u[1]>=i)return}else u=[_,n];a=[_,i]}else{if(u){if(u[1]<n)return}else u=[_,i];a=[_,n]}}else if(s=g-(o=(h-d)/(p-f))*_,o<-1||o>1)if(h>d){if(u){if(u[1]>=i)return}else u=[(n-s)/o,n];a=[(i-s)/o,i]}else{if(u){if(u[1]<n)return}else u=[(i-s)/o,i];a=[(n-s)/o,n]}else if(f<p){if(u){if(u[0]>=r)return}else u=[e,o*e+s];a=[r,o*r+s]}else{if(u){if(u[0]<e)return}else u=[r,o*r+s];a=[e,o*e+s]}return t[0]=u,t[1]=a,!0}function $M(t,e){var n=t.site,r=e.left,i=e.right;return n===i&&(i=r,r=n),i?Math.atan2(i[1]-r[1],i[0]-r[0]):(n===r?(r=e[1],i=e[0]):(r=e[0],i=e[1]),Math.atan2(r[0]-i[0],i[1]-r[1]))}function IM(t,e){return e[+(e.left!==t.site)]}function BM(t,e){return e[+(e.left===t.site)]}var UM,qM=[];function FM(){NM(this),this.x=this.y=this.arc=this.site=this.cy=null}function YM(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,a=n.site;if(r!==a){var o=i[0],s=i[1],u=r[0]-o,l=r[1]-s,c=a[0]-o,h=a[1]-s,f=2*(u*h-l*c);if(!(f>=-ak)){var d=u*u+l*l,p=c*c+h*h,_=(h*d-l*p)/f,g=(u*p-c*d)/f,y=qM.pop()||new FM;y.arc=t,y.site=i,y.x=_+o,y.y=(y.cy=g+s)+Math.sqrt(_*_+g*g),t.circle=y;for(var m=null,b=nk._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){m=b.P;break}b=b.L}else{if(!b.R){m=b;break}b=b.R}nk.insert(m,y),m||(UM=y)}}}}function HM(t){var e=t.circle;e&&(e.P||(UM=e.N),nk.remove(e),qM.push(e),NM(e),t.circle=null)}var GM=[];function VM(){NM(this),this.edge=this.site=this.circle=null}function XM(t){var e=GM.pop()||new VM;return e.site=t,e}function ZM(t){HM(t),tk.remove(t),GM.push(t),NM(t)}function WM(t){var e=t.circle,n=e.x,r=e.cy,i=[n,r],a=t.P,o=t.N,s=[t];ZM(t);for(var u=a;u.circle&&Math.abs(n-u.circle.x)<ik&&Math.abs(r-u.circle.cy)<ik;)a=u.P,s.unshift(u),ZM(u),u=a;s.unshift(u),HM(u);for(var l=o;l.circle&&Math.abs(n-l.circle.x)<ik&&Math.abs(r-l.circle.cy)<ik;)o=l.N,s.push(l),ZM(l),l=o;s.push(l),HM(l);var c,h=s.length;for(c=1;c<h;++c)l=s[c],u=s[c-1],LM(l.edge,u.site,l.site,i);u=s[0],(l=s[h-1]).edge=RM(u.site,l.site,null,i),YM(u),YM(l)}function JM(t){for(var e,n,r,i,a=t[0],o=t[1],s=tk._;s;)if((r=KM(s,o)-a)>ik)s=s.L;else{if(!((i=a-QM(s,o))>ik)){r>-ik?(e=s.P,n=s):i>-ik?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}!function(t){ek[t.index]={site:t,halfedges:[]}}(t);var u=XM(t);if(tk.insert(e,u),e||n){if(e===n)return HM(e),n=XM(e.site),tk.insert(u,n),u.edge=n.edge=RM(e.site,u.site),YM(e),void YM(n);if(n){HM(e),HM(n);var l=e.site,c=l[0],h=l[1],f=t[0]-c,d=t[1]-h,p=n.site,_=p[0]-c,g=p[1]-h,y=2*(f*g-d*_),m=f*f+d*d,b=_*_+g*g,v=[(g*m-d*b)/y+c,(f*b-_*m)/y+h];LM(n.edge,l,p,v),u.edge=RM(l,t,null,v),n.edge=RM(t,p,null,v),YM(e),YM(n)}else u.edge=RM(e.site,u.site)}}function KM(t,e){var n=t.site,r=n[0],i=n[1],a=i-e;if(!a)return r;var o=t.P;if(!o)return-1/0;var s=(n=o.site)[0],u=n[1],l=u-e;if(!l)return s;var c=s-r,h=1/a-1/l,f=c/l;return h?(-f+Math.sqrt(f*f-2*h*(c*c/(-2*l)-u+l/2+i-a/2)))/h+r:(r+s)/2}function QM(t,e){var n=t.N;if(n)return KM(n,e);var r=t.site;return r[1]===e?r[0]:1/0}var tk,ek,nk,rk,ik=1e-6,ak=1e-12;function ok(t,e){return e[1]-t[1]||e[0]-t[0]}function sk(t,e){var n,r,i,a=t.sort(ok).pop();for(rk=[],ek=new Array(t.length),tk=new PM,nk=new PM;;)if(i=UM,a&&(!i||a[1]<i.y||a[1]===i.y&&a[0]<i.x))a[0]===n&&a[1]===r||(JM(a),n=a[0],r=a[1]),a=t.pop();else{if(!i)break;WM(i.arc)}if(function(){for(var t,e,n,r,i=0,a=ek.length;i<a;++i)if((t=ek[i])&&(r=(e=t.halfedges).length)){var o=new Array(r),s=new Array(r);for(n=0;n<r;++n)o[n]=n,s[n]=$M(t,rk[e[n]]);for(o.sort((function(t,e){return s[e]-s[t]})),n=0;n<r;++n)s[n]=e[o[n]];for(n=0;n<r;++n)e[n]=s[n]}}(),e){var o=+e[0][0],s=+e[0][1],u=+e[1][0],l=+e[1][1];!function(t,e,n,r){for(var i,a=rk.length;a--;)jM(i=rk[a],t,e,n,r)&&DM(i,t,e,n,r)&&(Math.abs(i[0][0]-i[1][0])>ik||Math.abs(i[0][1]-i[1][1])>ik)||delete rk[a]}(o,s,u,l),function(t,e,n,r){var i,a,o,s,u,l,c,h,f,d,p,_,g=ek.length,y=!0;for(i=0;i<g;++i)if(a=ek[i]){for(o=a.site,s=(u=a.halfedges).length;s--;)rk[u[s]]||u.splice(s,1);for(s=0,l=u.length;s<l;)p=(d=BM(a,rk[u[s]]))[0],_=d[1],h=(c=IM(a,rk[u[++s%l]]))[0],f=c[1],(Math.abs(p-h)>ik||Math.abs(_-f)>ik)&&(u.splice(s,0,rk.push(OM(o,d,Math.abs(p-t)<ik&&r-_>ik?[t,Math.abs(h-t)<ik?f:r]:Math.abs(_-r)<ik&&n-p>ik?[Math.abs(f-r)<ik?h:n,r]:Math.abs(p-n)<ik&&_-e>ik?[n,Math.abs(h-n)<ik?f:e]:Math.abs(_-e)<ik&&p-t>ik?[Math.abs(f-e)<ik?h:t,e]:null))-1),++l);l&&(y=!1)}if(y){var m,b,v,x=1/0;for(i=0,y=null;i<g;++i)(a=ek[i])&&(v=(m=(o=a.site)[0]-t)*m+(b=o[1]-e)*b)<x&&(x=v,y=a);if(y){var w=[t,e],M=[t,r],k=[n,r],E=[n,e];y.halfedges.push(rk.push(OM(o=y.site,w,M))-1,rk.push(OM(o,M,k))-1,rk.push(OM(o,k,E))-1,rk.push(OM(o,E,w))-1)}}for(i=0;i<g;++i)(a=ek[i])&&(a.halfedges.length||delete ek[i])}(o,s,u,l)}this.edges=rk,this.cells=ek,tk=nk=rk=ek=null}sk.prototype={constructor:sk,polygons:function(){var t=this.edges;return this.cells.map((function(e){var n=e.halfedges.map((function(n){return IM(e,t[n])}));return n.data=e.site.data,n}))},triangles:function(){var t=[],e=this.edges;return this.cells.forEach((function(n,r){if(a=(i=n.halfedges).length)for(var i,a,o,s,u,l,c=n.site,h=-1,f=e[i[a-1]],d=f.left===c?f.right:f.left;++h<a;)o=d,d=(f=e[i[h]]).left===c?f.right:f.left,o&&d&&r<o.index&&r<d.index&&(u=o,l=d,((s=c)[0]-l[0])*(u[1]-s[1])-(s[0]-u[0])*(l[1]-s[1])<0)&&t.push([c.data,o.data,d.data])})),t},links:function(){return this.edges.filter((function(t){return t.right})).map((function(t){return{source:t.left.data,target:t.right.data}}))},find:function(t,e,n){for(var r,i,a=this,o=a._found||0,s=a.cells.length;!(i=a.cells[o]);)if(++o>=s)return null;var u=t-i.site[0],l=e-i.site[1],c=u*u+l*l;do{i=a.cells[r=o],o=null,i.halfedges.forEach((function(n){var r=a.edges[n],s=r.left;if(s!==i.site&&s||(s=r.right)){var u=t-s[0],l=e-s[1],h=u*u+l*l;h<c&&(c=h,o=s.index)}}))}while(null!==o);return a._found=r,null==n||c<=n*n?i.site:null}};var uk=function(){var t=EM,e=SM,n=null;function r(r){return new sk(r.map((function(n,i){var a=[Math.round(t(n,i,r)/ik)*ik,Math.round(e(n,i,r)/ik)*ik];return a.index=i,a.data=n,a})),n)}return r.polygons=function(t){return r(t).polygons()},r.links=function(t){return r(t).links()},r.triangles=function(t){return r(t).triangles()},r.x=function(e){return arguments.length?(t="function"==typeof e?e:kM(+e),r):t},r.y=function(t){return arguments.length?(e="function"==typeof t?t:kM(+t),r):e},r.extent=function(t){return arguments.length?(n=null==t?null:[[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]],r):n&&[[n[0][0],n[0][1]],[n[1][0],n[1][1]]]},r.size=function(t){return arguments.length?(n=null==t?null:[[0,0],[+t[0],+t[1]]],r):n&&[n[1][0]-n[0][0],n[1][1]-n[0][1]]},r},lk=function(t){return function(){return t}};function ck(t,e,n){this.target=t,this.type=e,this.transform=n}function hk(t,e,n){this.k=t,this.x=e,this.y=n}hk.prototype={constructor:hk,scale:function(t){return 1===t?this:new hk(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new hk(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var fk=new hk(1,0,0);function dk(t){for(;!t.__zoom;)if(!(t=t.parentNode))return fk;return t.__zoom}function pk(){Je.stopImmediatePropagation()}dk.prototype=hk.prototype;var _k=function(){Je.preventDefault(),Je.stopImmediatePropagation()};function gk(){return!Je.ctrlKey&&!Je.button}function yk(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function mk(){return this.__zoom||fk}function bk(){return-Je.deltaY*(1===Je.deltaMode?.05:Je.deltaMode?1:.002)}function vk(){return navigator.maxTouchPoints||"ontouchstart"in this}function xk(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>a?(a+o)/2:Math.min(0,a)||Math.max(0,o))}var wk=function(){var t,e,n=gk,r=yk,i=xk,a=bk,o=vk,s=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],l=250,c=e_,h=Qt("start","zoom","end"),f=0;function d(t){t.property("__zoom",mk).on("wheel.zoom",v).on("mousedown.zoom",x).on("dblclick.zoom",w).filter(o).on("touchstart.zoom",M).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new hk(e,t.x,t.y)}function _(t,e,n){var r=e[0]-n[0]*t.k,i=e[1]-n[1]*t.k;return r===t.x&&i===t.y?t:new hk(t.k,r,i)}function g(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function y(t,e,n){t.on("start.zoom",(function(){m(this,arguments).start()})).on("interrupt.zoom end.zoom",(function(){m(this,arguments).end()})).tween("zoom",(function(){var t=this,i=arguments,a=m(t,i),o=r.apply(t,i),s=null==n?g(o):"function"==typeof n?n.apply(t,i):n,u=Math.max(o[1][0]-o[0][0],o[1][1]-o[0][1]),l=t.__zoom,h="function"==typeof e?e.apply(t,i):e,f=c(l.invert(s).concat(u/l.k),h.invert(s).concat(u/h.k));return function(t){if(1===t)t=h;else{var e=f(t),n=u/e[2];t=new hk(n,s[0]-e[0]*n,s[1]-e[1]*n)}a.zoom(null,t)}}))}function m(t,e,n){return!n&&t.__zooming||new b(t,e)}function b(t,e){this.that=t,this.args=e,this.active=0,this.extent=r.apply(t,e),this.taps=0}function v(){if(n.apply(this,arguments)){var t=m(this,arguments),e=this.__zoom,r=Math.max(s[0],Math.min(s[1],e.k*Math.pow(2,a.apply(this,arguments)))),o=xr(this);if(t.wheel)t.mouse[0][0]===o[0]&&t.mouse[0][1]===o[1]||(t.mouse[1]=e.invert(t.mouse[0]=o)),clearTimeout(t.wheel);else{if(e.k===r)return;t.mouse=[o,e.invert(o)],Zr(this),t.start()}_k(),t.wheel=setTimeout(l,150),t.zoom("mouse",i(_(p(e,r),t.mouse[0],t.mouse[1]),t.extent,u))}function l(){t.wheel=null,t.end()}}function x(){if(!e&&n.apply(this,arguments)){var t=m(this,arguments,!0),r=fn(Je.view).on("mousemove.zoom",l,!0).on("mouseup.zoom",c,!0),a=xr(this),o=Je.clientX,s=Je.clientY;_n(Je.view),pk(),t.mouse=[a,this.__zoom.invert(a)],Zr(this),t.start()}function l(){if(_k(),!t.moved){var e=Je.clientX-o,n=Je.clientY-s;t.moved=e*e+n*n>f}t.zoom("mouse",i(_(t.that.__zoom,t.mouse[0]=xr(t.that),t.mouse[1]),t.extent,u))}function c(){r.on("mousemove.zoom mouseup.zoom",null),gn(Je.view,t.moved),_k(),t.end()}}function w(){if(n.apply(this,arguments)){var t=this.__zoom,e=xr(this),a=t.invert(e),o=t.k*(Je.shiftKey?.5:2),s=i(_(p(t,o),e,a),r.apply(this,arguments),u);_k(),l>0?fn(this).transition().duration(l).call(y,s,e):fn(this).call(d.transform,s)}}function M(){if(n.apply(this,arguments)){var e,r,i,a,o=Je.touches,s=o.length,u=m(this,arguments,Je.changedTouches.length===s);for(pk(),r=0;r<s;++r)i=o[r],a=[a=vr(this,o,i.identifier),this.__zoom.invert(a),i.identifier],u.touch0?u.touch1||u.touch0[2]===a[2]||(u.touch1=a,u.taps=0):(u.touch0=a,e=!0,u.taps=1+!!t);t&&(t=clearTimeout(t)),e&&(u.taps<2&&(t=setTimeout((function(){t=null}),500)),Zr(this),u.start())}}function k(){if(this.__zooming){var e,n,r,a,o=m(this,arguments),s=Je.changedTouches,l=s.length;for(_k(),t&&(t=clearTimeout(t)),o.taps=0,e=0;e<l;++e)n=s[e],r=vr(this,s,n.identifier),o.touch0&&o.touch0[2]===n.identifier?o.touch0[0]=r:o.touch1&&o.touch1[2]===n.identifier&&(o.touch1[0]=r);if(n=o.that.__zoom,o.touch1){var c=o.touch0[0],h=o.touch0[1],f=o.touch1[0],d=o.touch1[1],g=(g=f[0]-c[0])*g+(g=f[1]-c[1])*g,y=(y=d[0]-h[0])*y+(y=d[1]-h[1])*y;n=p(n,Math.sqrt(g/y)),r=[(c[0]+f[0])/2,(c[1]+f[1])/2],a=[(h[0]+d[0])/2,(h[1]+d[1])/2]}else{if(!o.touch0)return;r=o.touch0[0],a=o.touch0[1]}o.zoom("touch",i(_(n,r,a),o.extent,u))}}function E(){if(this.__zooming){var t,n,r=m(this,arguments),i=Je.changedTouches,a=i.length;for(pk(),e&&clearTimeout(e),e=setTimeout((function(){e=null}),500),t=0;t<a;++t)n=i[t],r.touch0&&r.touch0[2]===n.identifier?delete r.touch0:r.touch1&&r.touch1[2]===n.identifier&&delete r.touch1;if(r.touch1&&!r.touch0&&(r.touch0=r.touch1,delete r.touch1),r.touch0)r.touch0[1]=this.__zoom.invert(r.touch0[0]);else if(r.end(),2===r.taps){var o=fn(this).on("dblclick.zoom");o&&o.apply(this,arguments)}}}return d.transform=function(t,e,n){var r=t.selection?t.selection():t;r.property("__zoom",mk),t!==r?y(t,e,n):r.interrupt().each((function(){m(this,arguments).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()}))},d.scaleBy=function(t,e,n){d.scaleTo(t,(function(){var t=this.__zoom.k,n="function"==typeof e?e.apply(this,arguments):e;return t*n}),n)},d.scaleTo=function(t,e,n){d.transform(t,(function(){var t=r.apply(this,arguments),a=this.__zoom,o=null==n?g(t):"function"==typeof n?n.apply(this,arguments):n,s=a.invert(o),l="function"==typeof e?e.apply(this,arguments):e;return i(_(p(a,l),o,s),t,u)}),n)},d.translateBy=function(t,e,n){d.transform(t,(function(){return i(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),r.apply(this,arguments),u)}))},d.translateTo=function(t,e,n,a){d.transform(t,(function(){var t=r.apply(this,arguments),o=this.__zoom,s=null==a?g(t):"function"==typeof a?a.apply(this,arguments):a;return i(fk.translate(s[0],s[1]).scale(o.k).translate("function"==typeof e?-e.apply(this,arguments):-e,"function"==typeof n?-n.apply(this,arguments):-n),t,u)}),a)},b.prototype={start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){rn(new ck(d,t,this.that.__zoom),h.apply,h,[t,this.that,this.args])}},d.wheelDelta=function(t){return arguments.length?(a="function"==typeof t?t:lk(+t),d):a},d.filter=function(t){return arguments.length?(n="function"==typeof t?t:lk(!!t),d):n},d.touchable=function(t){return arguments.length?(o="function"==typeof t?t:lk(!!t),d):o},d.extent=function(t){return arguments.length?(r="function"==typeof t?t:lk([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),d):r},d.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],d):[s[0],s[1]]},d.translateExtent=function(t){return arguments.length?(u[0][0]=+t[0][0],u[1][0]=+t[1][0],u[0][1]=+t[0][1],u[1][1]=+t[1][1],d):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},d.constrain=function(t){return arguments.length?(i=t,d):i},d.duration=function(t){return arguments.length?(l=+t,d):l},d.interpolate=function(t){return arguments.length?(c=t,d):c},d.on=function(){var t=h.on.apply(h,arguments);return t===h?d:t},d.clickDistance=function(t){return arguments.length?(f=(t=+t)*t,d):Math.sqrt(f)},d};const Mk={verbs:["highlight","select","fade","hide"],adjectives:["highlighted","selected","faded","hidden"]};function kk(t){return isNaN(t)||t<=0?null:Math.log(t)/Math.LN10}function Ek(t){return isNaN(t)||t<=0?null:-Math.log(t)/Math.LN10}function Sk(t){if(isNaN(t))return"NaN";if(0===t)return"1";const e=Math.ceil(t),n=e-t,r=Math.pow(10,n);return 1===e?(r/10).toFixed(4):2===e?(r/100).toFixed(3):`${r.toFixed(2)}  10^-${e}`}function zk(t){if(isNaN(t))return"NaN";if(0===t)return"0";const e=Math.abs(t);let n;return n=e>1?Math.ceil(Math.log(e)/Math.LN10):Math.floor(Math.log(e)/Math.LN10),Math.abs(n)<=3?t.toFixed(3):t.toExponential(2).replace("+","").replace("e","  10^")}function Nk(t){return t?(t=""+t).replace(/['"<>&`]/g,(function(t){switch(t){case"'":return"&#039;";case'"':return"&quot;";case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"`":return"&#x60;"}})):""}function Tk(t){return"number"==typeof t}function Ak(t){return encodeURIComponent(t)}const Ck=new class extends _{_collectTransforms(t){const e=t.match(/\|([^|]+)/g).map(t=>super.get(t.substring(1)));return t=>e.reduce((t,e)=>e(t),t)}get(t){return t?"|"===t.substring(0,1)?this._collectTransforms(t):super.get(t):null}};for(let[t,e]of Object.entries(o))Ck.add(t,e);var Pk=Ck;class Rk{constructor(t){if(!/^(?:\w+:\w+|^\w+)(?:\|\w+)*$/.test(t))throw new Error(`Invalid field specifier: '${t}'`);const[e,...n]=t.split("|");this.full_name=t,this.field_name=e,this.transformations=n.map(t=>Pk.get(t))}_applyTransformations(t){return this.transformations.forEach((function(e){t=e(t)})),t}resolve(t,e){if(void 0===t[this.full_name]){let n=null;void 0!==t[this.field_name]?n=t[this.field_name]:e&&void 0!==e[this.field_name]&&(n=e[this.field_name]),t[this.full_name]=this._applyTransformations(n)}return t[this.full_name]}}const Ok=/^(\*|[\w]+)/,Lk=/^\[\?\(@((?:\.[\w]+)+) *===? *([0-9.eE-]+|"[^"]*"|'[^']*')\)\]/;function Dk(t){if(".."===t.substr(0,2)){if("["===t[2])return{text:"..",attr:"*",depth:".."};const e=Ok.exec(t.substr(2));if(!e)throw`Cannot parse ${JSON.stringify(t)} as dotdot_attr.`;return{text:".."+e[0],attr:e[1],depth:".."}}if("."===t[0]){const e=Ok.exec(t.substr(1));if(!e)throw`Cannot parse ${JSON.stringify(t)} as dot_attr.`;return{text:"."+e[0],attr:e[1],depth:"."}}if("["===t[0]){const e=Lk.exec(t);if(!e)throw`Cannot parse ${JSON.stringify(t)} as expr.`;let n;try{n=JSON.parse(e[2])}catch(t){n=JSON.parse(e[2].replace(/^'|'$/g,'"'))}return{text:e[0],attrs:e[1].substr(1).split("."),value:n}}throw`The query ${JSON.stringify(t)} doesn't look valid.`}function jk(t,e){let n;for(let r of e)n=t,t=t[r];return[n,e[e.length-1],t]}function $k(t,e){if(!e.length)return[[]];const n=e[0],r=e.slice(1);let i=[];if(n.attr&&"."===n.depth&&"*"!==n.attr){const a=t[n.attr];1===e.length?void 0!==a&&i.push([n.attr]):i.push(...$k(a,r).map(t=>[n.attr].concat(t)))}else if(n.attr&&"."===n.depth&&"*"===n.attr)for(let[e,n]of Object.entries(t))i.push(...$k(n,r).map(t=>[e].concat(t)));else if(n.attr&&".."===n.depth){if("object"==typeof t&&null!==t){"*"!==n.attr&&n.attr in t&&i.push(...$k(t[n.attr],r).map(t=>[n.attr].concat(t)));for(let[a,o]of Object.entries(t))i.push(...$k(o,e).map(t=>[a].concat(t))),"*"===n.attr&&i.push(...$k(o,r).map(t=>[a].concat(t)))}}else if(n.attrs)for(let[e,a]of Object.entries(t)){const[t,o,s]=jk(a,n.attrs);s===n.value&&i.push(...$k(a,r).map(t=>[e].concat(t)))}const a=(o=i,s=JSON.stringify,[...new Map(o.map(t=>[s(t),t])).values()]);var o,s;return a.sort((t,e)=>e.length-t.length||JSON.stringify(t).localeCompare(JSON.stringify(e))),a}function Ik(t,e){const n=function(t,e){let n=[];for(let r of $k(t,e))n.push(jk(t,r));return n}(t,function(t){t=function(t){return t?(["$","["].includes(t[0])||(t="$."+t),"$"===t[0]&&(t=t.substr(1)),t):""}(t);let e=[];for(;t.length;){const n=Dk(t);t=t.substr(n.text.length),e.push(n)}return e}(e));return n.length||console.warn(`No items matched the specified query: '${e}'`),n}const Bk=Math.sqrt(3),Uk={draw(t,e){const n=-Math.sqrt(e/(3*Bk));t.moveTo(0,2*-n),t.lineTo(-Bk*n,n),t.lineTo(Bk*n,n),t.closePath()}};function qk(t,e){if("object"!=typeof t||"object"!=typeof e)throw new Error(`LocusZoom.Layouts.merge only accepts two layout objects; ${typeof t}, ${typeof e} given`);for(let n in e){if(!Object.prototype.hasOwnProperty.call(e,n))continue;let r=null===t[n]?"undefined":typeof t[n],i=typeof e[n];if("object"===r&&Array.isArray(t[n])&&(r="array"),"object"===i&&Array.isArray(e[n])&&(i="array"),"function"===r||"function"===i)throw new Error("LocusZoom.Layouts.merge encountered an unsupported property type");"undefined"!==r?"object"!==r||"object"!==i||(t[n]=qk(t[n],e[n])):t[n]=Fk(e[n])}return t}function Fk(t){return JSON.parse(JSON.stringify(t))}function Yk(t){if(!t)return null;if("triangledown"===t)return Uk;const e="symbol"+(t.charAt(0).toUpperCase()+t.slice(1));return a[e]||null}function Hk(t,e,n=null){const r=new Set;if(!n){if(!e.length)return r;const t=e.join("|");n=new RegExp(`(?:{{)?(?:#if *)?((?:${t}):\\w+)`,"g")}for(const i of Object.values(t)){const t=typeof i;let a=[];if("string"===t){let t;for(;null!==(t=n.exec(i));)a.push(t[1])}else{if(null===i||"object"!==t)continue;a=Hk(i,e,n)}for(let t of a)r.add(t)}return r}function Gk(t,e,n){return function(t,e,n){return Ik(t,e).map(([t,e,r])=>{const i="function"==typeof n?n(r):n;return t[e]=i,i})}(t,e,n)}function Vk(t,e){return function(t,e){return Ik(t,e).map(t=>t[2])}(t,e)}class Xk{constructor(t,e,n){this._callable=YS.get(t),this._initiator=e,this._params=n||[]}getData(t,...e){const n={plot_state:t,data_layer:this._initiator};return Promise.resolve(this._callable(n,e,...this._params))}}var Zk=class{constructor(t){this._sources=t}config_to_sources(t={},e=[],n){const r=new Map,i=Object.keys(t);let a=e.find(t=>"fetch"===t.type);a||(a={type:"fetch",from:i},e.unshift(a));const o=/^\w+$/;for(let[e,n]of Object.entries(t)){if(!o.test(e))throw new Error(`Invalid namespace name: '${e}'. Must contain only alphanumeric characters`);const t=this._sources.get(n);if(!t)throw new Error(`A data layer has requested an item not found in DataSources: data type '${e}' from ${n}`);r.set(e,t),a.from.find(t=>t.split("(")[0]===e)||a.from.push(e)}let s=Array.from(a.from);for(let t of e){let{type:e,name:i,requires:a,params:o}=t;if("fetch"!==e){let u=0;if(i||(i=t.name="join"+u,u+=1),r.has(i))throw new Error(`Configuration error: within a layer, join name '${i}' must be unique`);a.forEach(t=>{if(!r.has(t))throw new Error(`Data operation cannot operate on unknown provider '${t}'`)});const l=new Xk(e,n,o);r.set(i,l),s.push(`${i}(${a.join(", ")})`)}}return[r,s]}getData(t,e,n){return n.length?M(t,e,n,!0):Promise.resolve([])}};function Wk(){return{showing:!1,selector:null,content_selector:null,hide_delay:null,show:(t,e)=>(this.curtain.showing||(this.curtain.selector=fn(this.parent_plot.svg.node().parentNode).insert("div").attr("class","lz-curtain").attr("id",this.id+".curtain"),this.curtain.content_selector=this.curtain.selector.append("div").attr("class","lz-curtain-content"),this.curtain.selector.append("div").attr("class","lz-curtain-dismiss").html("Dismiss").on("click",()=>this.curtain.hide()),this.curtain.showing=!0),this.curtain.update(t,e)),update:(t,e)=>{if(!this.curtain.showing)return this.curtain;clearTimeout(this.curtain.hide_delay),"object"==typeof e&&Kk(this.curtain.selector,e);const n=this._getPageOrigin(),r=this.layout.height||this._total_height;return this.curtain.selector.style("top",n.y+"px").style("left",n.x+"px").style("width",this.parent_plot.layout.width+"px").style("height",r+"px"),this.curtain.content_selector.style("max-width",this.parent_plot.layout.width-40+"px").style("max-height",r-40+"px"),"string"==typeof t&&this.curtain.content_selector.html(t),this.curtain},hide:t=>this.curtain.showing?"number"==typeof t?(clearTimeout(this.curtain.hide_delay),this.curtain.hide_delay=setTimeout(this.curtain.hide,t),this.curtain):(this.curtain.selector.remove(),this.curtain.selector=null,this.curtain.content_selector=null,this.curtain.showing=!1,this.curtain):this.curtain}}function Jk(){return{showing:!1,selector:null,content_selector:null,progress_selector:null,cancel_selector:null,show:t=>(this.loader.showing||(this.loader.selector=fn(this.parent_plot.svg.node().parentNode).insert("div").attr("class","lz-loader").attr("id",this.id+".loader"),this.loader.content_selector=this.loader.selector.append("div").attr("class","lz-loader-content"),this.loader.progress_selector=this.loader.selector.append("div").attr("class","lz-loader-progress-container").append("div").attr("class","lz-loader-progress"),this.loader.showing=!0,void 0===t&&(t="Loading...")),this.loader.update(t)),update:(t,e)=>{if(!this.loader.showing)return this.loader;clearTimeout(this.loader.hide_delay),"string"==typeof t&&this.loader.content_selector.html(t);const n=this._getPageOrigin(),r=this.loader.selector.node().getBoundingClientRect();return this.loader.selector.style("top",n.y+this.layout.height-r.height-6+"px").style("left",n.x+6+"px"),"number"==typeof e&&this.loader.progress_selector.style("width",Math.min(Math.max(e,1),100)+"%"),this.loader},animate:()=>(this.loader.progress_selector.classed("lz-loader-progress-animated",!0),this.loader),setPercentCompleted:t=>(this.loader.progress_selector.classed("lz-loader-progress-animated",!1),this.loader.update(null,t)),hide:t=>this.loader.showing?"number"==typeof t?(clearTimeout(this.loader.hide_delay),this.loader.hide_delay=setTimeout(this.loader.hide,t),this.loader):(this.loader.selector.remove(),this.loader.selector=null,this.loader.content_selector=null,this.loader.progress_selector=null,this.loader.cancel_selector=null,this.loader.showing=!1,this.loader):this.loader}}function Kk(t,e){e=e||{};for(let[n,r]of Object.entries(e))t.style(n,r)}class Qk{constructor(t,e){this.layout=t||{},this.layout.color||(this.layout.color="gray"),this.parent=e||null,this.parent_panel=null,this.parent_plot=null,this.parent_svg=null,this.parent&&("panel"===this.parent.type?(this.parent_panel=this.parent.parent,this.parent_plot=this.parent.parent.parent,this.parent_svg=this.parent_panel):(this.parent_plot=this.parent.parent,this.parent_svg=this.parent_plot)),this.selector=null,this.button=null,this.persist=!1,this.layout.position||(this.layout.position="left")}show(){if(this.parent&&this.parent.selector){if(!this.selector){const t=["start","middle","end"].includes(this.layout.group_position)?" lz-toolbar-group-"+this.layout.group_position:"";this.selector=this.parent.selector.append("div").attr("class",`lz-toolbar-${this.layout.position}${t}`),this.layout.style&&Kk(this.selector,this.layout.style),"function"==typeof this.initialize&&this.initialize()}return this.button&&"highlighted"===this.button.status&&this.button.menu.show(),this.selector.style("visibility","visible"),this.update(),this.position()}}update(){}position(){return this.button&&this.button.menu.position(),this}shouldPersist(){return!!this.persist||!(!this.button||!this.button.persist)}hide(){return!this.selector||this.shouldPersist()||(this.button&&this.button.menu.hide(),this.selector.style("visibility","hidden")),this}destroy(t){return void 0===t&&(t=!1),this.selector?(this.shouldPersist()&&!t||(this.button&&this.button.menu&&this.button.menu.destroy(),this.selector.remove(),this.selector=null,this.button=null),this):this}}class tE{constructor(t){if(!(t instanceof Qk))throw new Error("Unable to create toolbar widget button, invalid parent");this.parent=t,this.parent_panel=this.parent.parent_panel,this.parent_plot=this.parent.parent_plot,this.parent_svg=this.parent.parent_svg,this.parent_toolbar=this.parent.parent,this.selector=null,this.tag="a",this.html="",this.title="",this.color="gray",this.style={},this.persist=!1,this.permanent=!1,this.status="",this.menu={outer_selector:null,inner_selector:null,scroll_position:0,hidden:!0,show:()=>(this.menu.outer_selector||(this.menu.outer_selector=fn(this.parent_plot.svg.node().parentNode).append("div").attr("class","lz-toolbar-menu lz-toolbar-menu-"+this.color).attr("id",this.parent_svg.getBaseId()+".toolbar.menu"),this.menu.inner_selector=this.menu.outer_selector.append("div").attr("class","lz-toolbar-menu-content"),this.menu.inner_selector.on("scroll",()=>{this.menu.scroll_position=this.menu.inner_selector.node().scrollTop})),this.menu.outer_selector.style("visibility","visible"),this.menu.hidden=!1,this.menu.update()),update:()=>this.menu.outer_selector?(this.menu.populate(),this.menu.inner_selector&&(this.menu.inner_selector.node().scrollTop=this.menu.scroll_position),this.menu.position()):this.menu,position:()=>{if(!this.menu.outer_selector)return this.menu;this.menu.outer_selector.style("height",null);const t=this.parent_svg._getPageOrigin(),e=document.documentElement.scrollTop||document.body.scrollTop,n=this.parent_plot.getContainerOffset(),r=this.parent_toolbar.selector.node().getBoundingClientRect(),i=this.selector.node().getBoundingClientRect(),a=this.menu.outer_selector.node().getBoundingClientRect(),o=this.menu.inner_selector.node().scrollHeight;let s,u;"panel"===this.parent_toolbar.type?(s=t.y+r.height+6,u=Math.max(t.x+this.parent_plot.layout.width-a.width-3,t.x+3)):(s=i.bottom+e+3-n.top,u=Math.max(i.left+i.width-a.width-n.left,t.x+3));const l=Math.max(this.parent_plot.layout.width-6-20,20),c=l,h=l-12,f=Math.max(this.parent_svg.layout.height-30-14,14),d=Math.min(o+14,f);return this.menu.outer_selector.style("top",s+"px").style("left",u+"px").style("max-width",c+"px").style("max-height",f+"px").style("height",d+"px"),this.menu.inner_selector.style("max-width",h+"px"),this.menu.inner_selector.node().scrollTop=this.menu.scroll_position,this.menu},hide:()=>this.menu.outer_selector?(this.menu.outer_selector.style("visibility","hidden"),this.menu.hidden=!0,this.menu):this.menu,destroy:()=>this.menu.outer_selector?(this.menu.inner_selector.remove(),this.menu.outer_selector.remove(),this.menu.inner_selector=null,this.menu.outer_selector=null,this.menu):this.menu,populate:()=>{throw new Error("Method must be implemented")},setPopulate:t=>("function"==typeof t?(this.menu.populate=t,this.setOnclick(()=>{this.menu.hidden?(this.menu.show(),this.highlight().update(),this.persist=!0):(this.menu.hide(),this.highlight(!1).update(),this.permanent||(this.persist=!1))})):this.setOnclick(),this)}}setColor(t){return void 0!==t&&(["gray","red","orange","yellow","green","blue","purple"].includes(t)?this.color=t:this.color="gray"),this}setPermanent(t){return t=void 0===t||Boolean(t),this.permanent=t,this.permanent&&(this.persist=!0),this}shouldPersist(){return this.permanent||this.persist}setStyle(t){return void 0!==t&&(this.style=t),this}getClass(){const t=["start","middle","end"].includes(this.parent.layout.group_position)?" lz-toolbar-button-group-"+this.parent.layout.group_position:"";return`lz-toolbar-button lz-toolbar-button-${this.color}${this.status?"-"+this.status:""}${t}`}setStatus(t){return void 0!==t&&["","highlighted","disabled"].includes(t)&&(this.status=t),this.update()}highlight(t){return(t=void 0===t||Boolean(t))?this.setStatus("highlighted"):"highlighted"===this.status?this.setStatus(""):this}disable(t){return(t=void 0===t||Boolean(t))?this.setStatus("disabled"):"disabled"===this.status?this.setStatus(""):this}onmouseover(){}setOnMouseover(t){return this.onmouseover="function"==typeof t?t:function(){},this}onmouseout(){}setOnMouseout(t){return this.onmouseout="function"==typeof t?t:function(){},this}onclick(){}setOnclick(t){return this.onclick="function"==typeof t?t:function(){},this}setTitle(t){return void 0!==t&&(this.title=t.toString()),this}setHtml(t){return void 0!==t&&(this.html=t.toString()),this}show(){if(this.parent)return this.selector||(this.selector=this.parent.selector.append(this.tag).attr("class",this.getClass())),this.update()}preUpdate(){return this}update(){return this.selector?(this.preUpdate(),this.selector.attr("class",this.getClass()).attr("title",this.title).on("mouseover","disabled"===this.status?null:this.onmouseover).on("mouseout","disabled"===this.status?null:this.onmouseout).on("click","disabled"===this.status?null:this.onclick).html(this.html).call(Kk,this.style),this.menu.update(),this.postUpdate(),this):this}postUpdate(){return this}hide(){return this.selector&&!this.shouldPersist()&&(this.selector.remove(),this.selector=null),this}}class eE extends Qk{show(){return this.div_selector||(this.div_selector=this.parent.selector.append("div").attr("class","lz-toolbar-title lz-toolbar-"+this.layout.position),this.title_selector=this.div_selector.append("h3")),this.update()}update(){let t=this.layout.title.toString();return this.layout.subtitle&&(t+=` <small>${this.layout.subtitle}</small>`),this.title_selector.html(t),this}}class nE extends Qk{update(){return isNaN(this.parent_plot.state.start)||isNaN(this.parent_plot.state.end)||null===this.parent_plot.state.start||null===this.parent_plot.state.end?this.selector.style("display","none"):(this.selector.style("display",null),this.selector.html(EE(this.parent_plot.state.end-this.parent_plot.state.start,null,!0))),this.layout.class&&this.selector.attr("class",this.layout.class),this.layout.style&&Kk(this.selector,this.layout.style),this}}class rE extends Qk{constructor(t,e){if(super(t,e),!this.parent_panel)throw new Error("Filter widget can only be used in panel toolbars");if(this._data_layer=this.parent_panel.data_layers[t.layer_name],!this._data_layer)throw new Error(`Filter widget could not locate the specified layer_name: '${t.layer_name}'`);if(this._event_name=t.custom_event_name||"widget_filter_field_action",this._field=t.field,this._field_display_html=t.field_display_html,this._operator=t.operator,this._filter_id=null,this._data_type=t.data_type||"number",!["number","string"].includes(this._data_type))throw new Error("Filter must be either string or number");this._value_selector=null}_getTarget(){this._data_layer.layout.filters||(this._data_layer.layout.filters=[]);let t=this._data_layer.layout.filters.find(t=>t.field===this._field&&t.operator===this._operator&&(!this._filter_id||t.id===this._filter_id));return t||(t={field:this._field,operator:this._operator,value:null},this._filter_id&&(t.id=this._filter_id),this._data_layer.layout.filters.push(t)),t}_clearFilter(){if(this._data_layer.layout.filters){const t=this._data_layer.layout.filters.indexOf(this._getTarget());this._data_layer.layout.filters.splice(t,1)}}_setFilter(t){if(null===t)this._value_selector.style("border","1px solid red").style("color","red"),this._clearFilter();else{this._getTarget().value=t}this.parent_svg.emit(this._event_name,{field:this._field,operator:this._operator,value:t,filter_id:this._filter_id},!0)}_getValue(){let t=this._value_selector.property("value");return null===t||""===t||"number"===this._data_type&&(t=+t,Number.isNaN(t))?null:t}update(){this._value_selector||(this.selector.style("padding","0 6px"),this.selector.append("span").html(this._field_display_html).style("background","#fff").style("padding-left","3px"),this.selector.append("span").text(this._operator).style("padding","0 3px").style("background","#fff"),this._value_selector=this.selector.append("input").attr("size",this.layout.input_size||4).on("input",function(t,e=500){let n;return()=>{clearTimeout(n),n=setTimeout(()=>t.apply(this,arguments),e)}}(()=>{this._value_selector.style("border",null).style("color",null);const t=this._getValue();this._setFilter(t),this.parent_panel.render()},750)))}}class iE extends Qk{constructor(t,e){super(t,e),this._filename=this.layout.filename||"locuszoom.svg",this._button_html=this.layout.button_html||"Save SVG",this._button_title=this.layout.button_title||"Download hi-res image",this._event_name=t.custom_event_name||"widget_save_svg"}update(){return this.button||(this.button=new tE(this).setColor(this.layout.color).setHtml(this._button_html).setTitle(this._button_title).setOnMouseover(()=>{this.button.selector.classed("lz-toolbar-button-gray-disabled",!0).html("Preparing Image"),this._getBlobUrl().then(t=>{const e=this.button.selector.attr("href");e&&URL.revokeObjectURL(e),this.button.selector.attr("href",t).classed("lz-toolbar-button-gray-disabled",!1).classed("lz-toolbar-button-gray-highlighted",!0).html(this._button_html)})}).setOnMouseout(()=>{this.button.selector.classed("lz-toolbar-button-gray-highlighted",!1)}),this.button.show(),this.button.selector.attr("href-lang","image/svg+xml").attr("download",this._filename).on("click",()=>this.parent_svg.emit(this._event_name,{filename:this._filename},!0))),this}_getCSS(t){const e=/^svg\.lz-locuszoom\s*/;let n="";for(let t=0;t<document.styleSheets.length;t++){const r=document.styleSheets[t];try{if(!r.cssRules)continue}catch(t){if("SecurityError"!==t.name)throw t;continue}let i=r.cssRules;for(let t=0;t<i.length;t++){const r=i[t];r.selectorText&&r.selectorText.match(e)&&(n+=r.cssText)}}return n}_appendCSS(t,e){var n=document.createElement("style");n.setAttribute("type","text/css"),n.innerHTML=t;var r=e.hasChildNodes()?e.children[0]:null;e.insertBefore(n,r)}_getDimensions(){let{width:t,height:e}=this.parent_plot.svg.node().getBoundingClientRect();const n=2400/t;return[n*t,n*e]}_generateSVG(){return new Promise(t=>{let e=this.parent_plot.svg.node().cloneNode(!0);e.setAttribute("xlink","http://www.w3.org/1999/xlink"),e=fn(e),e.selectAll("g.lz-curtain").remove(),e.selectAll("g.lz-mouse_guide").remove(),e.selectAll("g.tick text").each((function(){const t=10*+fn(this).attr("dy").substring(-2).slice(0,-2);fn(this).attr("dy",t)}));const n=new XMLSerializer;e=e.node();const[r,i]=this._getDimensions();e.setAttribute("width",r),e.setAttribute("height",i),this._appendCSS(this._getCSS(e),e),t(n.serializeToString(e))})}_getBlobUrl(){return this._generateSVG().then(t=>{const e=new Blob([t],{type:"image/svg+xml"});return URL.createObjectURL(e)})}}class aE extends iE{constructor(t,e){super(...arguments),this._filename=this.layout.filename||"locuszoom.png",this._button_html=this.layout.button_html||"Save PNG",this._button_title=this.layout.button_title||"Download image",this._event_name=t.custom_event_name||"widget_save_png"}_getBlobUrl(){return super._getBlobUrl().then(t=>{const e=document.createElement("canvas"),n=e.getContext("2d"),[r,i]=this._getDimensions();return e.width=r,e.height=i,new Promise((a,o)=>{const s=new Image;s.onload=()=>{n.drawImage(s,0,0,r,i),URL.revokeObjectURL(t),e.toBlob(t=>{a(URL.createObjectURL(t))})},s.src=t})})}}class oE extends Qk{update(){return this.button||(this.button=new tE(this).setColor(this.layout.color).setHtml("").setTitle("Remove panel").setOnclick(()=>{if(!this.layout.suppress_confirm&&!confirm("Are you sure you want to remove this panel? This cannot be undone."))return!1;const t=this.parent_panel;return t.toolbar.hide(!0),fn(t.parent.svg.node().parentNode).on(`mouseover.${t.getBaseId()}.toolbar`,null),fn(t.parent.svg.node().parentNode).on(`mouseout.${t.getBaseId()}.toolbar`,null),t.parent.removePanel(t.id)}),this.button.show()),this}}class sE extends Qk{update(){if(this.button){const t=0===this.parent_panel.layout.y_index;return this.button.disable(t),this}return this.button=new tE(this).setColor(this.layout.color).setHtml("").setTitle("Move panel up").setOnclick(()=>{this.parent_panel.moveUp(),this.update()}),this.button.show(),this.update()}}class uE extends Qk{update(){if(this.button){const t=this.parent_panel.layout.y_index===this.parent_plot._panel_ids_by_y_index.length-1;return this.button.disable(t),this}return this.button=new tE(this).setColor(this.layout.color).setHtml("").setTitle("Move panel down").setOnclick(()=>{this.parent_panel.moveDown(),this.update()}),this.button.show(),this.update()}}class lE extends Qk{constructor(t,e){if((isNaN(t.step)||0===t.step)&&(t.step=5e4),"string"!=typeof t.button_html&&(t.button_html=t.step>0?">":"<"),"string"!=typeof t.button_title&&(t.button_title=`Shift region by ${t.step>0?"+":"-"}${EE(Math.abs(t.step),null,!0)}`),super(t,e),isNaN(this.parent_plot.state.start)||isNaN(this.parent_plot.state.end))throw new Error("Unable to add shift_region toolbar widget: plot state does not have region bounds")}update(){return this.button||(this.button=new tE(this).setColor(this.layout.color).setHtml(this.layout.button_html).setTitle(this.layout.button_title).setOnclick(()=>{this.parent_plot.applyState({start:Math.max(this.parent_plot.state.start+this.layout.step,1),end:this.parent_plot.state.end+this.layout.step})}),this.button.show()),this}}class cE extends Qk{constructor(t,e){if((isNaN(t.step)||0===t.step)&&(t.step=.2),"string"!=typeof t.button_html&&(t.button_html=t.step>0?"z":"z+"),"string"!=typeof t.button_title&&(t.button_title=`Zoom region ${t.step>0?"out":"in"} by ${(100*Math.abs(t.step)).toFixed(1)}%`),super(t,e),isNaN(this.parent_plot.state.start)||isNaN(this.parent_plot.state.end))throw new Error("Unable to add zoom_region toolbar widget: plot state does not have region bounds")}update(){if(this.button){let t=!0;const e=this.parent_plot.state.end-this.parent_plot.state.start;return this.layout.step>0&&!isNaN(this.parent_plot.layout.max_region_scale)&&e>=this.parent_plot.layout.max_region_scale&&(t=!1),this.layout.step<0&&!isNaN(this.parent_plot.layout.min_region_scale)&&e<=this.parent_plot.layout.min_region_scale&&(t=!1),this.button.disable(!t),this}return this.button=new tE(this).setColor(this.layout.color).setHtml(this.layout.button_html).setTitle(this.layout.button_title).setOnclick(()=>{const t=this.parent_plot.state.end-this.parent_plot.state.start;let e=t*(1+this.layout.step);isNaN(this.parent_plot.layout.max_region_scale)||(e=Math.min(e,this.parent_plot.layout.max_region_scale)),isNaN(this.parent_plot.layout.min_region_scale)||(e=Math.max(e,this.parent_plot.layout.min_region_scale));const n=Math.floor((e-t)/2);this.parent_plot.applyState({start:Math.max(this.parent_plot.state.start-n,1),end:this.parent_plot.state.end+n})}),this.button.show(),this}}class hE extends Qk{update(){return this.button||(this.button=new tE(this).setColor(this.layout.color).setHtml(this.layout.button_html).setTitle(this.layout.button_title),this.button.menu.setPopulate(()=>{this.button.menu.inner_selector.html(this.layout.menu_html)}),this.button.show()),this}}class fE extends Qk{constructor(t){super(...arguments)}update(){return this.button||(this.button=new tE(this).setColor(this.layout.color).setHtml(this.layout.button_html||"Resize to Data").setTitle(this.layout.button_title||"Automatically resize this panel to show all data available").setOnclick(()=>{this.parent_panel.scaleHeightToData(),this.update()}),this.button.show()),this}}class dE extends Qk{update(){const t=this.parent_panel.legend.layout.hidden?"Show Legend":"Hide Legend";return this.button?(this.button.setHtml(t).show(),this.parent.position(),this):(this.button=new tE(this).setColor(this.layout.color).setTitle("Show or hide the legend for this panel").setOnclick(()=>{this.parent_panel.legend.layout.hidden=!this.parent_panel.legend.layout.hidden,this.parent_panel.legend.render(),this.update()}),this.update())}}class pE extends Qk{constructor(t,e){"string"!=typeof t.button_html&&(t.button_html="Display options..."),"string"!=typeof t.button_title&&(t.button_title="Control how plot items are displayed"),super(...arguments),this._event_name=t.custom_event_name||"widget_display_options_choice";const n=t.fields_whitelist||["color","fill_opacity","filters","label","legend","point_shape","point_size","tooltip","tooltip_positioning"],r=this.parent_panel.data_layers[t.layer_name];if(!r)throw new Error(`Display options could not locate the specified layer_name: '${t.layer_name}'`);const i=r.layout,a={};n.forEach(t=>{const e=i[t];void 0!==e&&(a[t]=Fk(e))}),this._selected_item="default",this.button=new tE(this).setColor(t.color).setHtml(t.button_html).setTitle(t.button_title).setOnclick(()=>{this.button.menu.populate()}),this.button.menu.setPopulate(()=>{const t=Math.floor(1e4*Math.random()).toString();this.button.menu.inner_selector.html("");const e=this.button.menu.inner_selector.append("table"),i=this.layout,o=(i,o,s)=>{const u=e.append("tr"),l=`${t}${s}`;u.append("td").append("input").attr("id",l).attr("type","radio").attr("name","display-option-"+t).attr("value",s).style("margin",0).property("checked",s===this._selected_item).on("click",()=>{n.forEach(t=>{const e=void 0!==o[t];r.layout[t]=e?o[t]:a[t]}),this.parent_svg.emit(this._event_name,{choice:i},!0),this._selected_item=s,this.parent_panel.render();const t=this.parent_panel.legend;t&&t.render()}),u.append("td").append("label").style("font-weight","normal").attr("for",l).text(i)},s=i.default_config_display_name||"Default style";return o(s,a,"default"),i.options.forEach((t,e)=>o(t.display_name,t.display,e)),this})}update(){return this.button.show(),this}}class _E extends Qk{constructor(t,e){if("string"!=typeof t.button_html&&(t.button_html="Set option..."),"string"!=typeof t.button_title&&(t.button_title="Choose an option to customize the plot"),super(t,e),this.parent_panel)throw new Error("This widget is designed to set global options, so it can only be used at the top (plot) level");if(!t.state_field)throw new Error("Must specify the `state_field` that this widget controls");if(this._event_name=t.custom_event_name||"widget_set_state_choice",this._selected_item=this.parent_plot.state[t.state_field]||t.options[0].value,!t.options.find(t=>t.value===this._selected_item))throw new Error("There is an existing state value that does not match the known values in this widget");this.button=new tE(this).setColor(t.color).setHtml(t.button_html+(t.show_selected?this._selected_item:"")).setTitle(t.button_title).setOnclick(()=>{this.button.menu.populate()}),this.button.menu.setPopulate(()=>{const e=Math.floor(1e4*Math.random()).toString();this.button.menu.inner_selector.html("");const n=this.button.menu.inner_selector.append("table"),r=(r,i,a)=>{const o=n.append("tr"),s=`${e}${a}`;o.append("td").append("input").attr("id",s).attr("type","radio").attr("name","set-state-"+e).attr("value",a).style("margin",0).property("checked",i===this._selected_item).on("click",()=>{const e={};e[t.state_field]=i,this._selected_item=i,this.parent_plot.applyState(e),this.button.setHtml(t.button_html+(t.show_selected?this._selected_item:"")),this.parent_svg.emit(this._event_name,{choice_name:r,choice_value:i,state_field:t.state_field},!0)}),o.append("td").append("label").style("font-weight","normal").attr("for",s).text(r)};return t.options.forEach((t,e)=>r(t.display_name,t.value,e)),this})}update(){return this.button.show(),this}}const gE=new g;for(let[t,e]of Object.entries(s))gE.add(t,e);var yE=gE;class mE{constructor(t){this.parent=t,this.id=this.parent.getBaseId()+".toolbar",this.type=this.parent.parent?"panel":"plot",this.parent_plot=this.parent.parent_plot,this.selector=null,this.widgets=[],this.hide_timeout=null,this.persist=!1,this.initialize()}initialize(){const t=this.parent.layout.toolbar.widgets;return Array.isArray(t)&&t.forEach(t=>{this.addWidget(t)}),"panel"===this.type&&fn(this.parent.parent.svg.node().parentNode).on("mouseover."+this.id,()=>{clearTimeout(this.hide_timeout),this.selector&&"hidden"!==this.selector.style("visibility")||this.show()}).on("mouseout."+this.id,()=>{clearTimeout(this.hide_timeout),this.hide_timeout=setTimeout(()=>{this.hide()},300)}),this}addWidget(t){try{const e=yE.create(t.type,t,this);return this.widgets.push(e),e}catch(t){console.warn("Failed to create widget"),console.error(t)}}shouldPersist(){if(this.persist)return!0;let t=!1;return this.widgets.forEach(e=>{t=t||e.shouldPersist()}),t=t||this.parent_plot._panel_boundaries.dragging||this.parent_plot._interaction.dragging,!!t}show(){if(!this.selector){switch(this.type){case"plot":this.selector=fn(this.parent.svg.node().parentNode).insert("div",":first-child");break;case"panel":this.selector=fn(this.parent.parent.svg.node().parentNode).insert("div",".lz-data_layer-tooltip, .lz-toolbar-menu, .lz-curtain").classed("lz-panel-toolbar",!0);break;default:throw new Error("Toolbar cannot be a child of "+this.type)}this.selector.classed("lz-toolbar",!0).classed(`lz-${this.type}-toolbar`,!0).attr("id",this.id)}return this.widgets.forEach(t=>t.show()),this.selector.style("visibility","visible"),this.update()}update(){return this.selector?(this.widgets.forEach(t=>t.update()),this.position()):this}position(){if(!this.selector)return this;if("panel"===this.type){const t=this.parent._getPageOrigin(),e=(t.y+3.5).toString()+"px",n=t.x.toString()+"px",r=(this.parent_plot.layout.width-4).toString()+"px";this.selector.style("position","absolute").style("top",e).style("left",n).style("width",r)}return this.widgets.forEach(t=>t.position()),this}hide(){return!this.selector||this.shouldPersist()||(this.widgets.forEach(t=>t.hide()),this.selector.style("visibility","hidden")),this}destroy(t){return void 0===t&&(t=!1),this.selector?(this.shouldPersist()&&!t||(this.widgets.forEach(t=>t.destroy(!0)),this.widgets=[],this.selector.remove(),this.selector=null),this):this}}const bE={orientation:"vertical",origin:{x:0,y:0},width:10,height:10,padding:5,label_size:14,hidden:!1};class vE{constructor(t){return this.parent=t,this.id=this.parent.getBaseId()+".legend",this.parent.layout.legend=qk(this.parent.layout.legend||{},bE),this.layout=this.parent.layout.legend,this.selector=null,this.background_rect=null,this.elements=[],this.elements_group=null,this.hidden=!1,this.render()}render(){this.selector||(this.selector=this.parent.svg.group.append("g").attr("id",this.parent.getBaseId()+".legend").attr("class","lz-legend")),this.background_rect||(this.background_rect=this.selector.append("rect").attr("width",100).attr("height",100).attr("class","lz-legend-background")),this.elements_group||(this.elements_group=this.selector.append("g")),this.elements.forEach(t=>t.remove()),this.elements=[];const t=+this.layout.padding||1;let e=t,n=t,r=0;this.parent._data_layer_ids_by_z_index.slice().reverse().forEach(i=>{const a=this.parent.data_layers[i].layout.legend;Array.isArray(a)&&a.forEach(i=>{const a=this.elements_group.append("g").attr("transform",`translate(${e}, ${n})`),o=+i.label_size||+this.layout.label_size;let s=0,u=o/2+t/2;r=Math.max(r,o+t);const l=i.shape||"",c=Yk(l);if("line"===l){const e=+i.length||16,n=o/4+t/2;a.append("path").attr("class",i.class||"").attr("d",`M0,${n}L${e},${n}`).call(Kk,i.style||{}),s=e+t}else if("rect"===l){const e=+i.width||16,n=+i.height||e;a.append("rect").attr("class",i.class||"").attr("width",e).attr("height",n).attr("fill",i.color||{}).call(Kk,i.style||{}),s=e+t,r=Math.max(r,n+t)}else if("ribbon"===l){const e=+i.width||25,n=+i.height||e,r="horizontal"===(i.orientation||"vertical");let o=i.color_stops;const l=a.append("g"),c=l.append("g"),h=l.append("g");let f=0;if(i.tick_labels){let t;t=r?[0,e*o.length-1]:[n*o.length-1,0];const a=(r?Ft:Yt)(W_().domain(at(i.tick_labels)).range(t)).tickSize(3).tickValues(i.tick_labels).tickFormat(t=>t);h.call(a).attr("class","lz-axis"),f=h.node().getBoundingClientRect().height}r?(h.attr("transform",`translate(0, ${f})`),c.attr("transform",`translate(0, ${f})`)):(l.attr("transform","translate(5, 0)"),h.attr("transform",`translate(${e}, 0)`)),r||(o=o.slice(),o.reverse());for(let t=0;t<o.length;t++){const a=o[t],s=r?`translate(${e*t}, 0)`:`translate(0, ${n*t})`;c.append("rect").attr("class",i.class||"").attr("stroke","black").attr("transform",s).attr("stroke-width",.5).attr("width",e).attr("height",n).attr("fill",a).call(Kk,i.style||{})}if(!r&&i.label)throw new Error("Legend labels not supported for vertical ribbons (use a separate legend item as text instead)");s=e*o.length+t,u+=f}else if(c){const e=+i.size||40,n=Math.ceil(Math.sqrt(e/Math.PI));a.append("path").attr("class",i.class||"").attr("d",yw().size(e).type(c)).attr("transform",`translate(${n}, ${n+t/2})`).attr("fill",i.color||{}).call(Kk,i.style||{}),s=2*n+t,u=Math.max(2*n+t/2,u),r=Math.max(r,2*n+t)}a.append("text").attr("text-anchor","left").attr("class","lz-label").attr("x",s).attr("y",u).style("font-size",o).text(i.label);const h=a.node().getBoundingClientRect();if("vertical"===this.layout.orientation)n+=h.height+t,r=0;else{const i=this.layout.origin.x+e+h.width;e>t&&i>this.parent.parent.layout.width&&(n+=r,e=t,a.attr("transform",`translate(${e}, ${n})`)),e+=h.width+3*t}this.elements.push(a)})});const i=this.elements_group.node().getBoundingClientRect();return this.layout.width=i.width+2*this.layout.padding,this.layout.height=i.height+2*this.layout.padding,this.background_rect.attr("width",this.layout.width).attr("height",this.layout.height),this.selector.style("visibility",this.layout.hidden?"hidden":"visible"),this.position()}position(){if(!this.selector)return this;const t=this.selector.node().getBoundingClientRect();isNaN(+this.layout.pad_from_bottom)||(this.layout.origin.y=this.parent.layout.height-t.height-+this.layout.pad_from_bottom),isNaN(+this.layout.pad_from_right)||(this.layout.origin.x=this.parent.parent.layout.width-t.width-+this.layout.pad_from_right),this.selector.attr("transform",`translate(${this.layout.origin.x}, ${this.layout.origin.y})`)}hide(){this.layout.hidden=!0,this.render()}show(){this.layout.hidden=!1,this.render()}}const xE={id:"",tag:"custom_data_type",title:{text:"",style:{},x:10,y:22},y_index:null,min_height:1,height:1,origin:{x:0,y:null},margin:{top:0,right:0,bottom:0,left:0},background_click:"clear_selections",toolbar:{widgets:[]},cliparea:{height:0,width:0,origin:{x:0,y:0}},axes:{x:{},y1:{},y2:{}},legend:null,interaction:{drag_background_to_pan:!1,drag_x_ticks_to_scale:!1,drag_y1_ticks_to_scale:!1,drag_y2_ticks_to_scale:!1,scroll_to_zoom:!1,x_linked:!1,y1_linked:!1,y2_linked:!1},show_loading_indicator:!0,data_layers:[]};class wE{constructor(t,e){if("object"!=typeof t)throw new Error("Unable to create panel, invalid layout");if(this.parent=e||null,this.parent_plot=e,"string"!=typeof t.id||!t.id)throw new Error('Panel layouts must specify "id"');if(this.parent&&void 0!==this.parent.panels[t.id])throw new Error(`Cannot create panel with id [${t.id}]; panel with that id already exists`);this.id=t.id,this._initialized=!1,this._layout_idx=null,this.svg={},this.layout=qk(t||{},xE),this.parent?(this.state=this.parent.state,this._state_id=this.id,this.state[this._state_id]=this.state[this._state_id]||{}):(this.state=null,this._state_id=null),this.data_layers={},this._data_layer_ids_by_z_index=[],this._data_promises=[],this.x_scale=null,this.y1_scale=null,this.y2_scale=null,this.x_extent=null,this.y1_extent=null,this.y2_extent=null,this.x_ticks=[],this.y1_ticks=[],this.y2_ticks=[],this._zoom_timeout=null,this._event_hooks={},this.initializeLayout()}on(t,e){if("string"!=typeof t)throw new Error("Unable to register event hook. Event name must be a string: "+t.toString());if("function"!=typeof e)throw new Error("Unable to register event hook, invalid hook function passed");return this._event_hooks[t]||(this._event_hooks[t]=[]),this._event_hooks[t].push(e),e}off(t,e){const n=this._event_hooks[t];if("string"!=typeof t||!Array.isArray(n))throw new Error("Unable to remove event hook, invalid event: "+t.toString());if(void 0===e)this._event_hooks[t]=[];else{const t=n.indexOf(e);if(-1===t)throw new Error("The specified event listener is not registered and therefore cannot be removed");n.splice(t,1)}return this}emit(t,e,n){if(n=n||!1,"string"!=typeof t)throw new Error("LocusZoom attempted to throw an invalid event: "+t.toString());"boolean"==typeof e&&2===arguments.length&&(n=e,e=null);const r={sourceID:this.getBaseId(),target:this,data:e||null};return this._event_hooks[t]&&this._event_hooks[t].forEach(t=>{t.call(this,r)}),n&&this.parent&&this.parent.emit(t,r),this}setTitle(t){if("string"==typeof this.layout.title){const t=this.layout.title;this.layout.title={text:t,x:0,y:0,style:{}}}return"string"==typeof t?this.layout.title.text=t:"object"==typeof t&&null!==t&&(this.layout.title=qk(t,this.layout.title)),this.layout.title.text.length?this.title.attr("display",null).attr("x",parseFloat(this.layout.title.x)).attr("y",parseFloat(this.layout.title.y)).text(this.layout.title.text).call(Kk,this.layout.title.style):this.title.attr("display","none"),this}addDataLayer(t){if("object"!=typeof t||"string"!=typeof t.id||!t.id.length)throw new Error("Invalid data layer layout");if(void 0!==this.data_layers[t.id])throw new Error(`Cannot create data_layer with id '${t.id}'; data layer with that id already exists in the panel`);if("string"!=typeof t.type)throw new Error("Invalid data layer type");"object"!=typeof t.y_axis||void 0!==t.y_axis.axis&&[1,2].includes(t.y_axis.axis)||(t.y_axis.axis=1);const e=rS.create(t.type,t,this);if(this.data_layers[e.id]=e,null!==e.layout.z_index&&!isNaN(e.layout.z_index)&&this._data_layer_ids_by_z_index.length>0)e.layout.z_index<0&&(e.layout.z_index=Math.max(this._data_layer_ids_by_z_index.length+e.layout.z_index,0)),this._data_layer_ids_by_z_index.splice(e.layout.z_index,0,e.id),this._data_layer_ids_by_z_index.forEach((t,e)=>{this.data_layers[t].layout.z_index=e});else{const t=this._data_layer_ids_by_z_index.push(e.id);this.data_layers[e.id].layout.z_index=t-1}let n=null;return this.layout.data_layers.forEach((t,r)=>{t.id===e.id&&(n=r)}),null===n&&(n=this.layout.data_layers.push(this.data_layers[e.id].layout)-1),this.data_layers[e.id]._layout_idx=n,this.data_layers[e.id]}removeDataLayer(t){const e=this.data_layers[t];if(!e)throw new Error("Unable to remove data layer, ID not found: "+t);return e.destroyAllTooltips(),e.svg.container&&e.svg.container.remove(),this.layout.data_layers.splice(e._layout_idx,1),delete this.state[e._state_id],delete this.data_layers[t],this._data_layer_ids_by_z_index.splice(this._data_layer_ids_by_z_index.indexOf(t),1),this.applyDataLayerZIndexesToDataLayerLayouts(),this.layout.data_layers.forEach((t,e)=>{this.data_layers[t.id]._layout_idx=e}),this}clearSelections(){return this._data_layer_ids_by_z_index.forEach(t=>{this.data_layers[t].setAllElementStatus("selected",!1)}),this}render(){this.svg.container.attr("transform",`translate(${this.layout.origin.x}, ${this.layout.origin.y})`),this.svg.clipRect.attr("width",this.parent_plot.layout.width).attr("height",this.layout.height);const{cliparea:t}=this.layout,{margin:e}=this.layout;this.inner_border.attr("x",e.left).attr("y",e.top).attr("width",this.parent_plot.layout.width-(e.left+e.right)).attr("height",this.layout.height-(e.top+e.bottom)),this.layout.inner_border&&this.inner_border.style("stroke-width",1).style("stroke",this.layout.inner_border),this.setTitle(),this.generateExtents();const n=function(t,e){const n=Math.pow(-10,e),r=Math.pow(-10,-e),i=Math.pow(10,-e),a=Math.pow(10,e);return t===1/0&&(t=a),t===-1/0&&(t=n),0===t&&(t=i),t>0&&(t=Math.max(Math.min(t,a),i)),t<0&&(t=Math.max(Math.min(t,r),n)),t},r={},i=this.layout.axes;if(this.x_extent){const t={start:0,end:this.layout.cliparea.width};i.x.range&&(t.start=i.x.range.start||t.start,t.end=i.x.range.end||t.end),r.x=[t.start,t.end],r.x_shifted=[t.start,t.end]}if(this.y1_extent){const e={start:t.height,end:0};i.y1.range&&(e.start=i.y1.range.start||e.start,e.end=i.y1.range.end||e.end),r.y1=[e.start,e.end],r.y1_shifted=[e.start,e.end]}if(this.y2_extent){const e={start:t.height,end:0};i.y2.range&&(e.start=i.y2.range.start||e.start,e.end=i.y2.range.end||e.end),r.y2=[e.start,e.end],r.y2_shifted=[e.start,e.end]}let{_interaction:a}=this.parent;const o=a.dragging;if(a.panel_id&&(a.panel_id===this.id||a.linked_panel_ids.includes(this.id))){let i,s=null;if(a.zooming&&"function"==typeof this.x_scale){const n=Math.abs(this.x_extent[1]-this.x_extent[0]),o=Math.round(this.x_scale.invert(r.x_shifted[1]))-Math.round(this.x_scale.invert(r.x_shifted[0]));let s=a.zooming.scale;const u=Math.floor(o*(1/s));s<1&&!isNaN(this.parent.layout.max_region_scale)?s=1/(Math.min(u,this.parent.layout.max_region_scale)/o):s>1&&!isNaN(this.parent.layout.min_region_scale)&&(s=1/(Math.max(u,this.parent.layout.min_region_scale)/o));const l=Math.floor(n*s);i=a.zooming.center-e.left-this.layout.origin.x;const c=i/t.width,h=Math.max(Math.floor(this.x_scale.invert(r.x_shifted[0])-(l-o)*c),1);r.x_shifted=[this.x_scale(h),this.x_scale(h+l)]}else if(o)switch(o.method){case"background":r.x_shifted[0]=+o.dragged_x,r.x_shifted[1]=t.width+o.dragged_x;break;case"x_tick":Je&&Je.shiftKey?(r.x_shifted[0]=+o.dragged_x,r.x_shifted[1]=t.width+o.dragged_x):(i=o.start_x-e.left-this.layout.origin.x,s=n(i/(i+o.dragged_x),3),r.x_shifted[0]=0,r.x_shifted[1]=Math.max(t.width*(1/s),1));break;case"y1_tick":case"y2_tick":{const a=`y${o.method[1]}_shifted`;Je&&Je.shiftKey?(r[a][0]=t.height+o.dragged_y,r[a][1]=+o.dragged_y):(i=t.height-(o.start_y-e.top-this.layout.origin.y),s=n(i/(i-o.dragged_y),3),r[a][0]=t.height,r[a][1]=t.height-t.height*(1/s))}}}if(["x","y1","y2"].forEach(t=>{this[t+"_extent"]&&(this[t+"_scale"]=W_().domain(this[t+"_extent"]).range(r[t+"_shifted"]),this[t+"_extent"]=[this[t+"_scale"].invert(r[t][0]),this[t+"_scale"].invert(r[t][1])],this[t+"_scale"]=W_().domain(this[t+"_extent"]).range(r[t]),this.renderAxis(t))}),this.layout.interaction.scroll_to_zoom){const t=()=>{if(!Je.shiftKey&&!Je.altKey)return void(this.parent._canInteract(this.id)&&this.loader.show("Press <tt>[SHIFT]</tt> or <tt>[ALT]</tt> while scrolling to zoom").hide(1e3));if(Je.preventDefault(),!this.parent._canInteract(this.id))return;const t=xr(this.svg.container.node()),e=Math.max(-1,Math.min(1,Je.wheelDelta||-Je.detail||-Je.deltaY));0!==e&&(this.parent._interaction={panel_id:this.id,linked_panel_ids:this.getLinkedPanelIds("x"),zooming:{scale:e<1?.9:1.1,center:t[0]}},this.render(),a=this.parent._interaction,a.linked_panel_ids.forEach(t=>{this.parent.panels[t].render()}),null!==this._zoom_timeout&&clearTimeout(this._zoom_timeout),this._zoom_timeout=setTimeout(()=>{this.parent._interaction={},this.parent.applyState({start:this.x_extent[0],end:this.x_extent[1]})},500))};this.svg.container.on("wheel.zoom",t).on("mousewheel.zoom",t).on("DOMMouseScroll.zoom",t)}return this._data_layer_ids_by_z_index.forEach(t=>{this.data_layers[t].draw().render()}),this.legend&&this.legend.render(),this}addBasicLoader(t=!0){return this.layout.show_loading_indicator&&this._initialized||(t&&this.loader.show("Loading...").animate(),this.on("data_requested",()=>{this.loader.show("Loading...").animate()}),this.on("data_rendered",()=>{this.loader.hide()}),this.layout.show_loading_indicator=!0),this}applyDataLayerZIndexesToDataLayerLayouts(){this._data_layer_ids_by_z_index.forEach((t,e)=>{this.data_layers[t].layout.z_index=e})}getBaseId(){return`${this.parent.id}.${this.id}`}_getPageOrigin(){const t=this.parent._getPageOrigin();return{x:t.x+this.layout.origin.x,y:t.y+this.layout.origin.y}}initializeLayout(){return this.setDimensions(),this.setOrigin(),this.setMargin(),this.x_range=[0,this.layout.cliparea.width],this.y1_range=[this.layout.cliparea.height,0],this.y2_range=[this.layout.cliparea.height,0],["x","y1","y2"].forEach(t=>{const e=this.layout.axes[t];Object.keys(e).length&&!1!==e.render?(e.render=!0,e.label=e.label||null):e.render=!1}),this.layout.data_layers.forEach(t=>{this.addDataLayer(t)}),this}setDimensions(t,e){const n=this.layout;return void 0!==t&&void 0!==e&&!isNaN(t)&&t>=0&&!isNaN(e)&&e>=0&&(this.parent.layout.width=Math.round(+t),n.height=Math.max(Math.round(+e),n.min_height)),n.cliparea.width=Math.max(this.parent_plot.layout.width-(n.margin.left+n.margin.right),0),n.cliparea.height=Math.max(n.height-(n.margin.top+n.margin.bottom),0),this.svg.clipRect&&this.svg.clipRect.attr("width",this.parent.layout.width).attr("height",n.height),this._initialized&&(this.render(),this.curtain.update(),this.loader.update(),this.toolbar.update(),this.legend&&this.legend.position()),this}setOrigin(t,e){return!isNaN(t)&&t>=0&&(this.layout.origin.x=Math.max(Math.round(+t),0)),!isNaN(e)&&e>=0&&(this.layout.origin.y=Math.max(Math.round(+e),0)),this._initialized&&this.render(),this}setMargin(t,e,n,r){let i;const{cliparea:a,margin:o}=this.layout;return!isNaN(t)&&t>=0&&(o.top=Math.max(Math.round(+t),0)),!isNaN(e)&&e>=0&&(o.right=Math.max(Math.round(+e),0)),!isNaN(n)&&n>=0&&(o.bottom=Math.max(Math.round(+n),0)),!isNaN(r)&&r>=0&&(o.left=Math.max(Math.round(+r),0)),o.top+o.bottom>this.layout.height&&(i=Math.floor((o.top+o.bottom-this.layout.height)/2),o.top-=i,o.bottom-=i),o.left+o.right>this.parent_plot.layout.width&&(i=Math.floor((o.left+o.right-this.parent_plot.layout.width)/2),o.left-=i,o.right-=i),["top","right","bottom","left"].forEach(t=>{o[t]=Math.max(o[t],0)}),a.width=Math.max(this.parent_plot.layout.width-(o.left+o.right),0),a.height=Math.max(this.layout.height-(o.top+o.bottom),0),a.origin.x=o.left,a.origin.y=o.top,this._initialized&&this.render(),this}initialize(){const t=this.getBaseId();this.svg.container=this.parent.svg.append("g").attr("id",t+".panel_container").attr("transform",`translate(${this.layout.origin.x||0}, ${this.layout.origin.y||0})`);const e=this.svg.container.append("clipPath").attr("id",t+".clip");if(this.svg.clipRect=e.append("rect").attr("width",this.parent_plot.layout.width).attr("height",this.layout.height),this.svg.group=this.svg.container.append("g").attr("id",t+".panel").attr("clip-path",`url(#${t}.clip)`),this.curtain=Wk.call(this),this.loader=Jk.call(this),this.layout.show_loading_indicator&&this.addBasicLoader(!1),this.toolbar=new mE(this),this.inner_border=this.svg.group.append("rect").attr("class","lz-panel-background").on("click",()=>{"clear_selections"===this.layout.background_click&&this.clearSelections()}),this.title=this.svg.group.append("text").attr("class","lz-panel-title"),void 0!==this.layout.title&&this.setTitle(),this.svg.x_axis=this.svg.group.append("g").attr("id",t+".x_axis").attr("class","lz-x lz-axis"),this.layout.axes.x.render&&(this.svg.x_axis_label=this.svg.x_axis.append("text").attr("class","lz-x lz-axis lz-label").attr("text-anchor","middle")),this.svg.y1_axis=this.svg.group.append("g").attr("id",t+".y1_axis").attr("class","lz-y lz-y1 lz-axis"),this.layout.axes.y1.render&&(this.svg.y1_axis_label=this.svg.y1_axis.append("text").attr("class","lz-y1 lz-axis lz-label").attr("text-anchor","middle")),this.svg.y2_axis=this.svg.group.append("g").attr("id",t+".y2_axis").attr("class","lz-y lz-y2 lz-axis"),this.layout.axes.y2.render&&(this.svg.y2_axis_label=this.svg.y2_axis.append("text").attr("class","lz-y2 lz-axis lz-label").attr("text-anchor","middle")),this._data_layer_ids_by_z_index.forEach(t=>{this.data_layers[t].initialize()}),this.legend=null,this.layout.legend&&(this.legend=new vE(this)),this.layout.interaction.drag_background_to_pan){const t=`.${this.parent.id}.${this.id}.interaction.drag`,e=()=>this.parent.startDrag(this,"background");this.svg.container.select(".lz-panel-background").on(`mousedown${t}.background`,e).on(`touchstart${t}.background`,e)}return this}resortDataLayers(){const t=[];this._data_layer_ids_by_z_index.forEach(e=>{t.push(this.data_layers[e].layout.z_index)}),this.svg.group.selectAll("g.lz-data_layer-container").data(t).sort(G),this.applyDataLayerZIndexesToDataLayerLayouts()}getLinkedPanelIds(t){const e=[];return["x","y1","y2"].includes(t=t||null)&&this.layout.interaction[t+"_linked"]?(this.parent._panel_ids_by_y_index.forEach(n=>{n!==this.id&&this.parent.panels[n].layout.interaction[t+"_linked"]&&e.push(n)}),e):e}moveUp(){const{parent:t}=this,e=this.layout.y_index;return t._panel_ids_by_y_index[e-1]&&(t._panel_ids_by_y_index[e]=t._panel_ids_by_y_index[e-1],t._panel_ids_by_y_index[e-1]=this.id,t.applyPanelYIndexesToPanelLayouts(),t.positionPanels()),this}moveDown(){const{_panel_ids_by_y_index:t}=this.parent;return t[this.layout.y_index+1]&&(t[this.layout.y_index]=t[this.layout.y_index+1],t[this.layout.y_index+1]=this.id,this.parent.applyPanelYIndexesToPanelLayouts(),this.parent.positionPanels()),this}reMap(){this.emit("data_requested"),this._data_promises=[],this.curtain.hide();for(let t in this.data_layers)try{this._data_promises.push(this.data_layers[t].reMap())}catch(t){console.error(t),this.curtain.show(t.message||t)}return Promise.all(this._data_promises).then(()=>{this._initialized=!0,this.render(),this.emit("layout_changed",!0),this.emit("data_rendered")}).catch(t=>{console.error(t),this.curtain.show(t.message||t)})}generateExtents(){["x","y1","y2"].forEach(t=>{this[t+"_extent"]=null});for(let t in this.data_layers){const e=this.data_layers[t];if(e.layout.x_axis&&!e.layout.x_axis.decoupled&&(this.x_extent=at((this.x_extent||[]).concat(e.getAxisExtent("x")))),e.layout.y_axis&&!e.layout.y_axis.decoupled){const t="y"+e.layout.y_axis.axis;this[t+"_extent"]=at((this[t+"_extent"]||[]).concat(e.getAxisExtent("y")))}}return this.layout.axes.x&&"state"===this.layout.axes.x.extent&&(this.x_extent=[this.state.start,this.state.end]),this}generateTicks(t){if(this.layout.axes[t].ticks){const e=this.layout.axes[t].ticks;if(Array.isArray(e))return e;if("object"==typeof e){const n=this,r={position:e.position};return this._data_layer_ids_by_z_index.reduce((e,i)=>{const a=n.data_layers[i];return e.concat(a.getTicks(t,r))},[]).map(t=>{let n={};return n=qk(n,e),qk(n,t)})}}return this[t+"_extent"]?function(t,e,n){(void 0===n||isNaN(parseInt(n)))&&(n=5);const r=(n=+n)/3,i=Math.abs(t[0]-t[1]);let a=i/n;Math.log(i)/Math.LN10<-2&&(a=.75*Math.max(Math.abs(i))/r);const o=Math.pow(10,Math.floor(Math.log(a)/Math.LN10));let s=0;o<1&&0!==o&&(s=Math.abs(Math.round(Math.log(o)/Math.LN10)));let u=o;2*o-a<1.5*(a-u)&&(u=2*o,5*o-a<2.75*(a-u)&&(u=5*o,10*o-a<1.5*(a-u)&&(u=10*o)));let l=[],c=parseFloat((Math.floor(t[0]/u)*u).toFixed(s));for(;c<t[1];)l.push(c),c+=u,s>0&&(c=parseFloat(c.toFixed(s)));l.push(c),(void 0===e||-1===["low","high","both","neither"].indexOf(e))&&(e="neither");"low"!==e&&"both"!==e||l[0]<t[0]&&(l=l.slice(1));"high"!==e&&"both"!==e||l[l.length-1]>t[1]&&l.pop();return l}(this[t+"_extent"],"both"):[]}renderAxis(t){if(!["x","y1","y2"].includes(t))throw new Error("Unable to render axis; invalid axis identifier: "+t);const e=this.layout.axes[t].render&&"function"==typeof this[t+"_scale"]&&!isNaN(this[t+"_scale"](0));if(this[t+"_axis"]&&this.svg.container.select("g.lz-axis.lz-"+t).style("display",e?null:"none"),!e)return this;const n={x:{position:`translate(${this.layout.margin.left}, ${this.layout.height-this.layout.margin.bottom})`,orientation:"bottom",label_x:this.layout.cliparea.width/2,label_y:this.layout.axes[t].label_offset||0,label_rotate:null},y1:{position:`translate(${this.layout.margin.left}, ${this.layout.margin.top})`,orientation:"left",label_x:-1*(this.layout.axes[t].label_offset||0),label_y:this.layout.cliparea.height/2,label_rotate:-90},y2:{position:`translate(${this.parent_plot.layout.width-this.layout.margin.right}, ${this.layout.margin.top})`,orientation:"right",label_x:this.layout.axes[t].label_offset||0,label_y:this.layout.cliparea.height/2,label_rotate:-90}};this[t+"_ticks"]=this.generateTicks(t);const r=(t=>{for(let e=0;e<t.length;e++)if(isNaN(t[e]))return!1;return!0})(this[t+"_ticks"]);let i;switch(n[t].orientation){case"right":i=Yt;break;case"left":i=Gt;break;case"bottom":i=Ht;break;default:throw new Error("Unrecognized axis orientation")}if(this[t+"_axis"]=i(this[t+"_scale"]).tickPadding(3),r)this[t+"_axis"].tickValues(this[t+"_ticks"]),"region"===this.layout.axes[t].tick_format&&this[t+"_axis"].tickFormat(t=>EE(t,6));else{let e=this[t+"_ticks"].map(e=>e[t.substr(0,1)]);this[t+"_axis"].tickValues(e).tickFormat((e,n)=>this[t+"_ticks"][n].text)}if(this.svg[t+"_axis"].attr("transform",n[t].position).call(this[t+"_axis"]),!r){const e=ax(`g#${this.getBaseId().replace(".","\\.")}\\.${t}_axis g.tick`),n=this;e.each((function(e,r){const i=fn(this).select("text");n[t+"_ticks"][r].style&&Kk(i,n[t+"_ticks"][r].style),n[t+"_ticks"][r].transform&&i.attr("transform",n[t+"_ticks"][r].transform)}))}const a=this.layout.axes[t].label||null;return null!==a&&(this.svg[t+"_axis_label"].attr("x",n[t].label_x).attr("y",n[t].label_y).text(zE(a,this.state)).attr("fill","currentColor"),null!==n[t].label_rotate&&this.svg[t+"_axis_label"].attr("transform",`rotate(${n[t].label_rotate} ${n[t].label_x}, ${n[t].label_y})`)),["x","y1","y2"].forEach(t=>{if(this.layout.interaction[`drag_${t}_ticks_to_scale`]){const e=`.${this.parent.id}.${this.id}.interaction.drag`,n=function(){"function"==typeof fn(this).node().focus&&fn(this).node().focus();let r="x"===t?"ew-resize":"ns-resize";Je&&Je.shiftKey&&(r="move"),fn(this).style("font-weight","bold").style("cursor",r).on("keydown"+e,n).on("keyup"+e,n)};this.svg.container.selectAll(`.lz-axis.lz-${t} .tick text`).attr("tabindex",0).on("mouseover"+e,n).on("mouseout"+e,(function(){fn(this).style("font-weight","normal").on("keydown"+e,null).on("keyup"+e,null)})).on("mousedown"+e,()=>{this.parent.startDrag(this,t+"_tick")})}}),this}scaleHeightToData(t){null===(t=+t||null)&&this._data_layer_ids_by_z_index.forEach(e=>{const n=this.data_layers[e].getAbsoluteDataHeight();+n&&(t=null===t?+n:Math.max(t,+n))}),+t&&(t+=+this.layout.margin.top+ +this.layout.margin.bottom,this.setDimensions(this.parent_plot.layout.width,t),this.parent.setDimensions(),this.parent.positionPanels())}setAllElementStatus(t,e){this._data_layer_ids_by_z_index.forEach(n=>{this.data_layers[n].setAllElementStatus(t,e)})}}Mk.verbs.forEach((t,e)=>{const n=Mk.adjectives[e],r="un"+t;wE.prototype[t+"AllElements"]=function(){return this.setAllElementStatus(n,!0),this},wE.prototype[r+"AllElements"]=function(){return this.setAllElementStatus(n,!1),this}});const ME={state:{},width:800,min_width:400,min_region_scale:null,max_region_scale:null,responsive_resize:!1,panels:[],toolbar:{widgets:[]},panel_boundaries:!0,mouse_guide:!0};class kE{constructor(t,e,n){this._initialized=!1,this.parent_plot=this,this.id=t,this.container=null,this.svg=null,this.panels={},this._panel_ids_by_y_index=[],this._remap_promises=[],this.layout=n,qk(this.layout,ME),this._base_layout=Fk(this.layout),this.state=this.layout.state,this.lzd=new Zk(e),this._external_listeners=new Map,this._event_hooks={},this._interaction={},this.initializeLayout()}on(t,e){if("string"!=typeof t)throw new Error("Unable to register event hook. Event name must be a string: "+t.toString());if("function"!=typeof e)throw new Error("Unable to register event hook, invalid hook function passed");return this._event_hooks[t]||(this._event_hooks[t]=[]),this._event_hooks[t].push(e),e}off(t,e){const n=this._event_hooks[t];if("string"!=typeof t||!Array.isArray(n))throw new Error("Unable to remove event hook, invalid event: "+t.toString());if(void 0===e)this._event_hooks[t]=[];else{const t=n.indexOf(e);if(-1===t)throw new Error("The specified event listener is not registered and therefore cannot be removed");n.splice(t,1)}return this}emit(t,e){const n=this._event_hooks[t];if("string"!=typeof t)throw new Error("LocusZoom attempted to throw an invalid event: "+t.toString());if(!n&&!this._event_hooks.any_lz_event)return this;const r=this.getBaseId();let i;if(i=e&&e.sourceID?e:{sourceID:r,target:this,data:e||null},n&&n.forEach(t=>{t.call(this,i)}),"any_lz_event"!==t){const e=Object.assign({event_name:t},i);this.emit("any_lz_event",e)}return this}addPanel(t){if("object"!=typeof t)throw new Error("Invalid panel layout");const e=new wE(t,this);if(this.panels[e.id]=e,null!==e.layout.y_index&&!isNaN(e.layout.y_index)&&this._panel_ids_by_y_index.length>0)e.layout.y_index<0&&(e.layout.y_index=Math.max(this._panel_ids_by_y_index.length+e.layout.y_index,0)),this._panel_ids_by_y_index.splice(e.layout.y_index,0,e.id),this.applyPanelYIndexesToPanelLayouts();else{const t=this._panel_ids_by_y_index.push(e.id);this.panels[e.id].layout.y_index=t-1}let n=null;return this.layout.panels.forEach((t,r)=>{t.id===e.id&&(n=r)}),null===n&&(n=this.layout.panels.push(this.panels[e.id].layout)-1),this.panels[e.id]._layout_idx=n,this._initialized&&(this.positionPanels(),this.panels[e.id].initialize(),this.panels[e.id].reMap(),this.setDimensions(this.layout.width,this._total_height)),this.panels[e.id]}clearPanelData(t,e){let n;return e=e||"wipe",n=t?[t]:Object.keys(this.panels),n.forEach(t=>{this.panels[t]._data_layer_ids_by_z_index.forEach(n=>{const r=this.panels[t].data_layers[n];r.destroyAllTooltips(),delete r._layer_state,delete this.layout.state[r._state_id],"reset"===e&&r._setDefaultState()})}),this}removePanel(t){const e=this.panels[t];if(!e)throw new Error("Unable to remove panel, ID not found: "+t);return this._panel_boundaries.hide(),this.clearPanelData(t),e.loader.hide(),e.toolbar.destroy(!0),e.curtain.hide(),e.svg.container&&e.svg.container.remove(),this.layout.panels.splice(e._layout_idx,1),delete this.panels[t],delete this.layout.state[t],this.layout.panels.forEach((t,e)=>{this.panels[t.id]._layout_idx=e}),this._panel_ids_by_y_index.splice(this._panel_ids_by_y_index.indexOf(t),1),this.applyPanelYIndexesToPanelLayouts(),this._initialized&&(this.positionPanels(),this.setDimensions(this.layout.width,this._total_height)),this.emit("panel_removed",t),this}refresh(){return this.applyState()}subscribeToData(t,e){const{from_layer:n,namespace:r,data_operations:i,onerror:a}=t,o=a||function(t){console.error("An error occurred while acting on an external callback",t)};if(n){const t=this.getBaseId()+".",r=n.startsWith(t)?n:`${t}${n}`;let i=!1;for(let t of Object.values(this.panels))if(i=Object.values(t.data_layers).some(t=>t.getBaseId()===r),i)break;if(!i)throw new Error("Could not subscribe to unknown data layer "+r);const a=t=>{if(t.data.layer===r)try{e(t.data.content,this)}catch(t){o(t)}};return this.on("data_from_layer",a),a}if(!r)throw new Error("subscribeToData must specify the desired data: either 'from_layer' or 'namespace' option");const[s,u]=this.lzd.config_to_sources(r,i),l=()=>{try{this.lzd.getData(this.state,s,u).then(t=>e(t,this)).catch(o)}catch(t){o(t)}};return this.on("data_rendered",l),l}applyState(t){if("object"!=typeof(t=t||{}))throw new Error(`applyState only accepts an object; ${typeof t} given`);let e={chr:this.state.chr,start:this.state.start,end:this.state.end};for(let n in t)e[n]=t[n];e=function(t,e){e=e||{};let n,r=!1,i=null;if(void 0!==(t=t||{}).chr&&void 0!==t.start&&void 0!==t.end){if(t.start=Math.max(parseInt(t.start),1),t.end=Math.max(parseInt(t.end),1),isNaN(t.start)&&isNaN(t.end))t.start=1,t.end=1,i=.5,n=0;else if(isNaN(t.start)||isNaN(t.end))i=t.start||t.end,n=0,t.start=isNaN(t.start)?t.end:t.start,t.end=isNaN(t.end)?t.start:t.end;else{if(i=Math.round((t.start+t.end)/2),n=t.end-t.start,n<0){const e=t.start;t.end=t.start,t.start=e,n=t.end-t.start}i<0&&(t.start=1,t.end=1,n=0)}r=!0}return e.min_region_scale&&r&&n<e.min_region_scale&&(t.start=Math.max(i-Math.floor(e.min_region_scale/2),1),t.end=t.start+e.min_region_scale),e.max_region_scale&&r&&n>e.max_region_scale&&(t.start=Math.max(i-Math.floor(e.max_region_scale/2),1),t.end=t.start+e.max_region_scale),t}(e,this.layout);for(let t in e)this.state[t]=e[t];this.emit("data_requested"),this._remap_promises=[],this.loading_data=!0;for(let t in this.panels)this._remap_promises.push(this.panels[t].reMap());return Promise.all(this._remap_promises).catch(t=>{console.error(t),this.curtain.show(t.message||t),this.loading_data=!1}).then(()=>{this.toolbar.update(),this._panel_ids_by_y_index.forEach(t=>{const e=this.panels[t];e.toolbar.update(),e._data_layer_ids_by_z_index.forEach(t=>{e.data_layers[t].applyAllElementStatus()})}),this.emit("layout_changed"),this.emit("data_rendered"),this.emit("state_changed",t);const{chr:e,start:n,end:r}=this.state;Object.keys(t).some(t=>["chr","start","end"].includes(t))&&this.emit("region_changed",{chr:e,start:n,end:r}),this.loading_data=!1})}trackExternalListener(t,e,n){this._external_listeners.has(t)||this._external_listeners.set(t,new Map);const r=this._external_listeners.get(t),i=r.get(e)||[];i.includes(n)||i.push(n),r.set(e,i)}destroy(){for(let[t,e]of this._external_listeners.entries())for(let[n,r]of e)for(let e of r)t.removeEventListener(n,e);const t=this.svg.node().parentNode;if(!t)throw new Error("Plot has already been removed");for(;t.lastElementChild;)t.removeChild(t.lastElementChild);t.outerHTML=t.outerHTML,this._initialized=!1,this.svg=null,this.panels=null}mutateLayout(){Object.values(this.panels).forEach(t=>{Object.values(t.data_layers).forEach(t=>t.mutateLayout())})}_canInteract(t){t=t||null;const{_interaction:e}=this;return t?(void 0===e.panel_id||e.panel_id===t)&&!this.loading_data:!(e.dragging||e.zooming||this.loading_data)}_getPageOrigin(){const t=this.svg.node().getBoundingClientRect();let e=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop,r=this.svg.node();for(;null!==r.parentNode;)if(r=r.parentNode,r!==document&&"static"!==fn(r).style("position")){e=-1*r.getBoundingClientRect().left,n=-1*r.getBoundingClientRect().top;break}return{x:e+t.left,y:n+t.top,width:t.width,height:t.height}}getContainerOffset(){const t={top:0,left:0};let e=this.container.offsetParent||null;for(;null!==e;)t.top+=e.offsetTop,t.left+=e.offsetLeft,e=e.offsetParent||null;return t}applyPanelYIndexesToPanelLayouts(){this._panel_ids_by_y_index.forEach((t,e)=>{this.panels[t].layout.y_index=e})}getBaseId(){return this.id}rescaleSVG(){const t=this.svg.node().getBoundingClientRect();return this.setDimensions(t.width,t.height),this}initializeLayout(){if(isNaN(this.layout.width)||this.layout.width<=0)throw new Error("Plot layout parameter `width` must be a positive number");return this.layout.responsive_resize=!!this.layout.responsive_resize,this.layout.panels.forEach(t=>{this.addPanel(t)}),this}setDimensions(t,e){if(!isNaN(t)&&t>=0&&!isNaN(e)&&e>=0){const n=e/this._total_height;this.layout.width=Math.max(Math.round(+t),this.layout.min_width),this.layout.responsive_resize&&this.svg&&(this.layout.width=Math.max(this.svg.node().parentNode.getBoundingClientRect().width,this.layout.min_width));let r=0;this._panel_ids_by_y_index.forEach(t=>{const e=this.panels[t],i=this.layout.width,a=e.layout.height*n;e.setDimensions(i,a),e.setOrigin(0,r),r+=a,e.toolbar.update()})}const n=this._total_height;return null!==this.svg&&(this.svg.attr("viewBox",`0 0 ${this.layout.width} ${n}`),this.svg.attr("width",this.layout.width).attr("height",n)),this._initialized&&(this._panel_boundaries.position(),this.toolbar.update(),this.curtain.update(),this.loader.update()),this.emit("layout_changed")}positionPanels(){const t={left:0,right:0};for(let e of Object.values(this.panels))e.layout.interaction.x_linked&&(t.left=Math.max(t.left,e.layout.margin.left),t.right=Math.max(t.right,e.layout.margin.right));let e=0;return this._panel_ids_by_y_index.forEach(n=>{const r=this.panels[n],i=r.layout;if(r.setOrigin(0,e),e+=this.panels[n].layout.height,i.interaction.x_linked){const e=Math.max(t.left-i.margin.left,0)+Math.max(t.right-i.margin.right,0);i.width+=e,i.margin.left=t.left,i.margin.right=t.right,i.cliparea.origin.x=t.left}}),this.setDimensions(),this._panel_ids_by_y_index.forEach(t=>{const e=this.panels[t];e.setDimensions(this.layout.width,e.layout.height)}),this}initialize(){if(this.layout.responsive_resize){fn(this.container).classed("lz-container-responsive",!0);const t=()=>window.requestAnimationFrame(()=>this.rescaleSVG());if(window.addEventListener("resize",t),this.trackExternalListener(window,"resize",t),"undefined"!=typeof IntersectionObserver){const t={root:document.documentElement,threshold:.9};new IntersectionObserver((t,e)=>{t.some(t=>t.intersectionRatio>0)&&this.rescaleSVG()},t).observe(this.container)}const e=()=>this.setDimensions();window.addEventListener("load",e),this.trackExternalListener(window,"load",e)}if(this.layout.mouse_guide){const t=this.svg.append("g").attr("class","lz-mouse_guide").attr("id",this.id+".mouse_guide"),e=t.append("rect").attr("class","lz-mouse_guide-vertical").attr("x",-1),n=t.append("rect").attr("class","lz-mouse_guide-horizontal").attr("y",-1);this._mouse_guide={svg:t,vertical:e,horizontal:n}}this.curtain=Wk.call(this),this.loader=Jk.call(this),this._panel_boundaries={parent:this,hide_timeout:null,showing:!1,dragging:!1,selectors:[],corner_selector:null,show:function(){if(!this.showing&&!this.parent.curtain.showing){this.showing=!0,this.parent._panel_ids_by_y_index.forEach((t,e)=>{const n=fn(this.parent.svg.node().parentNode).insert("div",".lz-data_layer-tooltip").attr("class","lz-panel-boundary").attr("title","Resize panel");n.append("span");const r=Fo();r.on("start",()=>{this.dragging=!0}),r.on("end",()=>{this.dragging=!1}),r.on("drag",()=>{const t=this.parent.panels[this.parent._panel_ids_by_y_index[e]],n=t.layout.height;t.setDimensions(this.parent.layout.width,t.layout.height+Je.dy);const r=t.layout.height-n;this.parent._panel_ids_by_y_index.forEach((t,n)=>{const i=this.parent.panels[this.parent._panel_ids_by_y_index[n]];n>e&&(i.setOrigin(i.layout.origin.x,i.layout.origin.y+r),i.toolbar.position())}),this.parent.positionPanels(),this.position()}),n.call(r),this.parent._panel_boundaries.selectors.push(n)});const t=fn(this.parent.svg.node().parentNode).insert("div",".lz-data_layer-tooltip").attr("class","lz-panel-corner-boundary").attr("title","Resize plot");t.append("span").attr("class","lz-panel-corner-boundary-outer"),t.append("span").attr("class","lz-panel-corner-boundary-inner");const e=Fo();e.on("start",()=>{this.dragging=!0}),e.on("end",()=>{this.dragging=!1}),e.on("drag",()=>{this.parent.setDimensions(this.parent.layout.width+Je.dx,this.parent._total_height+Je.dy)}),t.call(e),this.parent._panel_boundaries.corner_selector=t}return this.position()},position:function(){if(!this.showing)return this;const t=this.parent._getPageOrigin();this.selectors.forEach((e,n)=>{const r=this.parent.panels[this.parent._panel_ids_by_y_index[n]],i=r._getPageOrigin(),a=t.x,o=i.y+r.layout.height-12,s=this.parent.layout.width-1;e.style("top",o+"px").style("left",a+"px").style("width",s+"px"),e.select("span").style("width",s+"px")});return this.corner_selector.style("top",t.y+this.parent._total_height-10-16+"px").style("left",t.x+this.parent.layout.width-10-16+"px"),this},hide:function(){return this.showing?(this.showing=!1,this.selectors.forEach(t=>{t.remove()}),this.selectors=[],this.corner_selector.remove(),this.corner_selector=null,this):this}},this.layout.panel_boundaries&&fn(this.svg.node().parentNode).on(`mouseover.${this.id}.panel_boundaries`,()=>{clearTimeout(this._panel_boundaries.hide_timeout),this._panel_boundaries.show()}).on(`mouseout.${this.id}.panel_boundaries`,()=>{this._panel_boundaries.hide_timeout=setTimeout(()=>{this._panel_boundaries.hide()},300)}),this.toolbar=new mE(this).show();for(let t in this.panels)this.panels[t].initialize();const t="."+this.id;if(this.layout.mouse_guide){const e=()=>{this._mouse_guide.vertical.attr("x",-1),this._mouse_guide.horizontal.attr("y",-1)},n=()=>{const t=xr(this.svg.node());this._mouse_guide.vertical.attr("x",t[0]),this._mouse_guide.horizontal.attr("y",t[1])};this.svg.on(`mouseout${t}-mouse_guide`,e).on(`touchleave${t}-mouse_guide`,e).on(`mousemove${t}-mouse_guide`,n)}const e=()=>{this.stopDrag()},n=()=>{const{_interaction:t}=this;if(t.dragging){const e=xr(this.svg.node());Je&&Je.preventDefault(),t.dragging.dragged_x=e[0]-t.dragging.start_x,t.dragging.dragged_y=e[1]-t.dragging.start_y,this.panels[t.panel_id].render(),t.linked_panel_ids.forEach(t=>{this.panels[t].render()})}};this.svg.on("mouseup"+t,e).on("touchend"+t,e).on("mousemove"+t,n).on("touchmove"+t,n);const r=fn("body").node();r&&(r.addEventListener("mouseup",e),r.addEventListener("touchend",e),this.trackExternalListener(r,"mouseup",e),this.trackExternalListener(r,"touchend",e)),this.on("match_requested",t=>{const e=t.data,n=e.active?e.value:null,r=t.target.id;Object.values(this.panels).forEach(t=>{t.id!==r&&Object.values(t.data_layers).forEach(t=>t.destroyAllTooltips(!1))}),this.applyState({lz_match_value:n})}),this._initialized=!0;const i=this.svg.node().getBoundingClientRect(),a=i.width?i.width:this.layout.width,o=i.height?i.height:this._total_height;return this.setDimensions(a,o),this}startDrag(t,e){t=t||null;let n=null;switch(e=e||null){case"background":case"x_tick":n="x";break;case"y1_tick":n="y1";break;case"y2_tick":n="y2"}if(!(t instanceof wE&&n&&this._canInteract()))return this.stopDrag();const r=xr(this.svg.node());return this._interaction={panel_id:t.id,linked_panel_ids:t.getLinkedPanelIds(n),dragging:{method:e,start_x:r[0],start_y:r[1],dragged_x:0,dragged_y:0,axis:n}},this.svg.style("cursor","all-scroll"),this}stopDrag(){const{_interaction:t}=this;if(!t.dragging)return this;if("object"!=typeof this.panels[t.panel_id])return this._interaction={},this;const e=this.panels[t.panel_id],n=(t,n,r)=>{e._data_layer_ids_by_z_index.forEach(i=>{const a=e.data_layers[i].layout[t+"_axis"];a.axis===n&&(a.floor=r[0],a.ceiling=r[1],delete a.lower_buffer,delete a.upper_buffer,delete a.min_extent,delete a.ticks)})};switch(t.dragging.method){case"background":case"x_tick":0!==t.dragging.dragged_x&&(n("x",1,e.x_extent),this.applyState({start:e.x_extent[0],end:e.x_extent[1]}));break;case"y1_tick":case"y2_tick":if(0!==t.dragging.dragged_y){const r=parseInt(t.dragging.method[1]);n("y",r,e[`y${r}_extent`])}}return this._interaction={},this.svg.style("cursor",null),this}get _total_height(){return this.layout.panels.reduce((t,e)=>e.height+t,0)}}function EE(t,e,n){const r={0:"",3:"K",6:"M",9:"G"};if(n=n||!1,isNaN(e)||null===e){const n=Math.log(t)/Math.LN10;e=Math.min(Math.max(n-n%3,0),9)}const i=e-Math.floor((Math.log(t)/Math.LN10).toFixed(e+3)),a=Math.min(Math.max(e,0),2),o=Math.min(Math.max(i,a),12);let s=""+(t/Math.pow(10,e)).toFixed(o);return n&&void 0!==r[e]&&(s+=` ${r[e]}b`),s}function SE(t){let e=t.toUpperCase();e=e.replace(/,/g,"");const n=/([KMG])[B]*$/,r=n.exec(e);let i=1;return r&&(i="M"===r[1]?1e6:"G"===r[1]?1e9:1e3,e=e.replace(n,"")),e=Number(e)*i,e}function zE(t,e,n){if("object"!=typeof e)throw new Error("invalid arguments: data is not an object");if("string"!=typeof t)throw new Error("invalid arguments: html is not a string");const r=[],i=/{{(?:(#if )?([\w+_:|]+)|(#else)|(\/if))}}/;for(;t.length>0;){const e=i.exec(t);e?0!==e.index?(r.push({text:t.slice(0,e.index)}),t=t.slice(e.index)):"#if "===e[1]?(r.push({condition:e[2]}),t=t.slice(e[0].length)):e[2]?(r.push({variable:e[2]}),t=t.slice(e[0].length)):"#else"===e[3]?(r.push({branch:"else"}),t=t.slice(e[0].length)):"/if"===e[4]?(r.push({close:"if"}),t=t.slice(e[0].length)):(console.error(`Error tokenizing tooltip when remaining template is ${JSON.stringify(t)} and previous tokens are ${JSON.stringify(r)} and current regex match is ${JSON.stringify([e[1],e[2],e[3]])}`),t=t.slice(e[0].length)):(r.push({text:t}),t="")}const a=function(){const t=r.shift();if(void 0!==t.text||t.variable)return t;if(t.condition){let e=t.then=[];for(t.else=[];r.length>0;){if("if"===r[0].close){r.shift();break}"else"===r[0].branch&&(r.shift(),e=t.else),e.push(a())}return t}return console.error("Error making tooltip AST due to unknown token "+JSON.stringify(t)),{text:""}},o=[];for(;r.length>0;)o.push(a());const s=function(t){return Object.prototype.hasOwnProperty.call(s.cache,t)||(s.cache[t]=new Rk(t).resolve(e,n)),s.cache[t]};s.cache={};const u=function(t){if(void 0!==t.text)return t.text;if(t.variable){try{const e=s(t.variable);if(-1!==["string","number","boolean"].indexOf(typeof e))return e;if(null===e)return""}catch(e){console.error("Error while processing variable "+JSON.stringify(t.variable))}return`{{${t.variable}}}`}if(t.condition){try{if(s(t.condition))return t.then.map(u).join("");if(t.else)return t.else.map(u).join("")}catch(e){console.error("Error while processing condition "+JSON.stringify(t.variable))}return""}console.error("Error rendering tooltip due to unknown AST node "+JSON.stringify(t))};return o.map(u).join("")}const NE=new _;NE.add("=",(t,e)=>t===e),NE.add("!=",(t,e)=>t!=e),NE.add("<",(t,e)=>t<e),NE.add("<=",(t,e)=>t<=e),NE.add(">",(t,e)=>t>e),NE.add(">=",(t,e)=>t>=e),NE.add("%",(t,e)=>t%e),NE.add("in",(t,e)=>e&&e.includes(t)),NE.add("match",(t,e)=>t&&t.includes(e));var TE=NE;const AE=(t,e)=>void 0===e||t.field_value!==e?void 0!==t.else?t.else:null:t.then,CE=(t,e)=>{const n=t.breaks||[],r=t.values||[];if(null==e||isNaN(+e))return t.null_value?t.null_value:null;const i=n.reduce((function(t,n){return+e<t||+e>=t&&+e<n?t:n}));return r[n.indexOf(i)]},PE=(t,e)=>void 0!==e&&t.categories.includes(e)?t.values[t.categories.indexOf(e)]:t.null_value?t.null_value:null,RE=(t,e,n)=>{const r=t.values;return r[n%r.length]};let OE=(t,e,n)=>{const r=t._cache=t._cache||new Map,i=t.max_cache_size||500;if(r.size>=i&&r.clear(),r.has(e))return r.get(e);let a=0;e=String(e);for(let t=0;t<e.length;t++){a=(a<<5)-a+e.charCodeAt(t),a|=0}const o=t.values,s=o[Math.abs(a)%o.length];return r.set(e,s),s};const LE=(t,e)=>{var n=t.breaks||[],r=t.values||[],i=t.null_value?t.null_value:null;if(n.length<2||n.length!==r.length)return i;if(null==e||isNaN(+e))return i;if(+e<=t.breaks[0])return r[0];if(+e>=t.breaks[t.breaks.length-1])return r[n.length-1];{var a=null;if(n.forEach((function(t,r){r&&n[r-1]<=+e&&n[r]>=+e&&(a=r)})),null===a)return i;const t=(+e-n[a-1])/(n[a]-n[a-1]);return isFinite(t)?yr(r[a-1],r[a])(t):i}};function DE(t,e){if(void 0===e)return null;const{beta_field:n,stderr_beta_field:r,"+":i=null,"-":a=null}=t;if(!n||!r)throw new Error("effect_direction must specify how to find required 'beta' and 'stderr_beta' fields");const o=e[n],s=e[r];if(void 0!==o)if(void 0!==s){if(o-1.96*s>0)return i;if(o+1.96*s<0)return a||null}else{if(o>0)return i;if(o<0)return a}return null}const jE=new _;for(let[t,e]of Object.entries(u))jE.add(t,e);jE.add("if",AE);var $E=jE;const IE={id:"",type:"",tag:"custom_data_type",namespace:{},data_operations:[],id_field:"id",filters:null,match:{},x_axis:{},y_axis:{},legend:null,tooltip:{},tooltip_positioning:"horizontal",behaviors:{}};class BE{constructor(t,e){this._initialized=!1,this._layout_idx=null,this.id=null,this._base_id=null,this.parent=e||null,this.svg={},this.parent_plot=null,e&&(this.parent_plot=e.parent),this.layout=qk(t||{},IE),this.layout.id&&(this.id=this.layout.id),this._filter_func=null,this.layout.x_axis!=={}&&"number"!=typeof this.layout.x_axis.axis&&(this.layout.x_axis.axis=1),this.layout.y_axis!=={}&&"number"!=typeof this.layout.y_axis.axis&&(this.layout.y_axis.axis=1),this._base_layout=Fk(this.layout),this.state={},this._state_id=null,this._layer_state=null,this._setDefaultState(),this.data=[],this.layout.tooltip&&(this._tooltips={}),this._global_statuses={highlighted:!1,selected:!1,faded:!1,hidden:!1},this._data_contract=new Set,this._entities=new Map,this._dependencies=[],this.mutateLayout()}render(){throw new Error("Method must be implemented")}moveForward(){const t=this.parent._data_layer_ids_by_z_index,e=this.layout.z_index;return t[e+1]&&(t[e]=t[e+1],t[e+1]=this.id,this.parent.resortDataLayers()),this}moveBack(){const t=this.parent._data_layer_ids_by_z_index,e=this.layout.z_index;return t[e-1]&&(t[e]=t[e-1],t[e-1]=this.id,this.parent.resortDataLayers()),this}setElementAnnotation(t,e,n){const r=this.getElementId(t);return this._layer_state.extra_fields[r]||(this._layer_state.extra_fields[r]={}),this._layer_state.extra_fields[r][e]=n,this}setFilter(t){console.warn("The setFilter method is deprecated and will be removed in the future; please use the layout API with a custom filter function instead"),this._filter_func=t}mutateLayout(){if(this.parent_plot){const{namespace:t,data_operations:e}=this.layout;this._data_contract=Hk(this.layout,Object.keys(t));const[n,r]=this.parent_plot.lzd.config_to_sources(t,e,this);this._entities=n,this._dependencies=r}}_getDataExtent(t,e){return t=t||this.data,at(t,t=>+new Rk(e.field).resolve(t))}getElementId(t){const e=Symbol.for("lzID");if(t[e])return t[e];const n=this.layout.id_field;let r=t[n];if(void 0===r&&/{{[^{}]*}}/.test(n)&&(r=zE(n,t,{})),null==r)throw new Error("Unable to generate element ID");const i=r.toString().replace(/\W/g,""),a=`${this.getBaseId()}-${i}`.replace(/([:.[\],])/g,"_");return t[e]=a,a}getElementStatusNodeId(t){return null}getElementById(t){const e=fn("#"+t.replace(/([:.[\],])/g,"\\$1"));return!e.empty()&&e.data()&&e.data().length?e.data()[0]:null}applyDataMethods(){const t=this.layout.match&&this.layout.match.receive,e=TE.get(this.layout.match&&this.layout.match.operator||"="),n=this.parent_plot.state.lz_match_value,r=t?new Rk(t):null;if(this.data.length&&this._data_contract.size){const t=new Set(this._data_contract);for(let e of this.data)if(Object.keys(e).forEach(e=>t.delete(e)),!t.size)break;t.size&&console.debug(`Data layer '${this.getBaseId()}' did not receive all expected fields from retrieved data. Missing fields are: ${[...t]}\n  Common reasons for this error include API payloads with missing fields, or data layer layouts that use two kinds of data and need join logic in "data_operations"                \n  If this field is optional, you can safely ignore this message. Examples include {{#if value}} tags or conditional color rules.\n`)}return this.data.forEach((i,a)=>{t&&null!=n&&(i.lz_is_match=e(r.resolve(i),n)),i.getDataLayer=()=>this,i.getPanel=()=>this.parent||null,i.getPlot=()=>{const t=this.parent;return t?t.parent:null}}),this.applyCustomDataMethods(),this}applyCustomDataMethods(){return this}resolveScalableParameter(t,e,n){let r=null;if(Array.isArray(t)){let i=0;for(;null===r&&i<t.length;)r=this.resolveScalableParameter(t[i],e,n),i++}else switch(typeof t){case"number":case"string":r=t;break;case"object":if(t.scale_function){const i=$E.get(t.scale_function);if(t.field){const a=new Rk(t.field);let o;try{o=this.getElementAnnotation(e)}catch(t){o=null}r=i(t.parameters||{},a.resolve(e,o),n)}else r=i(t.parameters||{},e,n)}}return r}getAxisExtent(t){if(!["x","y"].includes(t))throw new Error("Invalid dimension identifier");const e=t+"_axis",n=this.layout[e];if(!isNaN(n.floor)&&!isNaN(n.ceiling))return[+n.floor,+n.ceiling];let r=[];if(n.field&&this.data){if(this.data.length){r=this._getDataExtent(this.data,n);const t=r[1]-r[0];if(isNaN(n.lower_buffer)||(r[0]-=t*n.lower_buffer),isNaN(n.upper_buffer)||(r[1]+=t*n.upper_buffer),"object"==typeof n.min_extent){const t=n.min_extent[0],e=n.min_extent[1];isNaN(t)||isNaN(e)||(r[0]=Math.min(r[0],t)),isNaN(e)||(r[1]=Math.max(r[1],e))}return[isNaN(n.floor)?r[0]:n.floor,isNaN(n.ceiling)?r[1]:n.ceiling]}return r=n.min_extent||[],r}return"x"!==t||isNaN(this.state.start)||isNaN(this.state.end)?[]:[this.state.start,this.state.end]}getTicks(t,e){if(!["x","y1","y2"].includes(t))throw new Error("Invalid dimension identifier "+t);return[]}_getTooltipPosition(t){const e=this.parent,n=e[`y${this.layout.y_axis.axis}_scale`],r=e[`y${this.layout.y_axis.axis}_extent`],i=e.x_scale(e.x_extent[0]),a=n(r[0]);return{x_min:i,x_max:i,y_min:a,y_max:a}}_drawTooltip(t,e,n,r,i,a){const o=this.parent.layout,s=this.parent_plot.layout,u=this.layout,l=this._getPageOrigin(),c=t.selector.node().getBoundingClientRect(),h=o.height-(o.margin.top+o.margin.bottom),f=s.width-(o.margin.left+o.margin.right),d=((n=Math.max(n,0))+(r=Math.min(r,f)))/2,p=((i=Math.max(i,0))+(a=Math.min(a,h)))/2;let _,g,y,m,b,v=r-d,x=a-p,w=u.tooltip_positioning;if("vertical"===w?(v=0,w=c.height+8>h-(p+x)?"top":"bottom"):"horizontal"===w&&(x=0,w=d<=s.width/2?"left":"right"),"top"===w||"bottom"===w){const t=Math.max(c.width/2-d,0),e=Math.max(c.width/2+d-f,0);g=l.x+d-c.width/2-e+t,b=l.x+d-g-7,"top"===w?(_=l.y+p-(x+c.height+8),y="down",m=c.height-1):(_=l.y+p+x+8,y="up",m=-8)}else{if("left"!==w&&"right"!==w)throw new Error("Unrecognized placement value");"left"===w?(g=l.x+d+v+8,y="left",b=-8):(g=l.x+d-c.width-v-8,y="right",b=c.width-1),p-c.height/2<=0?(_=l.y+p-10.5-6,m=6):p+c.height/2>=h?(_=l.y+p+7+6-c.height,m=c.height-14-6):(_=l.y+p-c.height/2,m=c.height/2-7)}return t.selector.style("left",g+"px").style("top",_+"px"),t.arrow||(t.arrow=t.selector.append("div").style("position","absolute")),t.arrow.attr("class","lz-data_layer-tooltip-arrow_"+y).style("left",b+"px").style("top",m+"px"),this}filter(t,e,n,r){let i=!0;return t.forEach(t=>{const{field:n,operator:r,value:a}=t,o=TE.get(r),s=this.getElementAnnotation(e);o(n?new Rk(n).resolve(e,s):e,a)||(i=!1)}),i}getElementAnnotation(t,e){const n=this.getElementId(t),r=this._layer_state.extra_fields[n];return e?r&&r[e]:r}_applyFilters(t){return t=t||this.data,this._filter_func?t=t.filter(this._filter_func):this.layout.filters&&(t=t.filter(this.filter.bind(this,this.layout.filters))),t}_setDefaultState(){const t={status_flags:{},extra_fields:{}},e=t.status_flags;Mk.adjectives.forEach(t=>{e[t]=e[t]||new Set}),e.has_tooltip=e.has_tooltip||new Set,this.parent&&(this._state_id=`${this.parent.id}.${this.id}`,this.state=this.parent.state,this.state[this._state_id]=t),this._layer_state=t}getBaseId(){return this._base_id?this._base_id:this.parent?`${this.parent_plot.id}.${this.parent.id}.${this.id}`:(this.id||"").toString()}getAbsoluteDataHeight(){return this.svg.group.node().getBoundingClientRect().height}initialize(){this._base_id=this.getBaseId();const t=this.getBaseId();return this.svg.container=this.parent.svg.group.append("g").attr("class","lz-data_layer-container").attr("id",t+".data_layer_container"),this.svg.clipRect=this.svg.container.append("clipPath").attr("id",t+".clip").append("rect"),this.svg.group=this.svg.container.append("g").attr("id",t+".data_layer").attr("clip-path",`url(#${t}.clip)`),this}createTooltip(t){if("object"!=typeof this.layout.tooltip)throw new Error(`DataLayer [${this.id}] layout does not define a tooltip`);const e=this.getElementId(t);if(!this._tooltips[e])return this._tooltips[e]={data:t,arrow:null,selector:fn(this.parent_plot.svg.node().parentNode).append("div").attr("class","lz-data_layer-tooltip").attr("id",e+"-tooltip")},this._layer_state.status_flags.has_tooltip.add(e),this.updateTooltip(t),this;this.positionTooltip(e)}updateTooltip(t,e){return void 0===e&&(e=this.getElementId(t)),this._tooltips[e].selector.html(""),this._tooltips[e].arrow=null,this.layout.tooltip.html&&this._tooltips[e].selector.html(zE(this.layout.tooltip.html,t,this.getElementAnnotation(t))),this.layout.tooltip.closable&&this._tooltips[e].selector.insert("button",":first-child").attr("class","lz-tooltip-close-button").attr("title","Close").text("").on("click",()=>{this.destroyTooltip(e)}),this._tooltips[e].selector.data([t]),this.positionTooltip(e),this}destroyTooltip(t,e){let n;if(n="string"==typeof t?t:this.getElementId(t),this._tooltips[n]&&("object"==typeof this._tooltips[n].selector&&this._tooltips[n].selector.remove(),delete this._tooltips[n]),!e){this._layer_state.status_flags.has_tooltip.delete(n)}return this}destroyAllTooltips(t=!0){for(let e in this._tooltips)this.destroyTooltip(e,t);return this}positionTooltip(t){if("string"!=typeof t)throw new Error("Unable to position tooltip: id is not a string");if(!this._tooltips[t])throw new Error("Unable to position tooltip: id does not point to a valid tooltip");const e=this._tooltips[t],n=this._getTooltipPosition(e);if(!n)return null;this._drawTooltip(e,this.layout.tooltip_positioning,n.x_min,n.x_max,n.y_min,n.y_max)}positionAllTooltips(){for(let t in this._tooltips)this.positionTooltip(t);return this}showOrHideTooltip(t,e){const n=this.layout.tooltip;if("object"!=typeof n)return this;const r=this.getElementId(t),i=(t,e,n)=>{let r=null;if("object"!=typeof t||null===t)return null;if(Array.isArray(e))n=n||"and",r=1===e.length?t[e[0]]:e.reduce((e,r)=>"and"===n?t[e]&&t[r]:"or"===n?t[e]||t[r]:null);else{if("object"!=typeof e)return!1;{let a;for(let o in e)a=i(t,e[o],o),null===r?r=a:"and"===n?r=r&&a:"or"===n&&(r=r||a)}}return r};let a={};"string"==typeof n.show?a={and:[n.show]}:"object"==typeof n.show&&(a=n.show);let o={};"string"==typeof n.hide?o={and:[n.hide]}:"object"==typeof n.hide&&(o=n.hide);const s=this._layer_state;var u={};Mk.adjectives.forEach(t=>{const e="un"+t;u[t]=s.status_flags[t].has(r),u[e]=!u[t]});const l=i(u,a),c=i(u,o),h=s.status_flags.has_tooltip.has(r);return!l||!e&&!h||c?this.destroyTooltip(t):this.createTooltip(t),this}setElementStatus(t,e,n,r){if("has_tooltip"===t)return this;let i;void 0===n&&(n=!0);try{i=this.getElementId(e)}catch(t){return this}r&&this.setAllElementStatus(t,!n),fn("#"+i).classed(`lz-data_layer-${this.layout.type}-${t}`,n);const a=this.getElementStatusNodeId(e);null!==a&&fn("#"+a).classed(`lz-data_layer-${this.layout.type}-statusnode-${t}`,n);const o=!this._layer_state.status_flags[t].has(i);n&&o&&this._layer_state.status_flags[t].add(i),n||o||this._layer_state.status_flags[t].delete(i),this.showOrHideTooltip(e,o),o&&this.parent.emit("layout_changed",!0);const s="selected"===t;!s||!o&&n||this.parent.emit("element_selection",{element:e,active:n},!0);const u=this.layout.match&&this.layout.match.send;return!s||void 0===u||!o&&n||this.parent.emit("match_requested",{value:new Rk(u).resolve(e),active:n},!0),this}setAllElementStatus(t,e){if(void 0===t||!Mk.adjectives.includes(t))throw new Error("Invalid status");if(void 0===this._layer_state.status_flags[t])return this;if(void 0===e&&(e=!0),e)this.data.forEach(e=>this.setElementStatus(t,e,!0));else{new Set(this._layer_state.status_flags[t]).forEach(e=>{const n=this.getElementById(e);"object"==typeof n&&null!==n&&this.setElementStatus(t,n,!1)}),this._layer_state.status_flags[t]=new Set}return this._global_statuses[t]=e,this}applyBehaviors(t){"object"==typeof this.layout.behaviors&&Object.keys(this.layout.behaviors).forEach(e=>{const n=/(click|mouseover|mouseout)/.exec(e);n&&t.on(`${n[0]}.${e}`,this.executeBehaviors(e,this.layout.behaviors[e]))})}executeBehaviors(t,e){const n=t.includes("ctrl"),r=t.includes("shift"),i=this;return function(t){t=t||fn(Je.target).datum(),n===!!Je.ctrlKey&&r===!!Je.shiftKey&&e.forEach(e=>{if("object"==typeof e&&null!==e)switch(e.action){case"set":i.setElementStatus(e.status,t,!0,e.exclusive);break;case"unset":i.setElementStatus(e.status,t,!1,e.exclusive);break;case"toggle":var n=i._layer_state.status_flags[e.status].has(i.getElementId(t)),r=e.exclusive&&!n;i.setElementStatus(e.status,t,!n,r);break;case"link":if("string"==typeof e.href){const n=zE(e.href,t,i.getElementAnnotation(t));"string"==typeof e.target?window.open(n,e.target):window.location.href=n}}})}}_getPageOrigin(){const t=this.parent._getPageOrigin();return{x:t.x+this.parent.layout.margin.left,y:t.y+this.parent.layout.margin.top}}applyAllElementStatus(){const t=this._layer_state.status_flags,e=this;for(let n in t)Object.prototype.hasOwnProperty.call(t,n)&&t[n].forEach(t=>{try{this.setElementStatus(n,this.getElementById(t),!0)}catch(t){console.warn(`Unable to apply state: ${e._state_id}, ${n}`),console.error(t)}})}draw(){return this.svg.container.attr("transform",`translate(${this.parent.layout.cliparea.origin.x}, ${this.parent.layout.cliparea.origin.y})`),this.svg.clipRect.attr("width",this.parent.layout.cliparea.width).attr("height",this.parent.layout.cliparea.height),this.positionAllTooltips(),this}reMap(){return this.destroyAllTooltips(),this.parent_plot.lzd.getData(this.state,this._entities,this._dependencies).then(t=>{this.data=t,this.applyDataMethods(),this._initialized=!0,this.parent.emit("data_from_layer",{layer:this.getBaseId(),content:Fk(t)},!0)})}}Mk.verbs.forEach((t,e)=>{const n=Mk.adjectives[e],r="un"+t;BE.prototype[t+"Element"]=function(t,e=!1){return e=!!e,this.setElementStatus(n,t,!0,e),this},BE.prototype[r+"Element"]=function(t,e){return e=void 0!==e&&!!e,this.setElementStatus(n,t,!1,e),this},BE.prototype[t+"AllElements"]=function(){return this.setAllElementStatus(n,!0),this},BE.prototype[r+"AllElements"]=function(){return this.setAllElementStatus(n,!1),this}});const UE={color:"#000000",filters:null,tooltip_positioning:"vertical",hitarea_width:8};class qE extends BE{constructor(t){if(!Array.isArray(t.filters))throw new Error("Annotation track must specify array of filters for selecting points to annotate");qk(t,UE),super(...arguments)}initialize(){super.initialize(),this._hitareas_group=this.svg.group.append("g").attr("class",`lz-data_layer-${this.layout.type}-hit_areas`),this._visible_lines_group=this.svg.group.append("g").attr("class",`lz-data_layer-${this.layout.type}-visible_lines`)}render(){const t=this._applyFilters(),e=this._hitareas_group.selectAll("rect.lz-data_layer-"+this.layout.type).data(t,t=>t[this.layout.id_field]),n=(e,n)=>{const r=this.parent.x_scale(e[this.layout.x_axis.field]);let i=r-this.layout.hitarea_width/2;if(n>=1){const e=t[n-1],a=this.parent.x_scale(e[this.layout.x_axis.field]);i=Math.max(i,(r+a)/2)}return[i,r]};e.enter().append("rect").attr("class","lz-data_layer-"+this.layout.type).merge(e).attr("id",t=>this.getElementId(t)).attr("height",this.parent.layout.height).attr("opacity",0).attr("x",(t,e)=>n(t,e)[0]).attr("width",(t,e)=>{const r=n(t,e);return r[1]-r[0]+this.layout.hitarea_width/2});const r=this._visible_lines_group.selectAll("rect.lz-data_layer-"+this.layout.type).data(t,t=>t[this.layout.id_field]);r.enter().append("rect").attr("class","lz-data_layer-"+this.layout.type).merge(r).attr("id",t=>this.getElementId(t)).attr("x",t=>this.parent.x_scale(t[this.layout.x_axis.field])-.5).attr("width",1).attr("height",this.parent.layout.height).attr("fill",(t,e)=>this.resolveScalableParameter(this.layout.color,t,e)),r.exit().remove(),this.svg.group.call(this.applyBehaviors.bind(this)),e.exit().remove()}_getTooltipPosition(t){const e=this.parent,n=e.layout.height-(e.layout.margin.top+e.layout.margin.bottom),r=e.x_scale(t.data[this.layout.x_axis.field]),i=n/2;return{x_min:r-1,x_max:r+1,y_min:i-e.layout.margin.top,y_max:i+e.layout.margin.bottom}}}const FE={color:"#CCCCCC",fill_opacity:.5,filters:null,regions:[],id_field:"id",start_field:"start",end_field:"end",merge_field:null};class YE extends BE{constructor(t){if(qk(t,FE),t.interaction||t.behaviors)throw new Error("highlight_regions layer does not support mouse events");if(t.regions.length&&t.namespace&&Object.keys(t.namespace).length)throw new Error('highlight_regions layer can specify "regions" in layout, OR external data "fields", but not both');super(...arguments)}_mergeNodes(t){const{end_field:e,merge_field:n,start_field:r}=this.layout;if(!n)return t;t.sort((t,e)=>G(t[n],e[n])||G(t[r],e[r]));let i=[];return t.forEach((function(t,a){const o=i[i.length-1]||t;if(t[n]===o[n]&&t[r]<=o[e]){const n=Math.min(o[r],t[r]),a=Math.max(o[e],t[e]);t=Object.assign({},o,t,{[r]:n,[e]:a}),i.pop()}i.push(t)})),i}render(){const{x_scale:t}=this.parent;let e=this.layout.regions.length?this.layout.regions:this.data;e.forEach((t,e)=>t.id||(t.id=e)),e=this._applyFilters(e),e=this._mergeNodes(e);const n=this.svg.group.selectAll("rect.lz-data_layer-"+this.layout.type).data(e);n.enter().append("rect").attr("class","lz-data_layer-"+this.layout.type).merge(n).attr("id",t=>this.getElementId(t)).attr("x",e=>t(e[this.layout.start_field])).attr("width",e=>t(e[this.layout.end_field])-t(e[this.layout.start_field])).attr("height",this.parent.layout.height).attr("fill",(t,e)=>this.resolveScalableParameter(this.layout.color,t,e)).attr("fill-opacity",(t,e)=>this.resolveScalableParameter(this.layout.fill_opacity,t,e)),n.exit().remove(),this.svg.group.style("pointer-events","none")}_getTooltipPosition(t){throw new Error("This layer does not support tooltips")}}const HE={color:"seagreen",hitarea_width:"10px",style:{fill:"none","stroke-width":"1px","stroke-opacity":"100%"},tooltip_positioning:"top"};class GE extends BE{constructor(t){t=qk(t,HE),super(...arguments)}render(){const t=this.layout,e=this.parent.x_scale,n=this.parent[`y${t.y_axis.axis}_scale`],r=this._applyFilters();function i(r){const i=r[t.x_axis.field1],a=r[t.x_axis.field2],o=(i+a)/2,s=[[e(i),n(0)],[e(o),n(r[t.y_axis.field])],[e(a),n(0)]];return Px().x(t=>t[0]).y(t=>t[1]).curve(eM)(s)}const a=this.svg.group.selectAll("path.lz-data_layer-arcs-hitarea").data(r,t=>this.getElementId(t)),o=this.svg.group.selectAll("path.lz-data_layer-arcs").data(r,t=>this.getElementId(t));return this.svg.group.call(Kk,t.style),a.enter().append("path").attr("class","lz-data_layer-arcs-hitarea").merge(a).attr("id",t=>this.getElementId(t)).style("fill","none").style("stroke-width",t.hitarea_width).style("stroke-opacity",0).style("stroke","transparent").attr("d",t=>i(t)),o.enter().append("path").attr("class","lz-data_layer-arcs").merge(o).attr("id",t=>this.getElementId(t)).attr("stroke",(t,e)=>this.resolveScalableParameter(this.layout.color,t,e)).attr("d",(t,e)=>i(t)),o.exit().remove(),a.exit().remove(),this.svg.group.call(this.applyBehaviors.bind(this)),this}_getTooltipPosition(t){const e=this.parent,n=this.layout,r=t.data[n.x_axis.field1],i=t.data[n.x_axis.field2],a=e[`y${n.y_axis.axis}_scale`];return{x_min:e.x_scale(Math.min(r,i)),x_max:e.x_scale(Math.max(r,i)),y_min:a(t.data[n.y_axis.field]),y_max:a(0)}}}const VE={stroke:"rgb(54, 54, 150)",color:"#363696",label_font_size:15,label_exon_spacing:3,exon_height:10,bounding_box_padding:3,track_vertical_spacing:5,tooltip_positioning:"top"};class XE extends BE{constructor(t){t=qk(t,VE),super(...arguments),this.transcript_idx=0,this.tracks=1,this.gene_track_index={1:[]}}getElementStatusNodeId(t){return this.getElementId(t)+"-statusnode"}getTrackHeight(){return 2*this.layout.bounding_box_padding+this.layout.label_font_size+this.layout.label_exon_spacing+this.layout.exon_height+this.layout.track_vertical_spacing}assignTracks(t){const e=(t,e)=>{try{const n=this.svg.group.append("text").attr("x",0).attr("y",0).attr("class","lz-data_layer-genes lz-label").style("font-size",e).text(t+""),r=n.node().getBBox().width;return n.remove(),r}catch(t){return 0}};return this.tracks=1,this.gene_track_index={1:[]},t.filter(t=>!(t.end<this.state.start||t.start>this.state.end)).map(t=>{if(t.gene_id&&t.gene_id.indexOf(".")){const e=t.gene_id.split(".");t.gene_id=e[0],t.gene_version=e[1]}if(t.transcript_id=t.transcripts[this.transcript_idx].transcript_id,t.display_range={start:this.parent.x_scale(Math.max(t.start,this.state.start)),end:this.parent.x_scale(Math.min(t.end,this.state.end))},t.display_range.label_width=e(t.gene_name,this.layout.label_font_size),t.display_range.width=t.display_range.end-t.display_range.start,t.display_range.text_anchor="middle",t.display_range.width<t.display_range.label_width){if(t.start<this.state.start)t.display_range.end=t.display_range.start+t.display_range.label_width+this.layout.label_font_size,t.display_range.text_anchor="start";else if(t.end>this.state.end)t.display_range.start=t.display_range.end-t.display_range.label_width-this.layout.label_font_size,t.display_range.text_anchor="end";else{const e=(t.display_range.label_width-t.display_range.width)/2+this.layout.label_font_size;t.display_range.start-e<this.parent.x_scale(this.state.start)?(t.display_range.start=this.parent.x_scale(this.state.start),t.display_range.end=t.display_range.start+t.display_range.label_width,t.display_range.text_anchor="start"):t.display_range.end+e>this.parent.x_scale(this.state.end)?(t.display_range.end=this.parent.x_scale(this.state.end),t.display_range.start=t.display_range.end-t.display_range.label_width,t.display_range.text_anchor="end"):(t.display_range.start-=e,t.display_range.end+=e)}t.display_range.width=t.display_range.end-t.display_range.start}t.display_range.start-=this.layout.bounding_box_padding,t.display_range.end+=this.layout.bounding_box_padding,t.display_range.width+=2*this.layout.bounding_box_padding,t.display_domain={start:this.parent.x_scale.invert(t.display_range.start),end:this.parent.x_scale.invert(t.display_range.end)},t.display_domain.width=t.display_domain.end-t.display_domain.start,t.track=null;let n=1;for(;null===t.track;){let e=!1;this.gene_track_index[n].map(n=>{if(!e){const r=Math.min(n.display_range.start,t.display_range.start);Math.max(n.display_range.end,t.display_range.end)-r<n.display_range.width+t.display_range.width&&(e=!0)}}),e?(n++,n>this.tracks&&(this.tracks=n,this.gene_track_index[n]=[])):(t.track=n,this.gene_track_index[n].push(t))}return t.parent=this,t.transcripts.map((e,n)=>{t.transcripts[n].parent=t,t.transcripts[n].exons.map((e,r)=>t.transcripts[n].exons[r].parent=t.transcripts[n])}),t})}render(){const t=this;let e,n=this._applyFilters();n=this.assignTracks(n);const r=this.svg.group.selectAll("g.lz-data_layer-genes").data(n,t=>t.gene_name);r.enter().append("g").attr("class","lz-data_layer-genes").merge(r).attr("id",t=>this.getElementId(t)).each((function(n){const r=n.parent,i=fn(this).selectAll("rect.lz-data_layer-genes.lz-data_layer-genes-statusnode").data([n],t=>r.getElementStatusNodeId(t));e=r.getTrackHeight()-r.layout.track_vertical_spacing,i.enter().append("rect").attr("class","lz-data_layer-genes lz-data_layer-genes-statusnode").merge(i).attr("id",t=>r.getElementStatusNodeId(t)).attr("rx",r.layout.bounding_box_padding).attr("ry",r.layout.bounding_box_padding).attr("width",t=>t.display_range.width).attr("height",e).attr("x",t=>t.display_range.start).attr("y",t=>(t.track-1)*r.getTrackHeight()),i.exit().remove();const a=fn(this).selectAll("rect.lz-data_layer-genes.lz-boundary").data([n],t=>t.gene_name+"_boundary");e=1,a.enter().append("rect").attr("class","lz-data_layer-genes lz-boundary").merge(a).attr("width",t=>r.parent.x_scale(t.end)-r.parent.x_scale(t.start)).attr("height",e).attr("x",t=>r.parent.x_scale(t.start)).attr("y",t=>(t.track-1)*r.getTrackHeight()+r.layout.bounding_box_padding+r.layout.label_font_size+r.layout.label_exon_spacing+Math.max(r.layout.exon_height,3)/2).style("fill",(e,n)=>t.resolveScalableParameter(t.layout.color,e,n)).style("stroke",(e,n)=>t.resolveScalableParameter(t.layout.stroke,e,n)),a.exit().remove();const o=fn(this).selectAll("text.lz-data_layer-genes.lz-label").data([n],t=>t.gene_name+"_label");o.enter().append("text").attr("class","lz-data_layer-genes lz-label").merge(o).attr("text-anchor",t=>t.display_range.text_anchor).text(t=>"+"===t.strand?t.gene_name+"":""+t.gene_name).style("font-size",n.parent.layout.label_font_size).attr("x",t=>"middle"===t.display_range.text_anchor?t.display_range.start+t.display_range.width/2:"start"===t.display_range.text_anchor?t.display_range.start+r.layout.bounding_box_padding:"end"===t.display_range.text_anchor?t.display_range.end-r.layout.bounding_box_padding:void 0).attr("y",t=>(t.track-1)*r.getTrackHeight()+r.layout.bounding_box_padding+r.layout.label_font_size),o.exit().remove();const s=fn(this).selectAll("rect.lz-data_layer-genes.lz-exon").data(n.transcripts[n.parent.transcript_idx].exons,t=>t.exon_id);e=r.layout.exon_height,s.enter().append("rect").attr("class","lz-data_layer-genes lz-exon").merge(s).style("fill",(e,n)=>t.resolveScalableParameter(t.layout.color,e.parent.parent,n)).style("stroke",(e,n)=>t.resolveScalableParameter(t.layout.stroke,e.parent.parent,n)).attr("width",t=>r.parent.x_scale(t.end)-r.parent.x_scale(t.start)).attr("height",e).attr("x",t=>r.parent.x_scale(t.start)).attr("y",()=>(n.track-1)*r.getTrackHeight()+r.layout.bounding_box_padding+r.layout.label_font_size+r.layout.label_exon_spacing),s.exit().remove();const u=fn(this).selectAll("rect.lz-data_layer-genes.lz-clickarea").data([n],t=>t.gene_name+"_clickarea");e=r.getTrackHeight()-r.layout.track_vertical_spacing,u.enter().append("rect").attr("class","lz-data_layer-genes lz-clickarea").merge(u).attr("id",t=>r.getElementId(t)+"_clickarea").attr("rx",r.layout.bounding_box_padding).attr("ry",r.layout.bounding_box_padding).attr("width",t=>t.display_range.width).attr("height",e).attr("x",t=>t.display_range.start).attr("y",t=>(t.track-1)*r.getTrackHeight()),u.exit().remove()})),r.exit().remove(),this.svg.group.on("click.event_emitter",t=>this.parent.emit("element_clicked",t,!0)).call(this.applyBehaviors.bind(this))}_getTooltipPosition(t){const e=this.getElementStatusNodeId(t.data),n=fn("#"+e).node().getBBox();return{x_min:this.parent.x_scale(t.data.start),x_max:this.parent.x_scale(t.data.end),y_min:n.y,y_max:n.y+n.height}}}const ZE={style:{fill:"none","stroke-width":"2px"},interpolate:"curveLinear",x_axis:{field:"x"},y_axis:{field:"y",axis:1},hitarea_width:5,tooltip:null};class WE extends BE{constructor(t){if((t=qk(t,ZE)).tooltip)throw new Error("The line / filled curve layer does not support tooltips");super(...arguments)}render(){const t=this.parent,e=this.layout.x_axis.field,n=this.layout.y_axis.field,r=this.svg.group.selectAll("path.lz-data_layer-line").data([this.data]);let i;this.path=r.enter().append("path").attr("class","lz-data_layer-line");const o=t.x_scale,s=t[`y${this.layout.y_axis.axis}_scale`];i=this.layout.style.fill&&"none"!==this.layout.style.fill?Rx().x(t=>+o(t[e])).y0(+s(0)).y1(t=>+s(t[n])):Px().x(t=>+o(t[e])).y(t=>+s(t[n])).curve(a[this.layout.interpolate]),r.merge(this.path).attr("d",i).call(Kk,this.layout.style),r.exit().remove()}setElementStatus(t,e,n){return this.setAllElementStatus(t,n)}setAllElementStatus(t,e){if(void 0===t||!Mk.adjectives.includes(t))throw new Error("Invalid status");if(void 0===this._layer_state.status_flags[t])return this;void 0===e&&(e=!0),this._global_statuses[t]=e;let n="lz-data_layer-line";return Object.keys(this._global_statuses).forEach(t=>{this._global_statuses[t]&&(n+=" lz-data_layer-line-"+t)}),this.path.attr("class",n),this.parent.emit("layout_changed",!0),this}}const JE={style:{stroke:"#D3D3D3","stroke-width":"3px","stroke-dasharray":"10px 10px"},orientation:"horizontal",x_axis:{axis:1,decoupled:!0},y_axis:{axis:1,decoupled:!0},tooltip_positioning:"vertical",offset:0};class KE extends BE{constructor(t){t=qk(t,JE),["horizontal","vertical"].includes(t.orientation)||(t.orientation="horizontal"),super(...arguments)}getElementId(t){return this.getBaseId()}render(){const t=this.parent,e=`y${this.layout.y_axis.axis}_scale`,n=`y${this.layout.y_axis.axis}_extent`;if("horizontal"===this.layout.orientation)this.data=[{x:t.x_extent[0],y:this.layout.offset},{x:t.x_extent[1],y:this.layout.offset}];else{if("vertical"!==this.layout.orientation)throw new Error('Unrecognized vertical line type. Must be "vertical" or "horizontal"');this.data=[{x:this.layout.offset,y:t[n][0]},{x:this.layout.offset,y:t[n][1]}]}const r=this.svg.group.selectAll("path.lz-data_layer-line").data([this.data]),i=[t.layout.cliparea.height,0],a=Px().x((e,n)=>{const r=+t.x_scale(e.x);return isNaN(r)?t.x_range[n]:r}).y((n,r)=>{const a=+t[e](n.y);return isNaN(a)?i[r]:a});this.path=r.enter().append("path").attr("class","lz-data_layer-line").merge(r).attr("d",a).call(Kk,this.layout.style).call(this.applyBehaviors.bind(this)),r.exit().remove()}_getTooltipPosition(t){try{const t=xr(this.svg.container.node()),e=t[0],n=t[1];return{x_min:e-1,x_max:e+1,y_min:n-1,y_max:n+1}}catch(t){return null}}}const QE={point_size:40,point_shape:"circle",tooltip_positioning:"horizontal",color:"#888888",coalesce:{active:!1,max_points:800,x_min:"-Infinity",x_max:"Infinity",y_min:0,y_max:3,x_gap:7,y_gap:7},fill_opacity:1,y_axis:{axis:1},id_field:"id"};class tS extends BE{constructor(t){(t=qk(t,QE)).label&&isNaN(t.label.spacing)&&(t.label.spacing=4),super(...arguments)}_getTooltipPosition(t){const e=this.parent.x_scale(t.data[this.layout.x_axis.field]),n=`y${this.layout.y_axis.axis}_scale`,r=this.parent[n](t.data[this.layout.y_axis.field]),i=this.resolveScalableParameter(this.layout.point_size,t.data),a=Math.sqrt(i/Math.PI);return{x_min:e-a,x_max:e+a,y_min:r-a,y_max:r+a}}flip_labels(){const t=this,e=t.resolveScalableParameter(t.layout.point_size,{}),n=t.layout.label.spacing,r=Boolean(t.layout.label.lines),i=2*n,a=this.parent_plot.layout.width-this.parent.layout.margin.left-this.parent.layout.margin.right-2*n,o=(t,i)=>{const a=+t.attr("x"),o=2*n+2*Math.sqrt(e);let s,u;r&&(s=+i.attr("x2"),u=n+2*Math.sqrt(e)),"start"===t.style("text-anchor")?(t.style("text-anchor","end"),t.attr("x",a-o),r&&i.attr("x2",s-u)):(t.style("text-anchor","start"),t.attr("x",a+o),r&&i.attr("x2",s+u))};t._label_texts.each((function(e,i){const s=fn(this);if(+s.attr("x")+s.node().getBoundingClientRect().width+n>a){const e=r?fn(t._label_lines.nodes()[i]):null;o(s,e)}})),t._label_texts.each((function(e,a){const s=fn(this);if("end"===s.style("text-anchor"))return;let u=+s.attr("x");const l=s.node().getBoundingClientRect(),c=r?fn(t._label_lines.nodes()[a]):null;t._label_texts.each((function(){const t=fn(this).node().getBoundingClientRect();l.left<t.left+t.width+2*n&&l.left+l.width+2*n>t.left&&l.top<t.top+t.height+2*n&&l.height+l.top+2*n>t.top&&(o(s,c),u=+s.attr("x"),u-l.width-n<i&&o(s,c))}))}))}separate_labels(){this._label_iterations++;const t=this;if(!this.layout.label)return;const e=this.layout.label.spacing;let n=!1;if(t._label_texts.each((function(){const r=this,i=fn(r),a=i.attr("y");t._label_texts.each((function(){if(r===this)return;const o=fn(this);if(i.attr("text-anchor")!==o.attr("text-anchor"))return;const s=i.node().getBoundingClientRect(),u=o.node().getBoundingClientRect();if(!(s.left<u.left+u.width+2*e&&s.left+s.width+2*e>u.left&&s.top<u.top+u.height+2*e&&s.height+s.top+2*e>u.top))return;n=!0;const l=o.attr("y"),c=.5*(s.top<u.top?1:-1);let h=+a-c,f=+l+c;const d=2*e,p=t.parent.layout.height-t.parent.layout.margin.top-t.parent.layout.margin.bottom-2*e;let _;h-s.height/2<d?(_=+a-h,h=+a,f+=_):f-u.height/2<d&&(_=+l-f,f=+l,h+=_),h+s.height/2>p?(_=h-+a,h=+a,f-=_):f+u.height/2>p&&(_=f-+l,f=+l,h-=_),i.attr("y",h),o.attr("y",f)}))})),n){if(t.layout.label.lines){const e=t._label_texts.nodes();t._label_lines.attr("y2",(t,n)=>fn(e[n]).attr("y"))}this._label_iterations<150&&setTimeout(()=>{this.separate_labels()},1)}}render(){const t=this,e=this.parent.x_scale,n=this.parent[`y${this.layout.y_axis.axis}_scale`],r=Symbol.for("lzX"),i=Symbol.for("lzY");let a=this._applyFilters();if(a.forEach(t=>{let a=e(t[this.layout.x_axis.field]),o=n(t[this.layout.y_axis.field]);isNaN(a)&&(a=-1e3),isNaN(o)&&(o=-1e3),t[r]=a,t[i]=o}),this.layout.coalesce.active&&a.length>this.layout.coalesce.max_points){let{x_min:t,x_max:r,y_min:i,y_max:o,x_gap:s,y_gap:u}=this.layout.coalesce;a=function(t,e,n,r,i,a,o){let s=[];const u=Symbol.for("lzX"),l=Symbol.for("lzY");let c=null,h=null,f=[];function d(){if(f.length){const t=f[Math.floor((f.length-1)/2)];s.push(t)}c=h=null,f=[]}function p(t,e,n){c=t,h=e,f.push(n)}return t.forEach(t=>{const _=t[u],g=t[l],y=_>=e&&_<=n&&g>=i&&g<=a;if(t.lz_is_match||!y)d(),s.push(t);else if(null===c)p(_,g,t);else{Math.abs(_-c)<=r&&Math.abs(g-h)<=o?f.push(t):(d(),p(_,g,t))}}),d(),s}(a,isFinite(t)?e(+t):-1/0,isFinite(r)?e(+r):1/0,s,isFinite(o)?n(+o):-1/0,isFinite(i)?n(+i):1/0,u)}if(this.layout.label){let e;const n=t.layout.label.filters||[];if(n.length){const t=this.filter.bind(this,n);e=a.filter(t)}else e=a;this._label_groups=this.svg.group.selectAll(`g.lz-data_layer-${this.layout.type}-label`).data(e,t=>t[this.layout.id_field]+"_label");const o=`lz-data_layer-${this.layout.type}-label`,s=this._label_groups.enter().append("g").attr("class",o);this._label_texts&&this._label_texts.remove(),this._label_texts=this._label_groups.merge(s).append("text").text(e=>zE(t.layout.label.text||"",e,this.getElementAnnotation(e))).attr("x",e=>e[r]+Math.sqrt(t.resolveScalableParameter(t.layout.point_size,e))+t.layout.label.spacing).attr("y",t=>t[i]).attr("text-anchor","start").call(Kk,t.layout.label.style||{}),t.layout.label.lines&&(this._label_lines&&this._label_lines.remove(),this._label_lines=this._label_groups.merge(s).append("line").attr("x1",t=>t[r]).attr("y1",t=>t[i]).attr("x2",e=>e[r]+Math.sqrt(t.resolveScalableParameter(t.layout.point_size,e))+t.layout.label.spacing/2).attr("y2",t=>t[i]).call(Kk,t.layout.label.lines.style||{})),this._label_groups.exit().remove()}else this._label_texts&&this._label_texts.remove(),this._label_lines&&this._label_lines.remove(),this._label_groups&&this._label_groups.remove();const o=this.svg.group.selectAll("path.lz-data_layer-"+this.layout.type).data(a,t=>t[this.layout.id_field]),s=yw().size((t,e)=>this.resolveScalableParameter(this.layout.point_size,t,e)).type((t,e)=>Yk(this.resolveScalableParameter(this.layout.point_shape,t,e))),u="lz-data_layer-"+this.layout.type;o.enter().append("path").attr("class",u).attr("id",t=>this.getElementId(t)).merge(o).attr("transform",t=>`translate(${t[r]}, ${t[i]})`).attr("fill",(t,e)=>this.resolveScalableParameter(this.layout.color,t,e)).attr("fill-opacity",(t,e)=>this.resolveScalableParameter(this.layout.fill_opacity,t,e)).attr("d",s),o.exit().remove(),this.layout.label&&(this.flip_labels(),this._label_iterations=0,this.separate_labels()),this.svg.group.on("click.event_emitter",()=>{const t=fn(Je.target).datum();this.parent.emit("element_clicked",t,!0)}).call(this.applyBehaviors.bind(this))}makeLDReference(t){let e=null;if(void 0===t)throw new Error("makeLDReference requires one argument of any type");return e="object"==typeof t?this.layout.id_field&&void 0!==t[this.layout.id_field]?t[this.layout.id_field].toString():void 0!==t.id?t.id.toString():t.toString():t.toString(),this.parent.emit("set_ldrefvar",{ldrefvar:e},!0),this.parent_plot.applyState({ldrefvar:e})}}class eS extends tS{constructor(t){super(...arguments),this._categories={}}_prepareData(){const t=this.layout.x_axis.field||"x",e=this.layout.x_axis.category_field;if(!e)throw new Error(`Layout for ${this.layout.id} must specify category_field`);const n=this.data.sort((t,n)=>{const r=t[e],i=n[e],a="string"==typeof r?r.toLowerCase():r,o="string"==typeof i?i.toLowerCase():i;return a===o?0:a<o?-1:1});return n.forEach((e,n)=>{e[t]=e[t]||n}),n}_generateCategoryBounds(){const t=this.layout.x_axis.category_field,e=this.layout.x_axis.field||"x",n={};this.data.forEach(r=>{const i=r[t],a=r[e],o=n[i]||[a,a];n[i]=[Math.min(o[0],a),Math.max(o[1],a)]});const r=Object.keys(n);return this._setDynamicColorScheme(r),n}_getColorScale(t){let e=(t=t||this.layout).color||[];if(Array.isArray(e)&&(e=e.find(t=>"categorical_bin"===t.scale_function)),!e||"categorical_bin"!==e.scale_function)throw new Error("This layer requires that color options be provided as a `categorical_bin`");return e}_setDynamicColorScheme(t){const e=this._getColorScale(this.layout).parameters,n=this._getColorScale(this._base_layout).parameters;if(n.categories.length&&n.values.length){const r={};n.categories.forEach(t=>{r[t]=1}),t.every(t=>Object.prototype.hasOwnProperty.call(r,t))?e.categories=n.categories:e.categories=t}else e.categories=t;let r;for(r=n.values.length?n.values:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"];r.length<t.length;)r=r.concat(r);r=r.slice(0,t.length),e.values=r}getTicks(t,e){if(!["x","y1","y2"].includes(t))throw new Error("Invalid dimension identifier");const n=e.position||"left";if(!["left","center","right"].includes(n))throw new Error("Invalid tick position");const r=this._categories;if(!r||!Object.keys(r).length)return[];if("y"===t)return[];if("x"===t){const t=this._getColorScale(this.layout),e=t.parameters.categories||[],i=t.parameters.values||[];return Object.keys(r).map((t,a)=>{const o=r[t];let s;switch(n){case"left":s=o[0];break;case"center":const t=o[1]-o[0];s=o[0]+(0!==t?t:o[0])/2;break;case"right":s=o[1]}return{x:s,text:t,style:{fill:i[e.indexOf(t)]||"#000000"}}})}}applyCustomDataMethods(){return this.data=this._prepareData(),this._categories=this._generateCategoryBounds(),this}}const nS=new g;for(let[t,e]of Object.entries(l))nS.add(t,e);var rS=nS;const iS={closable:!0,show:{or:["highlighted","selected"]},hide:{and:["unhighlighted","unselected"]},html:'<strong>{{assoc:variant|htmlescape}}</strong><br>\n        P Value: <strong>{{assoc:log_pvalue|logtoscinotation|htmlescape}}</strong><br>\n        Ref. Allele: <strong>{{assoc:ref_allele|htmlescape}}</strong><br>\n        {{#if lz_is_ld_refvar}}<strong>LD Reference Variant</strong>{{#else}}\n        <a href="javascript:void(0);" \n        onclick="var data = this.parentNode.__data__;\n                 data.getDataLayer().makeLDReference(data);"\n                 >Make LD Reference</a>{{/if}}<br>'},aS=function(){const t=Fk(iS);return t.html+="<a href=\"javascript:void(0);\" \n                  onclick=\"var item = this.parentNode.__data__, layer = item.getDataLayer(); \n                  var current = layer.getElementAnnotation(item, 'lz_show_label'); \n                  layer.setElementAnnotation(item, 'lz_show_label', !current );\n                  layer.parent_plot.applyState();\">{{#if lz_show_label}}Hide{{#else}}Show{{/if}} label</a>",t}(),oS={closable:!0,show:{or:["highlighted","selected"]},hide:{and:["unhighlighted","unselected"]},html:'<h4><strong><i>{{gene_name|htmlescape}}</i></strong></h4>Gene ID: <a href="https://useast.ensembl.org/homo_sapiens/Gene/Summary?g={{gene_id|htmlescape}}&db=core" target="_blank" rel="noopener">{{gene_id|htmlescape}}</a><br>Transcript ID: <strong>{{transcript_id|htmlescape}}</strong><br>{{#if pLI}}<table><tr><th>Constraint</th><th>Expected variants</th><th>Observed variants</th><th>Const. Metric</th></tr><tr><td>Synonymous</td><td>{{exp_syn}}</td><td>{{obs_syn}}</td><td>z = {{syn_z}}<br>o/e = {{oe_syn}} ({{oe_syn_lower}} - {{oe_syn_upper}})</td></tr><tr><td>Missense</td><td>{{exp_mis}}</td><td>{{obs_mis}}</td><td>z = {{mis_z}}<br>o/e = {{oe_mis}} ({{oe_mis_lower}} - {{oe_mis_upper}})</td></tr><tr><td>pLoF</td><td>{{exp_lof}}</td><td>{{obs_lof}}</td><td>pLI = {{pLI}}<br>o/e = {{oe_lof}} ({{oe_lof_lower}} - {{oe_lof_upper}})</td></tr></table><br>{{/if}}<a href="https://gnomad.broadinstitute.org/gene/{{gene_id|htmlescape}}" target="_blank" rel="noopener">More data on gnomAD</a>'},sS={closable:!0,show:{or:["highlighted","selected"]},hide:{and:["unhighlighted","unselected"]},html:'<strong>{{catalog:variant|htmlescape}}</strong><br>Catalog entries: <strong>{{n_catalog_matches|htmlescape}}</strong><br>Top Trait: <strong>{{catalog:trait|htmlescape}}</strong><br>Top P Value: <strong>{{catalog:log_pvalue|logtoscinotation}}</strong><br>More: <a href="https://www.ebi.ac.uk/gwas/search?query={{catalog:rsid|htmlescape}}" target="_blank" rel="noopener">GWAS catalog</a> / <a href="https://www.ncbi.nlm.nih.gov/snp/{{catalog:rsid|htmlescape}}" target="_blank" rel="noopener">dbSNP</a>'},uS={closable:!0,show:{or:["highlighted","selected"]},hide:{and:["unhighlighted","unselected"]},html:"<strong>Regulatory element</strong><br>{{access:start1|htmlescape}}-{{access:end1|htmlescape}}<br><strong>Promoter</strong><br>{{access:start2|htmlescape}}-{{access:end2|htmlescape}}<br>{{#if access:target}}<strong>Target</strong>: {{access:target|htmlescape}}<br>{{/if}}<strong>Score</strong>: {{access:score|htmlescape}}"},lS={id:"significance",type:"orthogonal_line",tag:"significance",orientation:"horizontal",offset:7.301},cS={id:"recombrate",namespace:{recomb:"recomb"},data_operations:[{type:"fetch",from:["recomb"]}],type:"line",tag:"recombination",z_index:1,style:{stroke:"#0000FF","stroke-width":"1.5px"},x_axis:{field:"recomb:position"},y_axis:{axis:2,field:"recomb:recomb_rate",floor:0,ceiling:100}},hS={namespace:{assoc:"assoc",ld:"ld"},data_operations:[{type:"fetch",from:["assoc","ld(assoc)"]},{type:"left_match",name:"assoc_plus_ld",requires:["assoc","ld"],params:["assoc:position","ld:position2"]}],id:"associationpvalues",type:"scatter",tag:"association",id_field:"assoc:variant",coalesce:{active:!0},point_shape:[{scale_function:"if",field:"lz_is_ld_refvar",parameters:{field_value:!0,then:"diamond"}},{scale_function:"effect_direction",parameters:{"+":"triangle","-":"triangledown",beta_field:"assoc:beta",stderr_beta_field:"assoc:se"}},"circle"],point_size:{scale_function:"if",field:"lz_is_ld_refvar",parameters:{field_value:!0,then:80,else:40}},color:[{scale_function:"if",field:"lz_is_ld_refvar",parameters:{field_value:!0,then:"#9632b8"}},{scale_function:"numerical_bin",field:"ld:correlation",parameters:{breaks:[0,.2,.4,.6,.8],values:["rgb(70, 54, 153)","rgb(38, 188, 225)","rgb(110, 254, 104)","rgb(248, 195, 42)","rgb(219, 61, 17)"]}},"#AAAAAA"],legend:[{label:"LD (r)",label_size:14},{shape:"ribbon",orientation:"vertical",width:10,height:15,color_stops:["rgb(70, 54, 153)","rgb(38, 188, 225)","rgb(110, 254, 104)","rgb(248, 195, 42)","rgb(219, 61, 17)"],tick_labels:[0,.2,.4,.6,.8,1]}],label:null,z_index:2,x_axis:{field:"assoc:position"},y_axis:{axis:1,field:"assoc:log_pvalue",floor:0,upper_buffer:.1,min_extent:[0,10]},behaviors:{onmouseover:[{action:"set",status:"highlighted"}],onmouseout:[{action:"unset",status:"highlighted"}],onclick:[{action:"toggle",status:"selected",exclusive:!0}]},tooltip:Fk(iS)},fS={id:"coaccessibility",type:"arcs",tag:"coaccessibility",namespace:{access:"access"},data_operations:[{type:"fetch",from:["access"]}],match:{send:"access:target",receive:"access:target"},id_field:"{{access:start1}}_{{access:end1}}_{{access:start2}}_{{access:end2}}_{{access:score}}_{{access:target}}",filters:[{field:"access:score",operator:"!=",value:null}],color:[{field:"lz_is_match",scale_function:"if",parameters:{field_value:!0,then:"#4285f4"}},{field:"lz_is_match",scale_function:"if",parameters:{field_value:!1,then:"#EAE6E6"}},{scale_function:"ordinal_cycle",parameters:{values:["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"]}}],x_axis:{field1:"access:start1",field2:"access:start2"},y_axis:{axis:1,field:"access:score",upper_buffer:.1,min_extent:[0,1]},behaviors:{onmouseover:[{action:"set",status:"highlighted"}],onmouseout:[{action:"unset",status:"highlighted"}],onclick:[{action:"toggle",status:"selected",exclusive:!0}]},tooltip:Fk(uS)},dS=function(){let t=Fk(hS);return t=qk({id:"associationpvaluescatalog",fill_opacity:.7},t),t.data_operations.push({type:"assoc_to_gwas_catalog",name:"assoc_catalog",requires:["assoc_plus_ld","catalog"],params:["assoc:position","catalog:pos","catalog:log_pvalue"]}),t.tooltip.html+='{{#if catalog:rsid}}<br><a href="https://www.ebi.ac.uk/gwas/search?query={{catalog:rsid|htmlescape}}" target="_blank" rel="noopener">See hits in GWAS catalog</a>{{/if}}',t.namespace.catalog="catalog",t}(),pS={id:"phewaspvalues",type:"category_scatter",tag:"phewas",namespace:{phewas:"phewas"},data_operations:[{type:"fetch",from:["phewas"]}],point_shape:[{scale_function:"effect_direction",parameters:{"+":"triangle","-":"triangledown",beta_field:"phewas:beta",stderr_beta_field:"phewas:se"}},"circle"],point_size:70,tooltip_positioning:"vertical",id_field:"{{phewas:trait_group}}_{{phewas:trait_label}}",x_axis:{field:"lz_auto_x",category_field:"phewas:trait_group",lower_buffer:.025,upper_buffer:.025},y_axis:{axis:1,field:"phewas:log_pvalue",floor:0,upper_buffer:.15},color:[{field:"phewas:trait_group",scale_function:"categorical_bin",parameters:{categories:[],values:[],null_value:"#B8B8B8"}}],fill_opacity:.7,tooltip:{closable:!0,show:{or:["highlighted","selected"]},hide:{and:["unhighlighted","unselected"]},html:"<strong>Trait:</strong> {{phewas:trait_label|htmlescape}}<br>\n<strong>Trait Category:</strong> {{phewas:trait_group|htmlescape}}<br>\n<strong>P-value:</strong> {{phewas:log_pvalue|logtoscinotation|htmlescape}}\n{{#if phewas:beta|is_numeric}}<br><strong>&beta;:</strong> {{phewas:beta|scinotation|htmlescape}}<br>{{/if}}\n{{#if phewas:se|is_numeric}}<strong>SE (&beta;):</strong> {{phewas:se|scinotation|htmlescape}}{{/if}}"},behaviors:{onmouseover:[{action:"set",status:"highlighted"}],onmouseout:[{action:"unset",status:"highlighted"}],onclick:[{action:"toggle",status:"selected",exclusive:!0}]},label:{text:"{{phewas:trait_label}}",spacing:6,lines:{style:{"stroke-width":"2px",stroke:"#333333","stroke-dasharray":"2px 2px"}},filters:[{field:"phewas:log_pvalue",operator:">=",value:20}],style:{"font-size":"14px","font-weight":"bold",fill:"#333333"}}},_S={namespace:{gene:"gene",constraint:"constraint"},data_operations:[{type:"fetch",from:["gene","constraint(gene)"]},{name:"gene_constraint",type:"genes_to_gnomad_constraint",requires:["gene","constraint"]}],id:"genes",type:"genes",tag:"genes",id_field:"gene_id",behaviors:{onmouseover:[{action:"set",status:"highlighted"}],onmouseout:[{action:"unset",status:"highlighted"}],onclick:[{action:"toggle",status:"selected",exclusive:!0}]},tooltip:Fk(oS)},gS=qk({filters:[{field:"gene_type",operator:"in",value:["protein_coding","IG_C_gene","IG_D_gene","IG_J_gene","IG_V_gene","TR_C_gene","TR_D_gene","TR_J_gene","TR_V_gene","rRNA","Mt_rRNA","Mt_tRNA"]}]},Fk(_S)),yS={namespace:{assoc:"assoc",catalog:"catalog"},data_operations:[{type:"fetch",from:["assoc","catalog"]},{type:"assoc_to_gwas_catalog",name:"assoc_plus_ld",requires:["assoc","catalog"],params:["assoc:position","catalog:pos","catalog:log_pvalue"]}],id:"annotation_catalog",type:"annotation_track",tag:"gwascatalog",id_field:"assoc:variant",x_axis:{field:"assoc:position"},color:"#0000CC",filters:[{field:"catalog:rsid",operator:"!=",value:null},{field:"catalog:log_pvalue",operator:">",value:7.301}],behaviors:{onmouseover:[{action:"set",status:"highlighted"}],onmouseout:[{action:"unset",status:"highlighted"}],onclick:[{action:"toggle",status:"selected",exclusive:!0}]},tooltip:Fk(sS),tooltip_positioning:"top"},mS={type:"set_state",tag:"ld_population",position:"right",color:"blue",button_html:"LD Population: ",show_selected:!0,button_title:"Select LD Population: ",custom_event_name:"widget_set_ldpop",state_field:"ld_pop",options:[{display_name:"ALL (default)",value:"ALL"},{display_name:"AFR",value:"AFR"},{display_name:"AMR",value:"AMR"},{display_name:"EAS",value:"EAS"},{display_name:"EUR",value:"EUR"},{display_name:"SAS",value:"SAS"}]},bS={type:"display_options",tag:"gene_filter",custom_event_name:"widget_gene_filter_choice",position:"right",color:"blue",button_html:"Filter...",button_title:"Choose which genes to show",layer_name:"genes",default_config_display_name:"Coding genes & rRNA",options:[{display_name:"All features",display:{filters:null}}]},vS={widgets:[{type:"remove_panel",position:"right",color:"red",group_position:"end"},{type:"move_panel_up",position:"right",group_position:"middle"},{type:"move_panel_down",position:"right",group_position:"start",style:{"margin-left":"0.75em"}}]},xS={widgets:[{type:"title",title:"LocusZoom",subtitle:'<a href="https://statgen.github.io/locuszoom/" target="_blank" rel="noopener">v0.14.0</a>',position:"left"},{type:"download",position:"right",group_position:"end"},{type:"download_png",position:"right",group_position:"start"}]},wS=function(){const t=Fk(xS);return t.widgets.push(Fk(mS)),t}(),MS=function(){const t=Fk(xS);return t.widgets.push({type:"shift_region",step:5e5,button_html:">>",position:"right",group_position:"end"},{type:"shift_region",step:5e4,button_html:">",position:"right",group_position:"middle"},{type:"zoom_region",step:.2,position:"right",group_position:"middle"},{type:"zoom_region",step:-.2,position:"right",group_position:"middle"},{type:"shift_region",step:-5e4,button_html:"<",position:"right",group_position:"middle"},{type:"shift_region",step:-5e5,button_html:"<<",position:"right",group_position:"start"}),t}(),kS={id:"association",tag:"association",min_height:200,height:300,margin:{top:35,right:55,bottom:40,left:70},inner_border:"rgb(210, 210, 210)",toolbar:function(){const t=Fk(vS);return t.widgets.push({type:"toggle_legend",position:"right"}),t}(),axes:{x:{label:"Chromosome {{chr}} (Mb)",label_offset:38,tick_format:"region",extent:"state"},y1:{label:"-log10 p-value",label_offset:50},y2:{label:"Recombination Rate (cM/Mb)",label_offset:46}},legend:{orientation:"vertical",origin:{x:75,y:40},hidden:!0},interaction:{drag_background_to_pan:!0,drag_x_ticks_to_scale:!0,drag_y1_ticks_to_scale:!0,drag_y2_ticks_to_scale:!0,scroll_to_zoom:!0,x_linked:!0},data_layers:[Fk(lS),Fk(cS),Fk(hS)]},ES={id:"coaccessibility",tag:"coaccessibility",min_height:150,height:180,margin:{top:35,right:55,bottom:40,left:70},inner_border:"rgb(210, 210, 210)",toolbar:Fk(vS),axes:{x:{label:"Chromosome {{chr}} (Mb)",label_offset:38,tick_format:"region",extent:"state"},y1:{label:"Score",label_offset:40,render:!1}},interaction:{drag_background_to_pan:!0,drag_x_ticks_to_scale:!0,drag_y1_ticks_to_scale:!0,scroll_to_zoom:!0,x_linked:!0},data_layers:[Fk(fS)]},SS=function(){let t=Fk(kS);return t=qk({id:"associationcatalog"},t),t.toolbar.widgets.push({type:"display_options",position:"right",color:"blue",button_html:"Display options...",button_title:"Control how plot items are displayed",layer_name:"associationpvaluescatalog",default_config_display_name:"No catalog labels (default)",options:[{display_name:"Label catalog traits",display:{label:{text:"{{catalog:trait}}",spacing:6,lines:{style:{"stroke-width":"2px",stroke:"#333333","stroke-dasharray":"2px 2px"}},filters:[{field:"catalog:trait",operator:"!=",value:null},{field:"catalog:log_pvalue",operator:">",value:7.301},{field:"ld:correlation",operator:">",value:.4}],style:{"font-size":"12px","font-weight":"bold",fill:"#333333"}}}}]}),t.data_layers=[Fk(lS),Fk(cS),Fk(dS)],t}(),zS={id:"genes",tag:"genes",min_height:150,height:225,margin:{top:20,right:55,bottom:20,left:70},axes:{},interaction:{drag_background_to_pan:!0,scroll_to_zoom:!0,x_linked:!0},toolbar:function(){const t=Fk(vS);return t.widgets.push({type:"resize_to_data",position:"right",button_html:"Resize"},Fk(bS)),t}(),data_layers:[Fk(gS)]},NS={id:"phewas",tag:"phewas",min_height:300,height:300,margin:{top:20,right:55,bottom:120,left:70},inner_border:"rgb(210, 210, 210)",axes:{x:{ticks:{style:{"font-weight":"bold","font-size":"11px","text-anchor":"start"},transform:"rotate(50)",position:"left"}},y1:{label:"-log10 p-value",label_offset:50}},data_layers:[Fk(lS),Fk(pS)]},TS={id:"annotationcatalog",tag:"gwascatalog",min_height:50,height:50,margin:{top:25,right:55,bottom:10,left:70},inner_border:"rgb(210, 210, 210)",toolbar:Fk(vS),axes:{x:{extent:"state",render:!1}},interaction:{drag_background_to_pan:!0,scroll_to_zoom:!0,x_linked:!0},data_layers:[Fk(yS)]},AS={state:{},width:800,responsive_resize:!0,min_region_scale:2e4,max_region_scale:1e6,toolbar:wS,panels:[Fk(kS),Fk(zS)]},CS={state:{},width:800,responsive_resize:!0,min_region_scale:2e4,max_region_scale:1e6,toolbar:wS,panels:[TS,SS,zS]},PS={width:800,responsive_resize:!0,toolbar:xS,panels:[Fk(NS),qk({height:300,margin:{bottom:40},axes:{x:{label:"Chromosome {{chr}} (Mb)",label_offset:38,tick_format:"region",extent:"state"}}},Fk(zS))],mouse_guide:!1},RS={state:{},width:800,responsive_resize:!0,min_region_scale:2e4,max_region_scale:1e6,toolbar:Fk(xS),panels:[Fk(ES),function(){const t=Object.assign({height:270},Fk(zS)),e=t.data_layers[0];e.match={send:"gene_name",receive:"gene_name"};const n=[{field:"lz_is_match",scale_function:"if",parameters:{field_value:!0,then:"#4285f4"}},{field:"lz_is_match",scale_function:"if",parameters:{field_value:!1,then:"#EAE6E6"}},"#363696"];return e.color=n,e.stroke=n,t}()]},OS={standard_association:iS,standard_association_with_label:aS,standard_genes:oS,catalog_variant:sS,coaccessibility:uS},LS={ldlz2_pop_selector:mS,gene_selector_menu:bS},DS={standard_panel:vS,standard_plot:xS,standard_association:wS,region_nav_plot:MS},jS={significance:lS,recomb_rate:cS,association_pvalues:hS,coaccessibility:fS,association_pvalues_catalog:dS,phewas_pvalues:pS,genes:_S,genes_filtered:gS,annotation_catalog:yS},$S={association:kS,coaccessibility:ES,association_catalog:SS,genes:zS,phewas:NS,annotation_catalog:TS},IS={standard_association:AS,association_catalog:CS,standard_phewas:PS,coaccessibility:RS};const BS=new class extends _{get(t,e,n={}){if(!t||!e)throw new Error("Must specify both the type and name for the layout desired. See .list() for available options");let r=super.get(t).get(e);const i=n.namespace;r.namespace||delete n.namespace;let a=qk(n,r);return i&&(a=function t(e,n){if(n=n||{},!e||"object"!=typeof e||"object"!=typeof n)throw new Error("Layout and shared namespaces must be provided as objects");for(let[r,i]of Object.entries(e))"namespace"===r?Object.keys(i).forEach(t=>{const e=n[t];e&&(i[t]=e)}):null!==i&&"object"==typeof i&&(e[r]=t(i,n));return e}(a,i)),Fk(a)}add(t,e,n,r=!1){if(!(t&&e&&n))throw new Error("To add a layout, type, name, and item must all be specified");if("object"!=typeof n)throw new Error("The configuration to be added must be an object");this.has(t)||super.add(t,new _);const i=Fk(n);return"data_layer"===t&&i.namespace&&(i._auto_fields=[...Hk(i,Object.keys(i.namespace))].sort()),super.get(t).add(e,i,r)}list(t){if(!t){let t={};for(let[e,n]of this._items)t[e]=n.list();return t}return super.get(t).list()}merge(t,e){return qk(t,e)}renameField(){return function t(e,n,r,i=!0){const a=typeof e;if(Array.isArray(e))return e.map(e=>t(e,n,r,i));if("object"===a&&null!==e)return Object.keys(e).reduce((a,o)=>(a[o]=t(e[o],n,r,i),a),{});if("string"!==a)return e;{const t=n.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&");if(i){const n=new RegExp(t+"\\|\\w+","g");(e.match(n)||[]).forEach(t=>console.warn(`renameFields is renaming a field that uses transform functions: was '${t}' . Verify that these transforms are still appropriate.`))}const a=new RegExp(t+"(?!\\w+)","g");return e.replace(a,r)}}(...arguments)}mutate_attrs(){return Gk(...arguments)}query_attrs(){return Vk(...arguments)}};for(let[t,e]of Object.entries(c))for(let[n,r]of Object.entries(e))BS.add(t,n,r);var US=BS;const qS=new _;function FS(t){return(e,n,...r)=>{if(2!==n.length)throw new Error("Join functions must receive exactly two recordsets");return t(...n,...r)}}qS.add("left_match",FS(r.left_match)),qS.add("inner_match",FS(r.inner_match)),qS.add("full_outer_match",FS(r.full_outer_match)),qS.add("assoc_to_gwas_catalog",FS((function(t,e,n,i,a){if(!t.length)return t;const o=r.groupBy(e,i),s=[];for(let t of o.values()){let e,n=0;for(let r of t){const t=r[a];t>=n&&(e=r,n=t)}e.n_catalog_matches=t.length,s.push(e)}return r.left_match(t,s,n,i)}))),qS.add("genes_to_gnomad_constraint",FS((function(t,e){return t.forEach((function(t){const n="_"+t.gene_name.replace(/[^A-Za-z0-9_]/g,"_"),r=e[n]&&e[n].gnomad_constraint;r&&Object.keys(r).forEach((function(e){let n=r[e];void 0===t[e]&&("number"==typeof n&&n.toString().includes(".")&&(n=parseFloat(n.toFixed(2))),t[e]=n)}))})),t})));var YS=qS;const HS={version:"0.14.0",populate:function(t,e,n){if(void 0===t)throw new Error("LocusZoom.populate selector not defined");let r;return fn(t).html(""),fn(t).call((function(t){if(void 0===t.node().id){let e=0;for(;!fn("#lz-"+e).empty();)e++;t.attr("id","#lz-"+e)}if(r=new kE(t.node().id,e,n),r.container=t.node(),void 0!==t.node().dataset&&void 0!==t.node().dataset.region){const e=function(t){let e=/^(\w+):([\d,.]+[kmgbKMGB]*)([-+])([\d,.]+[kmgbKMGB]*)$/.exec(t);if(e){if("+"===e[3]){const t=SE(e[2]),n=SE(e[4]);return{chr:e[1],start:t-n,end:t+n}}return{chr:e[1],start:SE(e[2]),end:SE(e[4])}}if(e=/^(\w+):([\d,.]+[kmgbKMGB]*)$/.exec(t),e)return{chr:e[1],position:SE(e[2])};return null}(t.node().dataset.region);Object.keys(e).forEach((function(t){r.state[t]=e[t]}))}r.svg=fn("div#"+r.id).append("svg").attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("id",r.id+"_svg").attr("class","lz-locuszoom").call(Kk,r.layout.style),r.setDimensions(),r.positionPanels(),r.initialize(),e&&r.refresh()})),r},DataSources:class extends _{constructor(t){super(),this._registry=t||Y}add(t,e,n=!1){if(this._registry.has(t))throw new Error(`The namespace ${t} is already in use by another source`);if(t.match(/[^A-Za-z0-9_]/))throw new Error("Data source namespace names can only contain alphanumeric characters or underscores. Invalid name: "+t);if(Array.isArray(e)){const[t,n]=e;e=this._registry.create(t,n)}return e.source_id=t,super.add(t,e,n),this}},Adapters:Y,DataLayers:rS,DataFunctions:YS,Layouts:US,MatchFunctions:TE,ScaleFunctions:$E,TransformationFunctions:Pk,Widgets:yE,get KnownDataSources(){return console.warn('Deprecation warning: KnownDataSources has been renamed to "Adapters"'),Y}},GS=[];HS.use=function(t,...e){if(!GS.includes(t)){if(e.unshift(HS),"function"==typeof t.install)t.install.apply(t,e);else{if("function"!=typeof t)throw new Error("Plugin must export a function that receives the LocusZoom object as an argument");t.apply(null,e)}GS.push(t)}};var VS=HS;function XS(t){return(XS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ZS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,a=void 0,a=function(t,e){if("object"!==XS(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==XS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===XS(a)?a:String(a)),r)}var i,a}var WS=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);this.update=this.update.bind(this),this.state=n.state;for(var i,a=new VS.DataSources,o=0;o<n.data_sources.length;o++)a.add(n.data_sources[o].name,n.data_sources[o].data);if(n.layout.type&&n.layout.name){var s=Object.assign({},n.layout.override,{state:n.state});i=VS.Layouts.get(n.layout.type,n.layout.name,s)}else i=n.layout;this.plot=VS.populate(e,a,i),this.onRegionChange=this.plot.on("region_changed",r)}var e,n,r;return e=t,(n=[{key:"update",value:function(t){Object.is(this.state,t.state)||(this.state=t.state,this.plot.applyState(t.state))}}])&&ZS(e.prototype,n),r&&ZS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function JS(t){return(JS="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function KS(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function QS(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,(i=r.key,a=void 0,a=function(t,e){if("object"!==JS(t)||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!==JS(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(i,"string"),"symbol"===JS(a)?a:String(a)),r)}var i,a}function tz(t,e){return(tz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function ez(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var n,r=rz(t);if(e){var i=rz(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return nz(this,n)}}function nz(t,e){if(e&&("object"===JS(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function rz(t){return(rz=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var iz=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&tz(t,e)}(a,t);var e,n,r,i=ez(a);function a(){return KS(this,a),i.apply(this,arguments)}return e=a,(n=[{key:"componentDidMount",value:function(){var t=this;this.locuszoom=new WS(this.el,this.props,(function(e){var n=t.props.setProps,r={regionChange:e.data};n?n(r):t.setState({regionChange:r})}))}},{key:"componentDidUpdate",value:function(){this.locuszoom.update(this.props)}},{key:"render",value:function(){var t=this;return f.a.createElement("div",{id:this.props.id,ref:function(e){t.el=e}})}}])&&QS(e.prototype,n),r&&QS(e,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(h.Component);iz.defaultProps={},iz.propTypes={id:p.a.string,setProps:p.a.func,layout:p.a.object,data_sources:p.a.arrayOf(p.a.object),state:p.a.object,regionChange:p.a.object},n.d(e,"Locuszoom4Dash",(function(){return iz}))}]);
//# sourceMappingURL=locuszoom_4_dash.min.js.map
//# sourceMappingURL=locuszoom_4_dash.min.js.map